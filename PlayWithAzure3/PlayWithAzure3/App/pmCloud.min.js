var docCookies={getItem:function(sKey){return sKey?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey))return!1;var sExpires="";if(vEnd)switch(vEnd.constructor){case Number:sExpires=vEnd===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString()}return document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":""),!0},removeItem:function(sKey,sPath,sDomain){return this.hasItem(sKey)?(document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:""),!0):!1},hasItem:function(sKey){return sKey?new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},keys:function(){for(var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),nLen=aKeys.length,nIdx=0;nLen>nIdx;nIdx++)aKeys[nIdx]=decodeURIComponent(aKeys[nIdx]);return aKeys},empty:function(){for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++)document.cookie=cookies[i].split("=")[0]+"= ; expires=-1; path=/"}};!function(){sStorage={set:function(item,value,wCookie,unerase){if(void 0!==value&&null!==value)if("object"==typeof value&&(value=JSON.stringify(value)),"boolean"==typeof value&&(value=value.toString()),unerase){var elTmp={};if(elTmp[item]=value.toString(),sessionStorage.unerase){var uneraseElement=sessionStorage.unerase,extended=JSON.stringify(elTmp),object=angular.extend(JSON.parse(uneraseElement),JSON.parse(extended));sessionStorage.unerase=JSON.stringify(object)}else sessionStorage.unerase=JSON.stringify(elTmp);docCookies.unerase||(docCookies.unerase={}),wCookie&&(docCookies.unerase[item]=value.toString())}else sessionStorage.setItem(item,value.toString()),wCookie&&docCookies.setItem(item,value.toString())},get:function(item,unerase){var sValue="";unerase?sessionStorage.hasOwnProperty("unerase")&&(sValue=JSON.parse(sessionStorage.getItem("unerase"))[item]||""):sValue=sessionStorage.getItem(item);var cValue=docCookies.getItem(item),value=void 0!==sValue&&null!==sValue?sValue:cValue;if(void 0!==value&&null!==value&&""!==value){var json=value.toString();try{json=JSON.parse(json)}catch(e){}}else json=value;return json},count:function(){var len=sessionStorage.length;return len},remove:function(item){docCookies.removeItem(item),sessionStorage.removeItem(item)},empty:function(){if(sessionStorage.hasOwnProperty("unerase"))for(var prop in sessionStorage)"unerase"!==prop&&sessionStorage.removeItem(prop);else sessionStorage.clear()},save:function(item,obj,wCookie,unerase){this.set(item,obj,wCookie,unerase)},load:function(item,unerase){var obj,json=this.get(item,unerase);try{obj=JSON.parse(json)}catch(e){obj=json}return obj},timeout:function(item,time){var self=this;setTimeout(function(){self.remove(item)},time)}},lStorage={set:function(item,value){localStorage.setItem(item,value)},get:function(item){var value=localStorage.getItem(item);try{value=JSON.parse(value)}catch(e){}return value},count:function(){var len=localStorage.length;return len},remove:function(item){localStorage.removeItem(item)},empty:function(){localStorage.clear()},save:function(item,obj){"object"==typeof obj?this.set(item,JSON.stringify(obj)):this.set(item,obj)},load:function(item){var obj,json=this.get(item);try{obj=JSON.parse(json)}catch(e){obj=json}return obj},timeout:function(item,time){var self=this;setTimeout(function(){self.remove(item)},time)}}}(window),Object.size=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size};var _appConfig;!function(){_appConfig={root:"",version:"1.0",debug:{web:!1,modeler:!1,services:["$login"]},app:{logout:!0},plans:{validation:!0},modules:{angular:["ui.router","ui.bootstrap","ngAnimate","ngSanitize","ui.numeric","ngCookies","base64","lrInfiniteScroll"],cloud:["bizUtils","applicationModule","addOnsModule","searchModule","loadingModule","alertModule","slideContentModule","asideModule","modalContentModule","dashboardModule","userProfileModule","workspaceModule","diagramsModule","processViewerModule","userMenuModule","headerModule","appBreadcrumbModule","appMenuModule","notificationsModule","commentsModule","addOnsModule","signalRModule","endPointsModule","ngAnimate","fileManagerModule","changePasswordModule","teamModule","tabsModule","memberModule","upgradeModule","billingModule","extendedAttributesModule","collaboratorsModule","gettext","invitationsModule"]}}}(),function(){window.console||(window.console={});for(var m=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],i=0;i<m.length;i++)window.console[m[i]]||(window.console[m[i]]=function(){});Object.keys||(Object.keys=function(obj){var k,keys=[];for(k in obj)Object.prototype.hasOwnProperty.call(obj,k)&&keys.push(k);return keys})}(),function($){$.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()}}(jQuery);var gettext=function(s){return s};!function(){function azureBlob($log,$http){var DefaultBlockSize=262144,upload=function(config){var state=initializeState(config),reader=new FileReader;return reader.onloadend=function(evt){if(evt.target.readyState==FileReader.DONE){var uri=state.fileUrl+"&comp=block&blockid="+state.blockIds[state.blockIds.length-1],requestData=new Uint8Array(evt.target.result);$log.log(uri),$http.put(uri,requestData,{processData:!1,headers:{"x-ms-blob-type":"BlockBlob","x-ms-blob-content-type":state.file.type,"x-ms-lease-id":state.sasToken},transformRequest:[]}).success(function(data,status,headers,config){$log.log(data),$log.log(status),state.bytesUploaded+=requestData.length;var percentComplete=(parseFloat(state.bytesUploaded)/parseFloat(state.file.size)*100).toFixed(2);state.progress&&state.progress(percentComplete,data,status,headers,config),uploadFileInBlocks(reader,state)}).error(function(data,status,headers,config){$log.log(data),$log.log(status),state.error&&state.error(data,status,headers,config)})}},uploadFileInBlocks(reader,state),{cancel:function(){state.cancelled=!0}}},initializeState=function(config){var maxBlockSize=DefaultBlockSize,numberOfBlocks=1,file=config.file,fileSize=file.size;return maxBlockSize>fileSize&&(maxBlockSize=fileSize,$log.log("max block size = "+maxBlockSize)),numberOfBlocks=fileSize%maxBlockSize==0?fileSize/maxBlockSize:parseInt(fileSize/maxBlockSize,10)+1,$log.log("total blocks = "+numberOfBlocks),{maxBlockSize:maxBlockSize,numberOfBlocks:numberOfBlocks,totalBytesRemaining:fileSize,currentFilePointer:0,blockIds:new Array,blockIdPrefix:"block-",bytesUploaded:0,submitUri:null,file:file,baseUrl:config.baseUrl,sasToken:config.sasToken,fileUrl:config.baseUrl,progress:config.progress,complete:config.complete,error:config.error,cancelled:!1}},uploadFileInBlocks=function(reader,state){if(state.totalBytesRemaining>0){$log.log("current file pointer = "+state.currentFilePointer+" bytes read = "+state.maxBlockSize);var fileContent=state.file.slice(state.currentFilePointer,state.currentFilePointer+state.maxBlockSize),blockId=state.blockIdPrefix+pad(state.blockIds.length,6);$log.log("block id = "+blockId),state.blockIds.push(btoa(blockId)),reader.readAsArrayBuffer(fileContent),state.currentFilePointer+=state.maxBlockSize,state.totalBytesRemaining-=state.maxBlockSize,state.totalBytesRemaining<state.maxBlockSize&&(state.maxBlockSize=state.totalBytesRemaining)}else commitBlockList(state)},commitBlockList=function(state){var uri=state.fileUrl+"&comp=blocklist";$log.log(uri);for(var requestBody='<?xml version="1.0" encoding="utf-8"?><BlockList>',i=0;i<state.blockIds.length;i++)requestBody+="<Latest>"+state.blockIds[i]+"</Latest>";requestBody+="</BlockList>",$log.log(requestBody),$http.put(uri,requestBody,{headers:{"x-ms-blob-content-type":state.file.type,"x-ms-lease-id":state.sasToken,"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data,status,headers,config){$log.log(data),$log.log(status),$log.log(headers),state.complete&&state.complete(data,status,headers,config)}).error(function(data,status,headers,config){$log.log(data),$log.log(status),$log.log(headers),state.error&&state.error(data,status,headers,config)})},pad=function(number,length){for(var str=""+number;str.length<length;)str="0"+str;return str};return{upload:upload}}var azureBlobUpload=angular.module("azureBlobUpload",[]);azureBlobUpload.factory("azureBlob",["$log","$http",azureBlob])}(),angular.module("_CloudModule",_appConfig.modules.angular.concat(_appConfig.modules.cloud)).run(function(APP,gettextCatalog,$data){var self=this;self.getConstants=function(mod){for(var c={},i=0;i<mod.length;i++)"constant"===mod[i][1]&&(c.constants=!0,c[mod[i][2][0]]=mod[i][2][1]);return c},self.addConstantsToConfig=function(){for(var prop in APP.MODULES){var actModule=APP.MODULES[prop],constantes=self.getConstants(angular.module(actModule)._invokeQueue);constantes.hasOwnProperty("constants")&&(delete constantes.constants,angular.extend(APP,constantes))}},self.addConstantsToConfig()}),angular.module("_CloudModule").constant("APP",{VERSION:_appConfig.version,MODULES:_appConfig.modules.cloud,VALIDATE_PLAN:_appConfig.plans.validation,BILLING:{PLANS:[{name:"full",displayName:gettext("Workgroup Plan"),thumbnail:"app/img/advanced.png",properties:[gettext("100 MB per Editor"),gettext("Unlimited Models"),gettext("Model Offline")],buttons:[{page:"USER_MENU_MODULE.SHOW.UPGRADE",displayName:gettext("Upgrade your Plan")},{action:"OPEN.TRIAL.MODAL",displayName:gettext("Start free trial!"),footer:gettext("(No card required)")}],pricing:[]}]},DEBUG:{MODELER:_appConfig.debug.modeler,WEB:_appConfig.debug.web},LOGOUT:_appConfig.app.logout,EVENTS:{_ERROR:"ERROR",_OPEN_MODULE:"OPEN_MODULE",_FROM_MODELER:"FROM_MODELER",_EXECUTE:"EXECUTE",_LOGOUT:"LOGOUT",_LAYOUT:"LAYOUT",_INCREASE_NOTIFICATION:"_INCREASE_NOTIFICATION",_WINDOW_TITLE:"_WINDOW_TITLE",_CHANGE_PLAN:"CHANGE_PLAN",_GET_APP_QUOTA:"_GET_APP_QUOTA",_UPDATE_APP_QUOTA:"_UPDATE_APP_QUOTA",_VIEW_BANNER:"_VIEW_BANNER",_SUCCESS_LOGIN:"_SUCCESS_LOGIN"},ACTIONS:{EXECUTE_IN_MODELER:"OPEN.MODELER",SET_TRIAL_PLAN:"SET.TRIAL.PLAN",OPEN_TRIAL_MODAL:"OPEN.TRIAL.MODAL"},MODELER:{EXTERNAL:{LOGIN:"authentication",CREDENTIALS:"getCredentials",UPDATE_CREDENTIALS:"updateCredentials",USER_PROFILE_UPDATED:"userProfileUpdated",USER_PROFILE:"getUserProfile",REFRESH_TOKEN:"updateToken",NEW_WORKSPACE:"newWorkspace",GET_WORKSPACE:"getWorkspace",GET_WORKSPACE_ID:"getWorkspaceId",UPDATE_WORKSPACE:"updateWorkspace",EXPIRED_SESSION:"expiredSession",MODAL_CANCEL:"close",SELECTED_WORKSPACE:"openWorkspace",SAVE_ATTACHMENT:"saveAttachment",LINK_FILE:"linkFile",GET_SELECTED_FILE_ID:"getSelectedFileId",SET_WINDOW_SIZE:"setWindowSize",CALL_EXTERNAL_URL:"openLink"}},TEMPLATES:{INIT:"views/initTemplate.html",WEB:"views/initTemplateWeb.html",BANNER:{PLAN_VIEW:"views/_application.cloud.module.plan.view.html",QUOTA:"views/_application.cloud.module.quota.view.html",PERSONAL:"views/_application.cloud.module.profile.plan.html"},MODAL:{UPGRADE:"views/_application.cloud.module.upgrade.plan.html",UPGRADE_TRIAL:"views/_application.cloud.module.upgrade.trial.plan.html",WELCOME_TRIAL:"views/_application.cloud.module.welcome.trial.html",WELCOME_FULL:"views/_application.cloud.module.welcome.full.html",DOWNGRADED_TRIAL:"views/_application.cloud.module.downgraded.trial.html"},MODELER:{BASE:"views/initTemplateModeler.html",IN:"views/initTemplateModelerIn.html",CLOSE_WINDOW:"views/closeModelerWindows.html",LIST_WORKSPACE:"views/workspace.list.module.view.html",NEW_WORKSPACE:"views/workspace.new.modeler.module.view.html",UPDATE_WORKSPACE:"views/workspace.edit.modeler.module.view.html",SHARE_WORKSPACE:"views/workspace.share.modeler.module.view.html",OPEN_WORKSPACE:"views/workspace.list.module.view.html",FILE_MANAGER:"views/file.manager.module.view.html",USER_PROFILE:"views/user.profile.module.view.html"},ERROR:"views/error.html",APPLICATION:"views/applicationTemplate.html",HEADER:"views/_application.cloud.module.header.html",COMMON:{HEADER:"views/header.common.view.html",FOOTER:"views/footer.common.view.html",ALERT:"views/alert.module.view.html",ADDONS:"app/modules/addOnsModule/views/add.ons.module.view.html",SLIDE:{EMPTY:"views/slide.content.module.empty.view.html",HEADER:"views/slide.content.module.header.view.html",BASE:"views/slide.content.module.view.html"},MODAL:{EMPTY:"views/modal.content.module.empty.view.html",HEADER:"views/modal.content.module.header.view.html",CONTENT:"views/modal.content.module.view.html"}},AUTHENTICATION_MODULE:{LOGIN:"app/modules/authenticationModule/views/user.login.module.view.html",FORGOT:"app/modules/authenticationModule/views/user.forgot.module.view.html",CHANGE_PASSWORD:"app/modules/authenticationModule/views/user.changepassword.module.view.html",REGISTER:"app/modules/authenticationModule/views/user.register.module.view.html",TERMS:"app/modules/authenticationModule/views/user.terms.module.view.html",REGISTER_BETA:"app/modules/authenticationModule/views/user.register.beta.module.view.html"},LOADING_MODULE:{LOADING:"views/loading.module.view.html"},DASHBOARD:{VIEW:"views/dashboard.module.view.html"},WORKSPACE_MODULE:{LIST:"views/workspace.list.module.view.html"},DIAGRAMS_MODULE:{LIST:"views/diagrams.list.module.view.html"},PROCESS_VIEWER_MODULE:{VIEW:"views/process.viewer.module.view.html"},ASIDE_MODULE:{BASE:"views/aside.module.view.html"},PAYMENTS:{HISTORY:"views/billing.module.payments.view.html",COMMIT:"views/billing.module.payments.commit.view.html",CANCEL:"views/billing.module.payments.cancel.view.html",ERROR:"views/billing.module.payments.error.view.html"}},CAROUSEL:{TRIAL:{slides:[{image:"app/img/slide_001.jpg",title:gettext("Step 1"),text:gettext("message"),active:!0},{image:"app/img/slide_002.jpg",title:gettext("Step 2"),text:gettext("message")}]}},SIDE_MODULE:{RIGHT_SIDE:{TABS:{_BY_SHAPE:[{title:gettext("Comments on"),img:"comment",content:"views/comments.module.view.html",tabClass:"comments",access:["Editor","Contributor","Owner"],plan:["trial","full"],titleShow:!0},{title:gettext("Extended Attributes"),img:"extended-attributes",content:"views/extended.attributes.module.view.html",tabClass:"extended-attributes",access:["Editor","Contributor","Personal","Owner"],plan:["Personal","trial","full"],counter:!0,titleShow:!1}],_COMMENTS:[{title:gettext("Comments"),img:"comment",content:"views/comments.module.view.html",tabClass:"comments",access:["Editor","Contributor","Owner"],plan:["trial","full"],titleShow:!0}],_EXTENDED_ATTRIBUTES:[{title:gettext("Extended Attributes"),img:"extended-attributes",content:"views/extended.attributes.module.view.html",tabClass:"extended-attributes",access:["Editor","Contributor","Personal","Owner"],plan:["Personal","trial","full"],counter:!0,titleShow:!1}]}}},TABS:{USER_OPTIONS:[{active:!1,name:"upgrade",title:gettext("Plan Management"),content:"views/upgrade.module.view.html",img:"upgrade",state:"secondary",type:"icon",roles:["Admin","Designer","Viewer"],access:["Personal","Trial","Full"],device:["Desktop","Mobile"]},{active:!1,name:"billing",title:gettext("Plan and Billing Info"),content:"views/billing.module.view.html",img:"coin",state:"secondary",type:"icon",roles:["Admin","Designer","Viewer"],access:["Trial","Full"],device:["Desktop","Mobile"]},{active:!1,name:"collaborators",title:gettext("Collaborators"),content:"views/collaborators.module.view.html",img:"team",state:"secondary",type:"icon",roles:["Admin","Designer","Viewer"],access:["Trial","Full"],device:["Desktop","Mobile"]}]},APP_MENU:{WORKSPACE_LIST:{viewName:"Workspace List",OPTIONS:[{name:gettext("List View"),url:"LIST",img:"list",css:"bz-cd-list-option",state:"enabled bz-cd-active",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop","Mobile"]},{name:gettext("Grid View"),url:"GRID",img:"grid",css:"bz-cd-grid-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop","Mobile"]}],ACTIONS:[{name:"Open Bizagi Modeler",action:"OPEN.MODELER",url:"",css:"bz-cd-open-workspace-option",img:"modeler-edit",type:"button",roles:["Admin","Designer","Viewer"],access:["Editor","Personal","Owner"],device:["Desktop"]}]},DIAGRAMS_LIST:{NAME:"Process List",OPTIONS:[{name:gettext("Properties"),url:"EDIT.WORKSPACE",img:"pencil",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Editor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop"]},{name:gettext("Invite People to Model"),url:"SHARE.WORKSPACE",img:"share",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Personal","Owner"],plan:["personal","trial","full"],device:["Desktop"]},{name:gettext("Show Comments"),url:"SHOW.COMMENTS",img:"comment",css:"bz-cd-comments-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Owner"],plan:["trial","full"],device:["Desktop","Mobile"]},{name:gettext("Show Model Activity"),url:"SHOW.NOTIFICATIONS",img:"bell",css:"bz-cd-notification-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Owner"],plan:["personal","trial","full"],device:["Desktop","Mobile"]},{name:gettext("List View"),url:"LIST",img:"list",css:"bz-cd-list-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop","Mobile"]},{name:gettext("Grid View"),url:"GRID",img:"grid",css:"bz-cd-grid-option",state:"enabled bz-cd-active",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop","Mobile"]}],ACTIONS:[{name:gettext("Edit in Bizagi Modeler"),action:"OPEN.MODELER",url:"",css:"bz-cd-open-workspace-option",img:"modeler-edit",type:"button",roles:["Admin","Designer"],access:["Editor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop"]}]},PROCESS_VIEWER:{NAME:gettext("Process Viewer"),OPTIONS:[{name:gettext("Invite People to Model"),url:"SHARE.WORKSPACE",img:"share",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Personal","Owner"],plan:["personal","trial","full"],device:["Desktop"]},{name:gettext("Show Comments"),url:"SHOW.COMMENTS",img:"comment",css:"bz-cd-comments-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Owner"],plan:["trial","full"],device:["Desktop","Mobile"]},{name:gettext("Show Model Activity"),url:"SHOW.NOTIFICATIONS",img:"bell",css:"bz-cd-notification-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor","Owner"],plan:["trial","full"],device:["Desktop","Mobile"]}],ACTIONS:[{name:gettext("Edit in Bizagi Modeler"),action:"OPEN.MODELER",url:"",css:"bz-cd-open-workspace-option",img:"modeler-edit",type:"button",roles:["Admin","Designer"],access:["Editor","Personal","Owner"],plan:["personal","trial","full"],device:["Desktop"]}]}},RESOURCES:{IMAGES:{LOGO:"app/img/bizagi-logo.png",WITHE_LOGO:"app/img/bizagi-logo-white.png",WORKSPACE_PLACEHOLDER:"app/img/bizagi-workspace-placeholder.png",PROCESS_PLACEHOLDER:"app/img/bizagi-process-placeholder.png",AVATAR:{A24:"app/img/pmcloud-avatar-24.png",A32:"app/img/pmcloud-avatar-32.png",A128:"app/img/bizagi-placeholder-avatar.png"}},SVG:{ICONS:"views/pmcloud.icons.svg"}}}).config(["$tooltipProvider",function($tooltipProvider){var tooltipFactory=$tooltipProvider.$get[$tooltipProvider.$get.length-1];$tooltipProvider.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function($window,$compile,$timeout,$parse,$document,$position,$interpolate){return"ontouchstart"in $window?function(){return{compile:function(){}}}:tooltipFactory($window,$compile,$timeout,$parse,$document,$position,$interpolate)}]}]),angular.module("_CloudModule").config(function($stateProvider,$urlRouterProvider,APP){$urlRouterProvider.when("","/dashboard/user/workspaces"),$urlRouterProvider.when("/","/dashboard/user/workspaces"),$urlRouterProvider.when("/dashboard/","/dashboard/user/workspaces"),$urlRouterProvider.when("/dashboard","/dashboard/user/workspaces"),$urlRouterProvider.when("/dashboard/user","/dashboard/user/workspaces"),$urlRouterProvider.when("/dashboard/user/","/dashboard/user/workspaces"),$stateProvider.state("Cloud",{url:"/",templateUrl:APP.TEMPLATES.INIT}).state("Cloud.error",{url:"/error",templateUrl:APP.TEMPLATES.ERROR}),$stateProvider.state("Cloud.Modeler",{url:"Modeler/",templateUrl:APP.TEMPLATES.MODELER.BASE,controller:function($rootScope){$rootScope.$emit(APP.EVENTS._FROM_MODELER,!0)},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.login",{url:"login",template:"Modeler Login",controller:"ModelerLoginController",wSize:{w:420,h:700},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.In",{url:"dashboard",templateUrl:APP.TEMPLATES.MODELER.IN,controller:"ModelerInController",resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.updateProfile",{url:"userProfile",views:{"":{templateUrl:APP.TEMPLATES.MODELER.USER_PROFILE}},wSize:{w:800,h:660},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.newWorkspace",{url:"newWorkspace",views:{"":{templateUrl:APP.TEMPLATES.MODELER.NEW_WORKSPACE}},wSize:{w:600,h:510},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.updateWorkspace",{url:"updateWorkspace",views:{"":{templateUrl:APP.TEMPLATES.MODELER.UPDATE_WORKSPACE}},wSize:{w:450,h:460},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.shareWorkspace",{url:"shareWorkspace",views:{"":{templateUrl:APP.TEMPLATES.MODELER.SHARE_WORKSPACE}},wSize:{w:800,h:710},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.listWorkspace",{url:"listWorkspace",views:{"":{templateUrl:APP.TEMPLATES.MODELER.LIST_WORKSPACE,controller:"WorkspaceController"}},wSize:{w:800,h:700},resolve:{promiseObj:checkRouting}}).state("Cloud.Modeler.fileManager",{url:"fileManager",views:{"":{templateUrl:APP.TEMPLATES.MODELER.FILE_MANAGER,controller:"FileManagerController"}},wSize:{w:800,h:700},resolve:{promiseObj:checkRouting}}),$stateProvider.state("Cloud.Web",{url:"Web/",templateUrl:APP.TEMPLATES.WEB,controller:function($rootScope){$rootScope.$emit(APP.EVENTS._FROM_MODELER,!1)},resolve:{promiseObj:checkRouting}}).state("CloudIn",{url:"/dashboard",templateUrl:APP.TEMPLATES.APPLICATION,controller:"DashboardController",resolve:{promiseObj:checkRouting}}).state("CloudIn.Payment",{url:"/payment",views:{"":{template:"<ui-view></ui-view>",controller:"PaymentsController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.Payment.Error",{url:"/error",views:{"":{templateUrl:APP.TEMPLATES.PAYMENTS.ERROR,controller:"PaymentsController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.Payment.Commit",{url:"/commit",views:{"":{templateUrl:APP.TEMPLATES.PAYMENTS.COMMIT,controller:"PaymentsController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.Payment.Cancel",{url:"/cancel",views:{"":{templateUrl:APP.TEMPLATES.PAYMENTS.CANCEL,controller:"PaymentsController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.upgrade",{url:"/upgrade",controller:function($scope,$rootScope,$state,APP){$rootScope.$off(APP.USER_MENU_MODULE.EVENTS._READY),$rootScope.$on(APP.USER_MENU_MODULE.EVENTS._READY,function(){$rootScope.$emit(APP.EVENTS._EXECUTE,{page:APP.USER_MENU_MODULE.ACTIONS.SHOW_UPGRADE,from:"FromRouting"})})},resolve:{promiseObj:checkRouting}}).state("CloudIn.workspaces",{url:"/user/workspaces",views:{"":{templateUrl:APP.TEMPLATES.WORKSPACE_MODULE.LIST,controller:"WorkspaceController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.trial",{url:"/user/starttrial",views:{"":{templateUrl:APP.TEMPLATES.WORKSPACE_MODULE.LIST,controller:"WorkspaceController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.upgradeWorkGroup",{url:"/user/upgrade",views:{"":{templateUrl:APP.TEMPLATES.WORKSPACE_MODULE.LIST,controller:"WorkspaceController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.workspaces.diagrams",{url:"/:workspaceId/diagrams",views:{"":{templateUrl:APP.TEMPLATES.DIAGRAMS_MODULE.LIST,controller:"DiagramsController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.workspaces.processviewer",{url:"/:workspaceId/diagram/:diagramId",views:{"":{templateUrl:APP.TEMPLATES.PROCESS_VIEWER_MODULE.VIEW,controller:"ProcessViewerController"}},resolve:{promiseObj:checkRouting}}).state("CloudIn.AcceptInvite",{url:"/user/workspace/:workspaceId/accepted/:invitationId/",views:{"":{templateUrl:APP.TEMPLATES.WORKSPACE_MODULE.LIST,controller:"WorkspaceController"}},resolve:{promiseObj:checkRouting}})}).run(function($rootScope,$state,APP,$timeout,$data){$rootScope.$off=function(name){return $rootScope.$$listeners[name]=[],$rootScope},$rootScope.$offAll=function(){return $rootScope.$$listeners={},$rootScope},$rootScope.$on("$stateChangeStart",function(event,toState){$data.$checkRouting(toState,APP)})});var checkRouting=function($q,$rootScope,$http,$data,APP){if(_.keys(APP.APPLICATION_MODULE.API.PATH).length>1)return!0;var deferred=$q.defer();return $http.get("services.json").success(function(dataDiscovery){angular.extend(APP.APPLICATION_MODULE.API.PATH,dataDiscovery),deferred.resolve(!0)}).error(function(){deferred.reject()}),deferred.promise};angular.module("_CloudModule").service("application",function($rootScope,$state,$data,APP,gettextCatalog,applicationServices){var self=this,translateOptions=function(list){return _.each(list,function(item,i){list[i].name=gettextCatalog.getString(item.name)}),list},getPlansTranslated=function(plan){var planTranslated=plan;return _.each(plan,function(result){result.displayName=gettextCatalog.getString(result.displayName),_.each(result.properties,function(prop,i){result.properties[i]=gettextCatalog.getString(prop)}),_.each(result.buttons,function(btn,i){result.buttons[i].displayName=gettextCatalog.getString(btn.displayName),result.buttons[i].footer=gettextCatalog.getString(btn.footer)})}),planTranslated};self.$dialogsPersonalPlan=function(subscription,scope,redirect,actualPlan,plansJustUpgrade,popup,response){if(popup&&!subscription.wasTrialActivated){var clonedCurrentPlan={};$data.cloneObject(clonedCurrentPlan,APP.BILLING.PLANS),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Upgrade Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{redirect:redirect,plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:getPlansTranslated(clonedCurrentPlan),label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))},buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES,upgradeToWorkgroup:!0},layout:"modal-default",footerVisibility:!1})}else popup&&subscription.wasTrialActivated?scope.appQuota&&scope.appQuota.used>scope.appQuota.quota?$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Change Your Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{scope:scope,plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:plansJustUpgrade(),alertCSS:"alert relative alert-danger",message:gettextCatalog.getString(gettext("You have exceeded the personal plan quota. In order to continue please delete some of your models or upgrade your plan.")),label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))},buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},layout:"modal-default",footerVisibility:!1}):$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Change Your Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{scope:scope,plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:plansJustUpgrade(),alertCSS:"alert relative alert-warning",message:gettextCatalog.getString(gettext("Change Your Plan to continue using our collaboration options.")),label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))},buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},layout:"modal-default",footerVisibility:!1}):response&&response()},self.dialogsTrialPlan=function(isModeler,scope,redirect,actualPlan,getSubscriptionInfo,hasModels,popup,subscription,isTrialEnded,plansWithoutTrial,response,plansJustUpgrade){popup&&subscription.wasTrialActivated?(isTrialEnded()&&scope.appQuota.used>scope.appQuota.quota?$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Change Your Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{workspace:$data.$selectedWorkspace(),plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:plansWithoutTrial(),alertCSS:"alert relative alert-danger",message:gettextCatalog.getString(gettext("You have exceeded the personal plan quota.  In order to continue please delete some of your models or upgrade your plan.")),label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))},buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},layout:"modal-default",footerVisibility:!1}):isTrialEnded()?$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{
name:gettextCatalog.getString(gettext("Change Your Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{workspace:$data.$selectedWorkspace(),plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:plansWithoutTrial(),alertCSS:"alert relative alert-warning",message:gettextCatalog.getString(gettext("Change Your Plan to continue using our collaboration options.")),label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))},buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},layout:"modal-default",footerVisibility:!1}):($rootScope.$emit(APP.EVENTS._CHANGE_PLAN,{}),response&&response()),redirect&&void 0!==redirect&&null!==redirect||isTrialEnded()||$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Change Your Plan")),module:APP.TEMPLATES.MODAL.UPGRADE,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{scope:scope,plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,plans:plansJustUpgrade(),subscriptionInfo:getSubscriptionInfo(),buttonPricing:gettextCatalog.getString(gettext("Pricing and features")),linkCollaborationServices:"es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},layout:"modal-default",footerVisibility:!1})):($rootScope.$emit(APP.EVENTS._CHANGE_PLAN,{}),response&&response())},self.$validatePlan=function(response,popup,scope,redirect){$rootScope.$emit(APP.EVENTS._VIEW_BANNER,!1),APP.VALIDATE_PLAN?($rootScope.$emit(APP.EVENTS._VIEW_BANNER,!0),applicationServices.$userProfile(null,function(profile){$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:translateOptions(APP.APP_MENU.WORKSPACE_LIST.OPTIONS),actions:translateOptions(APP.APP_MENU.WORKSPACE_LIST.ACTIONS)});var userName=profile.useName?profile.userName:profile.email;profile.userName=userName,$data.$userProfile(profile);var hasModels,userProfile=$data.$userProfile(),subscription=$data.$subscription(),userData={user:profile.userName},isModeler=$data.$fromModeler(),stateCommit="CloudIn.Payment.Commit"===$state.current.name;stateCommit||applicationServices.$workspaceList(userData,function(responseWorkspaceList){if(hasModels=responseWorkspaceList.content.length,userProfile.hasOwnProperty("subscription")){var profilePlan=subscription.subscriptionType,actualPlan=subscription.subscriptionType,getSubscriptionInfo=function(){var newPlans={endDate:subscription.endDate,daysRemaining:$rootScope.daysLeft};return newPlans};if(subscription.wasTrialActivated){var clonedCurrentPlan={};$data.cloneObject(clonedCurrentPlan,APP.BILLING.PLANS);var plansWithoutTrial=function(){var plansWT=getPlansTranslated(clonedCurrentPlan),newPlans=[];for(var prop in plansWT)"trial"!==plansWT[prop].name&&newPlans.push(plansWT[prop]);return newPlans},plansJustUpgrade=function(){var plansWT=plansWithoutTrial(),newPlans=[];for(var prop in plansWT)"personal"!==plansWT[prop].name&&newPlans.push(plansWT[prop]);return newPlans},isTrialEnded=function(){var rValue=!1,secondDate=new Date($data.$subscription().endDate).getTime(),currentDate=(new Date).getTime();return currentDate>secondDate&&(rValue=!0),rValue}}"personal"===profilePlan||""===profilePlan?self.$dialogsPersonalPlan(subscription,scope,redirect,actualPlan,plansJustUpgrade,popup,response):"trial"===profilePlan?self.dialogsTrialPlan(isModeler,scope,redirect,actualPlan,getSubscriptionInfo,hasModels,popup,subscription,isTrialEnded,plansWithoutTrial,response,plansJustUpgrade):($rootScope.$emit(APP.EVENTS._VIEW_BANNER,!1),response&&response())}$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._READY)})})):response&&response()}}),angular.module("_CloudModule").directive("planViewer",function(APP){return{templateUrl:APP.TEMPLATES.BANNER.PLAN_VIEW,controller:function($window,$scope,$data,$rootScope,APP,$element){$scope.actualPlan=APP.TEMPLATES.BANNER.PERSONAL,$scope.execute=function(event,data){$rootScope.$emit(APP.EVENTS._EXECUTE,data)},$scope.updatePlan=function(event,data){var userProfile=$data.$userProfile(),subscription=$data.$subscription();if($scope.userNamePlan=userProfile.userName,userProfile.hasOwnProperty("subscription")){$scope.userProfilePlan=""===subscription.subscriptionType?"personal":subscription.subscriptionType,$scope.startDate=userProfile.subscription.startDate,$scope.endDate=userProfile.subscription.endDate;var diffDays=30;if("personal"!==$scope.userProfilePlan&&$scope.startDate&&$scope.endDate){var oneDay=864e5,firstDate=moment(userProfile.subscription.startDate).toDate().getTime(),secondDate=moment(userProfile.subscription.endDate).toDate().getTime(),currentDate=moment().toDate().getTime();diffDays=currentDate>secondDate?0:currentDate>firstDate?Math.ceil(Math.abs((currentDate-secondDate)/oneDay)):Math.ceil(Math.abs((firstDate-secondDate)/oneDay))}$rootScope.daysLeft=diffDays}data&&data.days&&($rootScope.daysLeft=data.days),data&&data.userProfilePlan&&($scope.userProfilePlan=data.userProfilePlan)},$rootScope.$off(APP.EVENTS._CHANGE_PLAN),$rootScope.$on(APP.EVENTS._CHANGE_PLAN,$scope.updatePlan),$scope.updatePlan()}}}),angular.module("_CloudModule").directive("quota",function(APP){return{templateUrl:APP.TEMPLATES.BANNER.QUOTA,controller:function($window,$scope,$data,$rootScope,APP,$element){$scope.quota={visibility:!1,percent:0,message:""},$scope.update=function(event,data){var used=parseFloat(data.used),quota=parseFloat(data.quota),percent=100*used/quota;$scope.quota.visibility=!0,$scope.quota.percent=percent,$scope.quota.used=used+data.sizeUnit,$scope.quota.value=quota+data.sizeUnit,$scope.quota.critical=$scope.validateSpace(percent),$scope.quota.style={width:percent+"%"}},$scope.validateSpace=function(percent){var response="enought";return percent>70&&(response="limit"),percent>90&&(response="full"),response},$rootScope.$on(APP.EVENTS._UPDATE_APP_QUOTA,$scope.update),$rootScope.$emit(APP.EVENTS._GET_APP_QUOTA)}}}),angular.module("_CloudModule").service("_CloudModuleHandlerApplication",function($rootScope,_CloudModuleHandlerAppHeader,_CloudModuleHandlerAppMenu,_CloudModuleHandlerComments,_CloudModuleHandlerNotification,_CloudModuleHandlerWorkspace,_CloudModuleHandlerTeam,_CloudModuleHandlerSearch,_CloudModuleHandlerMember,_CloudModuleHandlerFileManager,_CloudModuleHandlerDiagrams,_CloudModuleHandlerUserProfile,_CloudModuleHandlerProcessViewer,_CloudModuleHandlerDashboard,_CloudModuleHandlerSignalR,_CloudModuleHandlerExtendedAttributes,_CloudModuleHandlerTabs,_CloudModuleHandlerUpgrade,_CloudModuleHandlerUserMenu,_CloudModuleHandlerCollaborators,_CloudModuleHandlerBilling,_CloudModuleHandleInvitations){var _self=this;return _self._appHeaderHandler={},_self._appMenuHandler={},_self._commentsHandler={},_self._notificationHandler={},_self._workspaceHandler={},_self._teamHandler={},_self._searchHandler={},_self._memberHandler={},_self._fileManagerHandler={},_self._diagramsHandler={},_self._userProfileHandler={},_self._dashboardHandler={},_self._processViewerHandler={},_self._signalRHandler={},_self._extendedAttributesHandler={},_self._tabsHandler={},_self._upgradeHandler={},_self._userMenuHandler={},_self._collaboratorsHandler={},_self._billingHandler={},_self._invitationsHandler={},_self.applicationHandlers=function(scope){var __self=this,$scope=scope;return __self.instanceHandlers=function(){_self._appHeaderHandler=_CloudModuleHandlerAppHeader.handler($scope),_self._appMenuHandler=_CloudModuleHandlerAppMenu.handler($scope),_self._commentsHandler=_CloudModuleHandlerComments.handler($scope),_self._notificationHandler=_CloudModuleHandlerNotification.handler($scope),_self._workspaceHandler=_CloudModuleHandlerWorkspace.handler($scope),_self._teamHandler=_CloudModuleHandlerTeam.handler($scope),_self._searchHandler=_CloudModuleHandlerSearch.handler($scope),_self._memberHandler=_CloudModuleHandlerMember.handler($scope),_self._fileManagerHandler=_CloudModuleHandlerFileManager.handler($scope),_self._diagramsHandler=_CloudModuleHandlerDiagrams.handler($scope),_self._userProfileHandler=_CloudModuleHandlerUserProfile.handler($scope),_self._processViewerHandler=_CloudModuleHandlerProcessViewer.handler($scope),_self._dashboardHandler=_CloudModuleHandlerDashboard.handler($scope),_self._signalRHandler=_CloudModuleHandlerSignalR.handler($scope),_self._extendedAttributesHandler=_CloudModuleHandlerExtendedAttributes.handler($scope),_self._tabsHandler=_CloudModuleHandlerTabs.handler($scope),_self._upgradeHandler=_CloudModuleHandlerUpgrade.handler($scope),_self._userMenuHandler=_CloudModuleHandlerUserMenu.handler($scope),_self._collaboratorsHandler=_CloudModuleHandlerCollaborators.handler($scope),_self._billingHandler=_CloudModuleHandlerBilling.handler($scope),_self._invitationsHandler=_CloudModuleHandleInvitations.handler($scope)},new __self.instanceHandlers},{applicationHandlers:this.applicationHandlers}}),angular.module("_CloudModule").service("_CloudModuleHandlerAppHeader",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.appHeaderIsReady=function(){},__self.appHeaderHandler=function(){$rootScope.$on(APP.APP_HEADER_MODULE.EVENTS._READY,__self.appHeaderIsReady)},new __self.appHeaderHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerAppBreadcrumb",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.appBreadcrumbIsReady=function(){},__self.appBreadcrumbHandler=function(){$rootScope.$off(APP.APP_BREADCRUMB_MODULE.EVENTS._READY),$rootScope.$on(APP.APP_BREADCRUMB_MODULE.EVENTS._READY,__self.appBreadcrumbIsReady)},new __self.appBreadcrumbHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerAppMenu",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this,translateOptions=function(list){return _.each(list,function(item,i){list[i].name=gettextCatalog.getString(item.name)}),list};return _self.handler=function(scope){var __self=this,$scope=scope;return __self.updateNotifications=function(nNotifications){if($scope.offlineNotification)$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SR_ERROR);else{var sNotificationBadge=angular.element(".bz-cd-notification-option");sNotificationBadge&&nNotifications>0?0===sNotificationBadge.find(".badge").length?($scope.badge=!0,sNotificationBadge.append('<span class="badge">'+nNotifications+"</span>")):sNotificationBadge.find(".badge").text(nNotifications):sNotificationBadge.find(".badge").remove()}},__self.appMenuRefresh=function(){$data.$selectedWorkspace()&&applicationServices.$countNotifications({workspaceId:$data.$selectedWorkspace().id},function(nNotifications){__self.updateNotifications(nNotifications)})},__self.appMenuIsReady=function(){$state&&("CloudIn.workspaces"===$state.current.name?$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:translateOptions(APP.APP_MENU.WORKSPACE_LIST.OPTIONS),actions:APP.APP_MENU.WORKSPACE_LIST.ACTIONS}):"CloudIn.workspaces.diagrams"===$state.current.name?$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:translateOptions(APP.APP_MENU.DIAGRAMS_LIST.OPTIONS),actions:translateOptions(APP.APP_MENU.DIAGRAMS_LIST.ACTIONS),refresh:!0}):"CloudIn.workspaces.processviewer"===$state.current.name?$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:translateOptions(APP.APP_MENU.PROCESS_VIEWER.OPTIONS),actions:translateOptions(APP.APP_MENU.PROCESS_VIEWER.ACTIONS),refresh:!0}):$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:null,actions:null,refresh:!0}))},__self.appMenuHandler=function(){$rootScope.$on(APP.APP_MENU_MODULE.EVENTS._READY,__self.appMenuIsReady),$rootScope.$on(APP.APP_MENU_MODULE.EVENTS._REFRESH,__self.appMenuRefresh)},new __self.appMenuHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerExtendedAttributes",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.extendedAttributesIsReady=function(event,dataExtendedAttributesReady){if(dataExtendedAttributesReady&&"ProcessPool"===dataExtendedAttributesReady.type){var processData={process:{id:dataExtendedAttributesReady.id}};applicationServices.$getProcessExtendedAttributes(processData,function(dataProcessExtendedAttributes){$rootScope.$emit(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._UPDATE,{dataSource:dataProcessExtendedAttributes}),dataProcessExtendedAttributes.hasOwnProperty("definitions")&&dataProcessExtendedAttributes.properties.length?(APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].count=dataProcessExtendedAttributes.properties.length,APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].counter=!0):APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].counter=!1,$timeout(function(){$rootScope.$emit(APP.ASIDE_MODULE.EVENTS.DIRECTIVE._READY)},100)})}else applicationServices.$getExtendedAttributes({},function(dataExtendedAttributes){$rootScope.$emit(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._UPDATE,{dataSource:dataExtendedAttributes}),dataExtendedAttributes.hasOwnProperty("definitions")&&dataExtendedAttributes.properties.length?(APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].count=dataExtendedAttributes.properties.length,APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].counter=!0):APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE[1].counter=!1,$timeout(function(){$rootScope.$emit(APP.ASIDE_MODULE.EVENTS.DIRECTIVE._READY)},100)})},__self.downloadFile=function(event,file){var workspaceId=$data.$selectedWorkspace().id;if($data.$fromModeler()){var shortFileInfo={id:file.id},fileStr=JSON.stringify(shortFileInfo);$data.$callWindowExternal(APP.MODELER.EXTERNAL.SAVE_ATTACHMENT,fileStr)}else{var fileId=file.id,res=fileId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i),fileInfo={workspace:{id:workspaceId},file:file};null!==res?(applicationServices.$downloadFile(fileInfo,function(data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE);var url=data.replace(/"/g,"");file.scope.url=url},function(error){}),applicationServices.$getFileInfo(fileInfo,function(fileData){file.scope.name=fileData.fileNameWithExtension,file.scope.notFound=!1},function(){file.scope.notFound=!0,file.scope.name=APP.EXTENDED_ATTRIBUTES_MODULE.FILE.NOT_FOUND+" "+gettext("Not found file information")})):(file.scope.type="localFile",file.scope.name=fileId.replace(/^.*[\\\/]/,"").replace(/^.*[\/]/,"\\"),file.scope.localRoute=file.scope.localRoute.replace(/[\/]/g,"\\"))}},__self.extendedAttributesExpandedIsReady=function(){applicationServices.$getExtendedAttributes({},function(data){$rootScope.$emit(APP.EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._UPDATE,{dataSource:data})})},__self.extendedAttributesHandler=function(){$rootScope.$off(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._READY),$rootScope.$off(APP.EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._READY),$rootScope.$off(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._DOWNLOAD),$rootScope.$on(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._READY,__self.extendedAttributesIsReady),$rootScope.$on(APP.EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._READY,__self.extendedAttributesExpandedIsReady),$rootScope.$on(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._DOWNLOAD,__self.downloadFile)},new __self.extendedAttributesHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerComments",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,Notification,gettextCatalog){var _self=this,translateOptions=function(list){return _.each(list,function(item,i){list[i].name=gettextCatalog.getString(item.name)}),list};return _self.handler=function(scope){var __self=this,$scope=scope;return __self.commentsIsReady=function(event,data){$scope.$commentsToken="";var scrollWrapper=angular.element(".bz-cd-wrapper-comments");scrollWrapper&&scrollWrapper.scrollTop(0),applicationServices.$getComments({continuationToken:$scope.$commentsToken},function(comments){$scope.$commentsToken=comments.continuationToken,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE);var clonedActions={},clonedOptions={};$data.cloneObject(clonedActions,APP.COMMENTS_MODULE.ACTION_MENU.ACTIONS),$data.cloneObject(clonedOptions,APP.COMMENTS_MODULE.ACTION_MENU.OPTIONS),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._UPDATE,{options:translateOptions(clonedOptions),actions:translateOptions(clonedActions),dataSource:comments,resetComments:!0}),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS.DIRECTIVE._READY)})},__self.getNextPage=function(event,data){""!==$scope.$commentsToken&&($scope.isLoading=!0,applicationServices.$getComments({continuationToken:$scope.$commentsToken},function(comments){$scope.isLoading=!1,$scope.$commentsToken=comments.continuationToken;var actionsComments=clone(APP.COMMENTS_MODULE.ACTION_MENU.ACTIONS),optionsComments=clone(APP.COMMENTS_MODULE.ACTION_MENU.OPTIONS);$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._COMMENTS_UPDATE),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._UPDATE,{options:translateOptions(optionsComments),actions:translateOptions(actionsComments),dataSource:comments})}))},__self.sendComment=function(event,comment){var sndComment={};if(sndComment.text=comment.text,comment.text.length>=2){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Sending comment"))});var displayName="";"CloudIn.workspaces.diagrams"==$state.current.name?displayName=$data.$selectedWorkspace().name:"CloudIn.workspaces.processviewer"==$state.current.name&&(displayName=$data.$selectedDiagram().name),comment.hasOwnProperty("id")?applicationServices.$replyComment(comment,function(data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$scope.addComment="";var notification=new Notification;notification.sender={id:$data.$userProfile().id,userName:$data.$userProfile().userName},notification.ref={key:data.id+","+data.replyTo,displayName:displayName},notification.eventType="Created",notification.objectType="Comments",$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._NEW,notification),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SEND,{id:$data.$selectedWorkspace().id,data:JSON.stringify(notification)}),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._UPDATE,{addReply:comment,dataSource:data}),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._REFRESH,{shapeList:!0})}):applicationServices.$sendComments(sndComment,function(data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$scope.addComment="";var notification=new Notification;notification.sender={id:$data.$userProfile().id,userName:$data.$userProfile().userName},notification.ref={key:data.id,displayName:displayName},notification.eventType="Created",notification.objectType="Comments",$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._NEW,notification),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SEND,{id:$data.$selectedWorkspace().id,data:JSON.stringify(notification)}),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._UPDATE,{add:!0,dataSource:data}),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._REFRESH,{shapeList:!0})})}else $rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The length of comment is too short. You must be write a least 2 characters"))})},__self.commentsHandler=function(){$rootScope.$off(APP.COMMENTS_MODULE.EVENTS._READY),$rootScope.$off(APP.COMMENTS_MODULE.EVENTS._SEND),$rootScope.$off(APP.COMMENTS_MODULE.EVENTS._GET_PAGE),$rootScope.$on(APP.COMMENTS_MODULE.EVENTS._READY,__self.commentsIsReady),$rootScope.$on(APP.COMMENTS_MODULE.EVENTS._SEND,__self.sendComment),$rootScope.$on(APP.COMMENTS_MODULE.EVENTS._GET_PAGE,__self.getNextPage)},new __self.commentsHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerDashboard",function($rootScope,$state,$window,$timeout,application,gettextCatalog,applicationServices,ServicesObjectFactory,Notification,$data,APP,$storage){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;return $scope.applicationMode=!1,$scope.isMobile=$data.$isMobile(),__self.logout=function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),APP.LOGOUT&&APP.APPLICATION_MODULE.API.PATH.membershipService&&$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._STOP)},__self.stopReady=function(){var login=$data.$login();if($data.clearSession(),$rootScope.initialParams={},login&&login.id_token){var urlHost=window.location.protocol+"//"+window.location.host;window.location=APP.APPLICATION_MODULE.API.PATH.membershipService+"core/connect/endsession?id_token_hint="+login.id_token+"&post_logout_redirect_uri="+urlHost}else $data.$fromModeler()?window.location="/oauth.html?isModeler=true":($data.$savePath(location.href),window.location="/oauth.html?isModeler=false")},__self.dashboardModuleIsReady=function(){if(!$rootScope.initialParams){$rootScope.initialParams={};var lparams=angular.copy($state.params);lparams.hasOwnProperty("workspaceId")&&$data.$selectedWorkspace({id:lparams.workspaceId}),lparams.hasOwnProperty("diagramId")&&$data.$selectedDiagram({id:lparams.diagramId,workspaceId:lparams.workspaceId})}var reload=!0;$data.$login()?($data.$userProfile()||(reload=!1,applicationServices.$userProfile(null,function(profile){var userName=profile.useName?profile.userName:profile.email;profile.userName=userName,$data.$userProfile(profile),$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._UPDATE,profile),$data.$fromModeler()&&""===$state.current.name?$state.go("Cloud.Modeler.In"):__self.evaluateReload()})),reload&&__self.evaluateReload()):$rootScope.$emit(APP.EVENTS._LOGOUT)},__self.evaluateReload=function(){$data.$fromModeler()||application.$validatePlan(!1,!1,$scope);var readyModules=!0;"Cloud.Modeler.listWorkspace"===$state.$current.name||"CloudIn.AcceptInvite"===$state.$current.name||"CloudIn.workspaces"===$state.$current.name||"CloudIn.trial"===$state.$current.name||"CloudIn.upgradeWorkGroup"===$state.$current.name||""===$state.$current.name?($state.params.invitationId&&$rootScope.$emit(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._ACCEPT,{workspaceId:$state.params.workspaceId,invitationId:$state.params.invitationId}),"CloudIn.upgradeWorkGroup"===$state.$current.name&&$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._EXECUTE,{from:"userMenuModule",page:"USER_MENU_MODULE.SHOW.UPGRADE"}),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._READY)):"CloudIn.workspaces.diagrams"===$state.$current.name?(readyModules=!1,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,gettextCatalog.getString(gettext("Getting Workspace Information"))),applicationServices.$getWorkspace({id:$state.params.workspaceId},function(dataWs){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$data.$selectedWorkspace(dataWs),__self.readyCommonModules()})):"CloudIn.workspaces.processviewer"===$state.$current.name&&(readyModules=!1,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,gettextCatalog.getString(gettext("Getting Workspace Information"))),applicationServices.$getWorkspace({id:$state.params.workspaceId},function(dataWs){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$data.$selectedWorkspace(dataWs),__self.readyCommonModules(__self.readyForProcessViewer)})),readyModules&&__self.readyCommonModules()},__self.readyCommonModules=function(postReady){$data.$fromModeler()||$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._START),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._READY),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._READY),postReady&&postReady(),$data.$checkRouting($state.$current,APP)},__self.readyForProcessViewer=function(){var diagram=$data.$selectedDiagram(),workspace=$data.$selectedWorkspace(),lparams=angular.copy($state.params);workspace||lparams.hasOwnProperty("workspaceId")&&(workspace={id:lparams.workspaceId},$data.$selectedWorkspace(workspace)),diagram||lparams.hasOwnProperty("diagramId")&&(diagram={id:lparams.diagramId,workspaceId:lparams.workspaceId},$data.$selectedDiagram(diagram));var dataProcessViewer={diagram:{id:diagram.id},workspace:{id:workspace.id}};$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._READY,dataProcessViewer)},__self.processViewerIsReady=function(event,data){data.diagram&&data.diagram.content&&data.diagram.content.displayName&&($data.$selectedDiagram({name:data.diagram.content.displayName}),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._UPDATE,{workspace:$data.$selectedWorkspace().name,workspaceId:$data.$selectedWorkspace().id,diagram:$data.$selectedDiagram().name})),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._READY)},__self.sendNotificationWorkspaceEdited=function(_exe){var notification=new Notification;notification.sender={id:$data.$userProfile().id,userName:$data.$userProfile().userName},notification.ref={displayName:_exe.workspace.name,key:_exe.workspace.id},notification.objectType="ModelProperties",$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._NEW,notification),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SEND,{id:_exe.workspace.id,data:JSON.stringify(notification)})},__self.execute=function(event,_exe){if(_exe.hasOwnProperty("action"))__self.executeAnAction(_exe);else if(_exe.hasOwnProperty("page"))if(_exe.page===APP.PROCESS_VIEWER_MODULE.ACTIONS.FULLSCREEN&&$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._FULL_SCREEN),_exe.page===APP.WORKSPACE_MODULE.ACTIONS.NEW_WORKSPACE)$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettext("New Cloud Model"),module:APP.WORKSPACE_MODULE.NEW_WORKSPACE.TEMPLATES.BASE,actions:APP.WORKSPACE_MODULE.NEW_WORKSPACE.ACTIONS,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{workspace:_exe.workspace},layout:"modal-default",footerVisibility:!0});else if(_exe.page===APP.WORKSPACE_MODULE.ACTIONS.EDIT_WORKSPACE)$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Edit Model Properties")),module:APP.WORKSPACE_MODULE.EDIT_WORKSPACE.TEMPLATES.BASE,actions:APP.WORKSPACE_MODULE.EDIT_WORKSPACE.ACTIONS,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{workspace:_exe.workspace?_exe.workspace:$data.$selectedWorkspace()},layout:"modal-default",footerVisibility:!0});else if(_exe.page===APP.WORKSPACE_MODULE.ACTIONS.SHARE_WORKSPACE){var $redirect={url:APP.WORKSPACE_MODULE.ACTIONS.SHARE_WORKSPACE,data:{workspace:_exe.workspace?_exe.workspace:$data.$selectedWorkspace()}};application.$validatePlan(function(){$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Invite People to Model")),module:APP.WORKSPACE_MODULE.SHARE_WORKSPACE.TEMPLATES.BASE,actions:APP.WORKSPACE_MODULE.SHARE_WORKSPACE.ACTIONS,closeButton:{name:gettext("Close"),visibility:!0},data:{workspace:_exe.workspace?_exe.workspace:$data.$selectedWorkspace()},layout:"modal-medium",footerVisibility:!1})},!0,$scope,$redirect)}else if(_exe.page===APP.WORKSPACE_MODULE.ACTIONS.DELETE_WORKSPACE)$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Delete Model")),module:APP.WORKSPACE_MODULE.DELETE_WORKSPACE.TEMPLATES.BASE,actions:APP.WORKSPACE_MODULE.DELETE_WORKSPACE.ACTIONS,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{workspace:_exe.workspace},layout:"modal-default",footerVisibility:!0});else if(_exe.page===APP.EXTENDED_ATTRIBUTES_MODULE.ACTIONS.OPEN_ATTRIBUTES){var nameShape=$data.$selectedShape().name;gettextCatalog.getString(gettext("Extended Attributes for"));$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString("Extended Attributes for")+" "+nameShape,module:APP.EXTENDED_ATTRIBUTES_MODULE.TEMPLATE.EXPANDED,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:_exe.data,layout:"modal-large",footerVisibility:!0})}else if(_exe.page===APP.DIAGRAMS_MODULE.ACTIONS.UNLOCK_DIAGRAM)$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:"Unlock Diagram",module:APP.DIAGRAMS_MODULE.UNLOCK_DIAGRAM.TEMPLATES.BASE,actions:APP.DIAGRAMS_MODULE.UNLOCK_DIAGRAM.ACTIONS,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{diagram:_exe.diagram}});else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.SHOW_OPTIONS)$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("User Options")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""}),$rootScope.$off(APP.TABS_MODULE.EVENTS._READY),$rootScope.$on(APP.TABS_MODULE.EVENTS._READY,function(){var tabs=__self.listTabs(APP.TABS.USER_OPTIONS,"profile");$rootScope.$emit(APP.TABS_MODULE.EVENTS._UPDATE,{tabs:tabs})});else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.SHOW_UPGRADE)if($data.$fromModeler()){var locationUrl=$data.$getBasePath(),user=$state.params.userName||$data.$userProfile().email;$data.$callWindowExternal(APP.MODELER.EXTERNAL.CALL_EXTERNAL_URL,locationUrl+"index.html#/dashboard/"+user+"/upgrade")}else $rootScope.$off(APP.TABS_MODULE.EVENTS._READY),$rootScope.$on(APP.TABS_MODULE.EVENTS._READY,function(){var tabs=__self.listTabs(APP.TABS.USER_OPTIONS,"upgrade");$rootScope.$emit(APP.TABS_MODULE.EVENTS._UPDATE,{tabs:tabs})}),_exe.hasOwnProperty("from")?(_exe.upgradeToWorkgroup&&$rootScope.selectExternalWorkgroup(!0),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Plan Management")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""})):application.$validatePlan(function(){$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Plan Management")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""})},!0,$scope);else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.SHOW_COLLABORATORS)$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Collaborators")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""}),$rootScope.$off(APP.TABS_MODULE.EVENTS._READY),$rootScope.$on(APP.TABS_MODULE.EVENTS._READY,function(){var tabs=__self.listTabs(APP.TABS.USER_OPTIONS,"collaborators");$rootScope.$emit(APP.TABS_MODULE.EVENTS._UPDATE,{tabs:tabs})});else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.SHOW_BILLING)$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Plan and Billing Info")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""}),$rootScope.$off(APP.TABS_MODULE.EVENTS._READY),$rootScope.$on(APP.TABS_MODULE.EVENTS._READY,function(){var tabs=__self.listTabs(APP.TABS.USER_OPTIONS,"billing");$rootScope.$emit(APP.TABS_MODULE.EVENTS._UPDATE,{tabs:tabs})});else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.INFORMATION_MODELER){var link=APP.APPLICATION_MODULE.API.MODELER._INFORMATION;"es"===$scope.languages.current&&(link=APP.APPLICATION_MODULE.API.MODELER._INFORMATION_ES),window.open(link)}else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.SUPPORT_MODELER){var subscriptionType=$data.$userProfile().subscription.subscriptionType;if("trial"===subscriptionType||"personal"===subscriptionType){var linkSupport=APP.APPLICATION_MODULE.API.MODELER._SUPPORT;"es"===$scope.languages.current&&(linkSupport=APP.APPLICATION_MODULE.API.MODELER._SUPPORT_ES),window.open(linkSupport,"_blank")}else{var subject="Bizagi Cloud Support",win=window.open("mailto:"+APP.APPLICATION_MODULE.API.MODELER._SUPPORT_EMAIL+"?subject="+subject,"emailWindow");
win&&win.open&&!win.closed&&win.close()}}else if(_exe.page===APP.USER_MENU_MODULE.ACTIONS.DOWNLOAD_MODELER){var linkDownloadUrl=APP.APPLICATION_MODULE.API.MODELER._DOWNLOAD;window.open(linkDownloadUrl)}else _exe.page===APP.USER_MENU_MODULE.ACTIONS.LOGOUT?$rootScope.$emit(APP.EVENTS._LOGOUT):_exe.page===APP.USER_MENU_MODULE.ACTIONS.SHOW_SEARCH?$rootScope.$emit(APP.SEARCH_MODULE.EVENTS._UPDATE):"GRID"===_exe.page||"LIST"===_exe.page?($rootScope.$emit(APP.EVENTS._LAYOUT,_exe.page),"GRID"===_exe.page?$storage.$save("layout","grid"):"LIST"===_exe.page&&$storage.$save("layout","list")):_exe.page===APP.COMMENTS_MODULE.ACTIONS.SHOW_COMMENTS?($data.$removeSelectedShape(),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:APP.SIDE_MODULE.RIGHT_SIDE.TABS._COMMENTS,open:!0,shape:""}),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._READY)):_exe.page===APP.NOTIFICATIONS_MODULE.ACTIONS.SHOW_NOTIFICATIONS?$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Model Activity")),module:APP.NOTIFICATIONS_MODULE.TEMPLATES.BASE,side:"left",shapeTitle:""}):"closeCarousel"===_exe.page&&(_exe.hasOwnProperty("redirect")&&_exe.redirect?__self.execute({},{page:_exe.redirect.url,workspace:_exe.redirect.data.workspace}):$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE))},__self.executeAnAction=function(_exe){if(_exe.action===APP.WORKSPACE_MODULE.ACTIONS.NEW_WORKSPACE){var changeToPage=angular.copy(_exe);changeToPage.page=changeToPage.action,delete changeToPage.action,__self.execute({},changeToPage)}if(_exe.action===APP.WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._SAVE)$data.$fromModeler()&&$scope.getCredentialsFromModeler(),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Creating Model"))}),applicationServices.$newWorkspace(_exe.workspace,function(data){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{dataSource:{"new":data}}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$data.$fromModeler()){var newWorkspaceStr=JSON.stringify(data);$data.$callWindowExternal(APP.MODELER.EXTERNAL.NEW_WORKSPACE,newWorkspaceStr)}},function(error){409==error.status&&(gettextCatalog.getString(gettext("There is already a model with this name.")),$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString("There is already a model with this name.")}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE))});else if(_exe.action===APP.COMMENTS_MODULE.ACTIONS.DELETE_COMMENT){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting Comment"))});var dataService={};dataService=_exe.hasOwnProperty("repliedTo")?{id:_exe.comment.id,repliedTo:_exe.repliedTo}:{id:_exe.comment.id},applicationServices.$deleteComment(dataService,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._DELETE,_exe.comment.id,_exe.repliedTo);var notification=new Notification;notification.sender={id:$data.$userProfile().id,userName:$data.$userProfile().userName},notification.ref={key:_exe.comment.id},notification.eventType="Deleted",notification.objectType="Comments",$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._NEW,notification),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SEND,{id:$data.$selectedWorkspace().id,data:JSON.stringify(notification)}),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._REFRESH,{shapeList:!0})})}else if(_exe.action===APP.COMMENTS_MODULE.ACTIONS.REPLY_COMMENT)$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._UPDATE,{reply:!0,comment:_exe.comment});else if(_exe.action===APP.ACTIONS.EXECUTE_IN_MODELER)$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading..."))}),applicationServices.$getAppQuota({},function(quota){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),quota.available>0){var exeModelerUrl,workspaceId;$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Launching Process Modeler Application")),delay:1e3}),$state.params&&$state.params.workspaceId||_exe.workspace?(workspaceId=$state.params&&$state.params.workspaceId?$state.params.workspaceId:_exe.workspace.id,exeModelerUrl="bworkspace:?workspaceId="+workspaceId):exeModelerUrl="bworkspace:?noworkspace","CloudIn.workspaces.processviewer"===$state.current.name&&(exeModelerUrl+="&diagramId="+$state.params.diagramId);var alert=$storage.$load("openInModelerAlert"),do_not_show_again_ME=docCookies.getItem("do_not_show_again_ME")||!1;if(alert||do_not_show_again_ME)location.href=exeModelerUrl;else{var urlModeler=APP.APPLICATION_MODULE.API.MODELER._DOWNLOAD;$rootScope.$emit(APP.ALERT_MODULE.EVENTS._WARNING,gettextCatalog.getString(gettext("Please remember that you must have Bizagi Modeler installed in order to edit your models. You can download it")),function(){location.href=exeModelerUrl},null,{link:urlModeler,text:gettextCatalog.getString(gettext("here")),target:"_blank",showSkipBtn:!0}),$storage.$save("openInModelerAlert","true")}}else $rootScope.$emit(APP.ALERT_MODULE.EVENTS._ERROR,gettextCatalog.getString(gettext("Your account exceeded the quota")))});else if(_exe.action===APP.WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._SAVE)$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Updating Model"))}),applicationServices.$updateWorkspace(_exe.workspace,function(updatedWorkspace){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,_exe.workspace),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),"CloudIn.workspaces.diagrams"===$state.current.name&&$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._UPDATE,{workspace:_exe.workspace.name,workspaceId:null,diagram:null}),$data.$fromModeler()){var updateWorkspaceStr=JSON.stringify(_exe.workspace);$data.$callWindowExternal(APP.MODELER.EXTERNAL.UPDATE_WORKSPACE,updateWorkspaceStr),applicationServices.$me({},function(profile){$data.$userProfile(profile),__self.sendNotificationWorkspaceEdited(_exe)})}else __self.sendNotificationWorkspaceEdited(_exe)},function(error){409==error.status&&($rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString("There is already a model with this name.")}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE))});else if(_exe.action===APP.DIAGRAMS_MODULE.UNLOCK_DIAGRAM.EVENTS._UNLOCK){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Unlocking Diagram"))});var workspace=$data.$selectedWorkspace();applicationServices.$unlockDiagram({workspaceId:workspace.id,diagramId:_exe.diagram.id},function(){$rootScope.$emit(APP.DIAGRAMS_MODULE.EVENTS._UPDATE,{diagramUnlocked:_exe.diagram}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE);var notification=new Notification;notification.sender={id:$data.$userProfile().id,userName:$data.$userProfile().userName},notification.ref={key:_exe.diagram.id,displayName:_exe.diagram.name},notification.eventType="Deleted",notification.objectType="DiagramLock",$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._NEW,notification),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._SEND,{id:$data.$selectedWorkspace().id,data:JSON.stringify(notification)})})}else if(_exe.action===APP.WORKSPACE_MODULE.DELETE_WORKSPACE.EVENTS._DELETE)$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting Model"))}),applicationServices.$deleteWorkspace(_exe.workspace,function(){$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{workspaceDeleted:_exe.workspace}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)});else if(_exe.action===APP.ACTIONS.OPEN_TRIAL_MODAL){var subscription=$data.$subscription(),actualPlan=subscription.subscriptionType;$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Start your free trial")),module:APP.TEMPLATES.MODAL.UPGRADE_TRIAL,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{scope:scope,plan:""===actualPlan||"personal"===actualPlan?"personal":actualPlan,label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))}},layout:"modal-default",footerVisibility:!1})}else _exe.action===APP.ACTIONS.SET_TRIAL_PLAN&&($rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Activating Trial"))}),applicationServices.$activeTrial({},function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),applicationServices.$userProfile({},function(userProfile){$data.$subscription(userProfile.subscription);var oneDay=864e5,firstDate=new Date(userProfile.subscription.startDate).getTime(),secondDate=new Date(userProfile.subscription.endDate).getTime(),currentDate=(new Date).getTime(),endDate=userProfile.subscription.endDate,diffDays=30;$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._UPDATE,{plan:$data.$subscription().subscriptionType.toLowerCase()}),diffDays=currentDate>secondDate?0:currentDate>firstDate?Math.round(Math.abs((currentDate-secondDate)/oneDay)):Math.round(Math.abs((firstDate-secondDate)/oneDay)),$rootScope.$emit(APP.EVENTS._CHANGE_PLAN,{days:diffDays}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:"",module:APP.TEMPLATES.MODAL.WELCOME_TRIAL,closeButton:{name:gettextCatalog.getString(gettext("Close")),visibility:!0},layout:"modal-medium",data:{slides:APP.CAROUSEL.TRIAL.slides,diffDays:diffDays,endDate:endDate,redirect:_exe.redirect},footerVisibility:!1}),$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._UPDATE,userProfile),applicationServices.$updateLicenses({Contributor:2,Editor:2},function(){$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,gettextCatalog.getString(gettext("Your trial has been activated with 2 editors and 2 contributors")))})})}))},__self.changeLayout=function(event,data){$rootScope.layoutSettings=$rootScope.layoutSettings||{models:{layout:"LIST"},diagrams:{layout:"GRID"}},"GRID"===data?("CloudIn.workspaces"===$state.current.name?($rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{layout:"grid"}),$rootScope.layoutSettings.models.layout="GRID"):"CloudIn.workspaces.diagrams"===$state.current.name&&($rootScope.$emit(APP.DIAGRAMS_MODULE.EVENTS._UPDATE,{layout:"grid"}),$rootScope.layoutSettings.diagrams.layout="GRID"),angular.element("#LIST").removeClass("bz-cd-active"),angular.element("#GRID").addClass("bz-cd-active"),$rootScope.layoutModels="GRID"):"LIST"===data&&("CloudIn.workspaces"===$state.current.name?($rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{layout:"list"}),$rootScope.layoutSettings.models.layout="LIST"):"CloudIn.workspaces.diagrams"===$state.current.name&&($rootScope.$emit(APP.DIAGRAMS_MODULE.EVENTS._UPDATE,{layout:"list"}),$rootScope.layoutSettings.diagrams.layout="LIST"),angular.element("#GRID").removeClass("bz-cd-active"),angular.element("#LIST").addClass("bz-cd-active"),$rootScope.layoutModels="LIST")},__self.toggleView=function(element,elementClass){var elementRegEx=/\bcol[^\s]*/g;element.removeClass(function(index,css){return css.match(elementRegEx).join(" ")}).addClass(elementClass)},__self.openModule=function(event,module){$rootScope.$emit(APP[module.toUpperCase()].EVENTS._OPEN)},__self.fail=function(event,message){$scope.hideLoading(),$data.$fromModeler()&&$data.$callWindowExternal(APP.MODELER.EXTERNAL.EXPIRED_SESSION,message)},__self.fromModeler=function(event,data){$state.current.hasOwnProperty("wSize")&&$data.$callWindowExternal(APP.MODELER.EXTERNAL.SET_WINDOW_SIZE,$state.current.wSize.w,$state.current.wSize.h),$scope.applicationMode=data},__self.increaseNotification=function(){var sNotificationBadge=angular.element(".bz-cd-notification-option > .badge"),count=parseFloat(sNotificationBadge.text())+1;sNotificationBadge.text(count)},__self.offlineNotifications=function(){var sNotificationBadge=angular.element(".bz-cd-notification-option > .badge");sNotificationBadge.remove();var offlineNotification=angular.element(".bz-cd-shape-notifications use");offlineNotification.closest(".bz-cd-notification-option").toggleClass("bz-cd-shape-enabled bz-cd-shape-disabled"),offlineNotification.attr("xlink:href","#bz-cd-shape-offline-notification"),offlineNotification.attr("ng-href","#bz-cd-shape-offline-notification"),$scope.offlineNotification=!0},__self.slideModuleClosed=function(event,data){$data.$removeSelectedShape()},__self.listTabs=function(actions,name){for(var tabs=[],i=0;i<actions.length;i++)tabs.push(actions[i]),tabs[i].hasOwnProperty("name")&&tabs[i].name===name?tabs[i].active=!0:tabs[i].active=!1;return tabs},__self.getQuota=function(){applicationServices.$getAppQuota({},function(data){$scope.appQuota=data,$rootScope.$emit(APP.EVENTS._UPDATE_APP_QUOTA,data)})},__self.updateBanner=function(event,banner){$scope.banner=banner},__self.upgradePlan=function(){$scope.banner=!1},__self.downgradePlan=function(){$scope.banner=!0},__self.dashboardHandler=function(){$rootScope.$on(APP.EVENTS._LOGOUT,__self.logout),$rootScope.$on(APP.EVENTS._OPEN_MODULE,__self.openModule),$rootScope.$on(APP.EVENTS._EXECUTE,__self.execute),$rootScope.$on(APP.EVENTS._LAYOUT,__self.changeLayout),$rootScope.$on(APP.EVENTS._FROM_MODELER,__self.fromModeler),$rootScope.$on(APP.EVENTS._INCREASE_NOTIFICATION,__self.increaseNotification),$rootScope.$on(APP.EVENTS._GET_APP_QUOTA,__self.getQuota),$rootScope.$on(APP.EVENTS._VIEW_BANNER,__self.updateBanner),$rootScope.$on(APP.ACTIONS.SET_TRIAL_PLAN,__self.execute),$rootScope.$on(APP.ACTIONS.OPEN_TRIAL_MODAL,__self.execute),$rootScope.$on(APP.APPLICATION_MODULE.EVENTS._FAIL,__self.fail),$rootScope.$off(APP.DASHBOARD_MODULE.EVENTS._READY),$rootScope.$on(APP.DASHBOARD_MODULE.EVENTS._READY,__self.dashboardModuleIsReady),$rootScope.$off(APP.PROCESS_VIEWER_MODULE.EVENTS._CREATE),$rootScope.$on(APP.PROCESS_VIEWER_MODULE.EVENTS._CREATE,__self.processViewerIsReady),$rootScope.$on(APP.SIGNAL_R_MODULE.EVENTS._STOP_READY,__self.stopReady),$rootScope.$on(APP.SIGNAL_R_MODULE.EVENTS._SR_ERROR,__self.offlineNotifications),$rootScope.$on(APP.SIGNAL_R_MODULE.EVENTS._RECEIVED,__self.signalRReceived),$rootScope.$on(APP.SLIDE_CONTENT_MODULE.EVENTS._CLOSED,__self.slideModuleClosed),$rootScope.$on("WINDOW_EXTERNAL",function(event,data){$data.$callWindowExternal(APP.MODELER.EXTERNAL.CALL_EXTERNAL_URL,data)}),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._UPGRADE,__self.upgradePlan),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._DOWNGRADE_PLAN,__self.downgradePlan)},__self.signalRReceived=function(e,data){"Comments"===data.objectType&&$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._READY)},new __self.dashboardHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerDiagrams",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;return __self.diagramsModuleIsReady=function(){$scope.loadingImage=APP.LOADING_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Diagrams"))}),applicationServices.$diagramsList($scope.dataUser,function(data){var userIds="?";angular.forEach(data,function(em){em.lockingInfo&&userIds.indexOf(em.lockingInfo.userId)>-1==0&&(userIds=userIds+"id="+em.lockingInfo.userId+"&")}),userIds.length>1?applicationServices.$getUsersById({queryStringIds:userIds},function(dataResult){$rootScope.$emit(APP.DIAGRAMS_MODULE.EVENTS._USERS_DIAGRAMS,dataResult),__self.emitUpdate(data)}):__self.emitUpdate(data)})},__self.emitUpdate=function(data){$rootScope.$emit(APP.DIAGRAMS_MODULE.EVENTS._UPDATE,{dataSource:data}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},__self.diagramsHandler=function(){$rootScope.$on(APP.DIAGRAMS_MODULE.EVENTS._READY,__self.diagramsModuleIsReady)},new __self.diagramsHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerFileManager",function($rootScope,$state,$timeout,$location,applicationServices,gettextCatalog,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(scope){function guid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}function confirmFile(uploadFile){applicationServices.$uploadSingleFileConfirm(uploadFile,function(){applicationServices.$getQuota({content:{workspace:uploadFile.workspace}},function(quota){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,{quotaByModel:quota}),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,gettextCatalog.getString(gettext("The operation was completed successfully"))),$rootScope.searchText="",__self.listFiles(uploadFile.workspace.id,{itemsPerPage:$scope.itemsPerPage})})})}function confirmFiles(uploadFiles,lstIdsFilesToConfirm){uploadFiles.files.length===$scope.countCallServicesFiles&&(uploadFiles.filesConfirm=lstIdsFilesToConfirm,applicationServices.$uploadFilesConfirm(uploadFiles,function(){applicationServices.$getQuota({content:{workspace:uploadFiles.workspace}},function(quota){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,{quotaByModel:quota}),$rootScope.searchText="",__self.listFiles(uploadFiles.workspace.id,{itemsPerPage:$scope.itemsPerPage})})}))}function UpdateQuota(workspaceId){applicationServices.$getQuota({content:{workspace:workspaceId}},function(quota){$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,{quotaByModel:quota})})}var __self=this,$scope=scope;return __self.fileManagersIsReady=function(event,dataFileManager){var workspaceId=$data.$selectedWorkspace()?$data.$selectedWorkspace().id:"";if($data.$fromModeler())if($scope.getCredentialsFromModeler(),__self.setTitleForWindowModeler(),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,{pageTitle:"File Manager"}),workspaceId=$data.$callWindowExternal(APP.MODELER.EXTERNAL.GET_WORKSPACE_ID),workspaceId.length){$data.$selectedWorkspace({id:workspaceId});var fileID=$data.$callWindowExternal(APP.MODELER.EXTERNAL.GET_SELECTED_FILE_ID);if(fileID){var fileInfo={workspace:{id:workspaceId},file:{id:fileID}};applicationServices.$getFileInfo(fileInfo,function(filePreselected){$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._HAS_PRESELECTED_FILE,filePreselected)})}}else $rootScope.$emit(APP.EVENTS._ERROR,"The workspace id is undefined, please try to select another workspace");__self.listFiles(workspaceId,dataFileManager),UpdateQuota(workspaceId)},__self.setTitleForWindowModeler=function(){var windowTitle;if($location.search().linkedFiles)windowTitle="Select Attachment",$location.search().task&&(windowTitle=$location.search().task+" - Select Attachment");else{var res=gettextCatalog.getString(gettext("Cloud Attachments"));windowTitle=gettextCatalog.getString(res)}$rootScope.$emit(APP.EVENTS._WINDOW_TITLE,{title:windowTitle})},__self.listFiles=function(workspaceId,dataFileManager){var fileInfo={};workspaceId?($rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading List of Files"))}),fileInfo={workspace:{id:workspaceId}},dataFileManager&&(angular.extend(fileInfo,dataFileManager),$scope.itemsPerPage=dataFileManager.itemsPerPage),applicationServices.$getListFiles(fileInfo,function(files){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,files)})):($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.EVENTS._ERROR,"The workspace id is undefined, please try to select another workspace"))},__self.uploadFile=function(event,el){var workspaceId=$data.$selectedWorkspace().id;$scope.toUpload=el[0].files[0],$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString("Loading List of Files")});var guidTransactionId=guid();$scope.countCallServicesFiles=0;var re=/(?:\.([^.]+))?$/,ext=re.exec($scope.toUpload.name)[0],name=$scope.toUpload.name.replace(ext,""),fileToUpload={workspace:{id:workspaceId},transactionId:guidTransactionId,file:{fileName:name,extension:ext,length:$scope.toUpload.size},fileData:$scope.toUpload};el.val(""),__self.callServiceToUploadSingleFile(fileToUpload)},__self.callServiceToUploadSingleFile=function(uploadFile){applicationServices.$uploadFileStart(uploadFile,function(file){var url=_.find(file.links,function(fil){return"UploadTo"===fil.title});file.url=url.href,file.fileData=uploadFile.fileData,file.transactionId=uploadFile.transactionId,file.workspace=uploadFile.workspace,applicationServices.$uploadFileProcess(file,function(){uploadFile.fileId=file.id,confirmFile(uploadFile)})},function(error){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),"FileExtensionNoAllowed"===error.data.message?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The file type is not allowed"))}):"InvalidFile"===error.data.message?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The file that you are trying to upload is not valid"))}):"InvalidFileName"===error.data.message?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("File name has invalid characters"))}):"UnavailableStorageSpace"===error.data.message&&$rootScope.$emit(APP.ALERT_MODULE.EVENTS._WARNING,gettextCatalog.getString(gettext("This upload exceeds your quota")),function(){},null,{})})},__self.callServiceToUploadFile=function(uploadFiles){applicationServices.$uploadFilesStart(uploadFiles,function(files){if("string"==typeof files&&""===files)$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._WARNING,gettextCatalog.getString(gettext("This upload exceeds your quota")),function(){},null,{});else{var lstIdsFilesToConfirm={};0==files.length&&($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.EVENTS._ERROR,"Could not load files"))}angular.forEach(files,function(file){var url=_.find(file.links,function(fil){return"UploadTo"===fil.title}),fileData=_.find(uploadFiles.filesData,function(fil){return fil.name===file.fileNameWithExtension});file.url=url.href,file.fileData=fileData,file.transactionId=uploadFiles.transactionId,file.workspace=uploadFiles.workspace,applicationServices.$uploadFileProcess(file,function(){$scope.countCallServicesFiles++,lstIdsFilesToConfirm[file.id]=!0,confirmFiles(uploadFiles,lstIdsFilesToConfirm)},function(){$scope.countCallServicesFiles++,lstIdsFilesToConfirm[file.id]=!1,confirmFiles(uploadFiles,lstIdsFilesToConfirm)})})})},__self.deleteFile=function(event,data){var workspaceId=$data.$selectedWorkspace().id;$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting File"))});var deleteFile={workspace:{id:workspaceId},file:{id:data}};applicationServices.$deleteFile(deleteFile,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),UpdateQuota(workspaceId)})},__self.updateFileName=function(event,fileId,newName){var workspaceId=$data.$selectedWorkspace().id,res=gettextCatalog.getString(gettext("Renaming File to:")),renameRes=gettextCatalog.getString(res);$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:renameRes+" "+newName});var fileInfo={workspace:{id:workspaceId},file:{id:fileId,newName:newName}};applicationServices.$renameFile(fileInfo,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATED_FILE_NAME,fileId)})},__self.downloadFile=function(event,file){var workspaceId=$data.$selectedWorkspace().id;if($data.$fromModeler()){var shortFileInfo={id:file.id,fileName:file.fileName,extension:file.extension},fileStr=JSON.stringify(shortFileInfo);$data.$callWindowExternal(APP.MODELER.EXTERNAL.SAVE_ATTACHMENT,fileStr)}else{var fileInfo={workspace:{id:workspaceId},file:file};applicationServices.$downloadFile(fileInfo,function(data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE);var url=data.replace(/"/g,"");location.href=url})}},__self.linkFile=function(event,file){if($data.$fromModeler()){var shortFileInfo={id:file.id,fileName:file.fileName,extension:file.extension},fileStr=JSON.stringify(shortFileInfo);$data.$callWindowExternal(APP.MODELER.EXTERNAL.LINK_FILE,fileStr),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Linking File")),delay:1e3})}else $rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Linking File"))}),$timeout(function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},500)},__self.getPage=function(event,newPage){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading List of Files"))});var fileInfo={workspace:{id:$data.$selectedWorkspace().id},page:newPage,searchFileName:$rootScope.searchText?$rootScope.searchText:"",itemsPerPage:$scope.itemsPerPage};applicationServices.$getListFiles(fileInfo,function(files){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,files)})},__self.searchFiles=function(event,search){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading List of Files"))});var fileInfo={workspace:{id:$data.$selectedWorkspace().id},searchFileName:search,itemsPerPage:$scope.itemsPerPage};applicationServices.$getListFiles(fileInfo,function(files){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE,files)})},__self.fileManagerHandler=function(){$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._READY,__self.fileManagersIsReady),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._FILE_UPLOAD_CHANGE,__self.uploadFile),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._DELETE,__self.deleteFile),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._UPDATE_FILE_NAME,__self.updateFileName),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._DOWNLOAD,__self.downloadFile),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._LINK_FILE,__self.linkFile),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._GET_PAGE,__self.getPage),$rootScope.$on(APP.FILE_MANAGER_MODULE.EVENTS._SEARCH_FILES,__self.searchFiles)},new __self.fileManagerHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerMember",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;return __self.memberModuleListIsReady=function(event,dataPage){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Members"))}),$data.$fromModeler()?($scope.getCredentialsFromModeler(),applicationServices.$me({},function(profile){$data.$userProfile(profile),__self.memberList(dataPage)})):__self.memberList(dataPage)},__self.memberList=function(dataPage){applicationServices.$memberList(dataPage,function(memberData){memberData.content.length?($rootScope.$emit(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._UPDATE,{memberList:memberData}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)):$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.memberModuleUpdate=function(event,dataMember){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Updating User Role"))}),applicationServices.$memberUpdate(dataMember,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.memberModuleDelete=function(event,dataMemberId){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting User"))}),applicationServices.$memberDelete(dataMemberId,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.memberModuleListSave=function(event,dataMemberList){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Adding people to model"))}),applicationServices.$memberInvite(dataMemberList,function(memberData){memberData.pageSize=6,$rootScope.$emit(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,memberData),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.memberModuleInviteIsReady=function(){$rootScope.$emit(APP.MEMBER_MODULE.INVITE_MEMBER.EVENTS._UPDATE)},__self.memberHandler=function(){$rootScope.$on(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,__self.memberModuleListIsReady),$rootScope.$on(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._SAVE,__self.memberModuleUpdate),$rootScope.$on(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._DELETE,__self.memberModuleDelete),$rootScope.$on(APP.MEMBER_MODULE.INVITE_MEMBER.EVENTS._READY,__self.memberModuleInviteIsReady)},new __self.memberHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerNotification",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;return __self.notificationsIsReady=function(){$scope.$commentsToken="";var scrollWrapper=angular.element(".bz-cd-wrapper-comments");scrollWrapper&&scrollWrapper.scrollTop(0),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Model Activity"))}),applicationServices.$getNotifications({workspaceId:$data.$selectedWorkspace().id,continuationToken:$scope.$commentsToken},function(responseNotifications){$scope.$commentsToken=responseNotifications.continuationToken,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.NOTIFICATIONS_MODULE.EVENTS._UPDATE,responseNotifications),applicationServices.$diagramsList($scope.dataUser,function(data){$rootScope.$emit(APP.NOTIFICATIONS_MODULE.EVENTS._CHANGE,data)})})},__self.getNextPage=function(event,data){""!==$scope.$commentsToken&&($scope.isLoading=!0,applicationServices.$getNotifications({workspaceId:$data.$selectedWorkspace().id,continuationToken:$scope.$commentsToken},function(responseNotifications){$scope.isLoading=!1,$scope.$commentsToken=responseNotifications.continuationToken,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.NOTIFICATIONS_MODULE.EVENTS._UPDATE,responseNotifications)}))},__self.markAsRead=function(event,asRead){var markAsReadData={markAsRead:asRead,workspaceId:$data.$selectedWorkspace().id};applicationServices.$markAsReadNotifications(markAsReadData,function(){$rootScope.$emit("markAsRead"),$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._READY)})},__self.notificationHandler=function(){$rootScope.$on(APP.NOTIFICATIONS_MODULE.EVENTS._READY,__self.notificationsIsReady),$rootScope.$on(APP.NOTIFICATIONS_MODULE.EVENTS._MARK_AS_READ,__self.markAsRead),$rootScope.$on(APP.NOTIFICATIONS_MODULE.EVENTS._GET_PAGE,__self.getNextPage)},new __self.notificationHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerProcessViewer",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(){var __self=this;return __self.processViewerIsReady=function(event,data){if($data.$selectedDiagram()){var diagram=$data.$selectedDiagram(),nameDiagram=diagram.hasOwnProperty("name")&&diagram.name?diagram.name:"Diagram";$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Process:")),concat:nameDiagram}),applicationServices.$getDiagramDefinition(data,function(diagramDefinition){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._CREATE,diagramDefinition)});var subscription=$data.$subscription();
"personal"!==subscription.subscriptionType&&applicationServices.$getShapesWithComments(data,function(shapeList){$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._UPDATE,{comments:shapeList})})}},__self.processViewerRefresh=function(event,data){var dataExtend={diagram:{id:$data.$selectedDiagram().id},workspace:{id:$data.$selectedWorkspace().id}};angular.extend(data,dataExtend),data.hasOwnProperty("all")&&($rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Process:")),concat:$data.$selectedDiagram().name}),applicationServices.$getDiagramDefinition(data,function(diagramDefinition){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._CREATE,diagramDefinition)})),(data.hasOwnProperty("all")||data.hasOwnProperty("shapeList"))&&applicationServices.$getShapesWithComments(data,function(shapeList){$rootScope.$emit(APP.PROCESS_VIEWER_MODULE.EVENTS._UPDATE,{comments:shapeList})})},__self.getCommentsByShape=function(event,data){gettext("sequenceflow"),gettext("events"),gettext("artifacts"),gettext("artifact"),gettext("gateways"),gettext("messageflow"),gettext("association"),gettext("data"),gettext("processpool"),gettext("activities");var shape=({workspace:{id:$data.$selectedWorkspace().id},diagram:{id:$data.$selectedDiagram().id},shape:{id:data.id}},{name:gettextCatalog.getString(data.name),id:data.id,type:data.type,description:data.description});$data.$selectedShape(data),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE,empty:!0});var subscriptionType=$data.userProfile.subscription.subscriptionType,tabsContent=APP.SIDE_MODULE.RIGHT_SIDE.TABS._BY_SHAPE;"personal"===subscriptionType&&(tabsContent=APP.SIDE_MODULE.RIGHT_SIDE.TABS._EXTENDED_ATTRIBUTES),angular.element(".bz-cd-comments")&&$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:tabsContent,plan:$data.userProfile.subscription.subscriptionType,open:!0,shape:shape}),"personal"!==subscriptionType&&$rootScope.$emit(APP.COMMENTS_MODULE.EVENTS._READY),$rootScope.$emit(APP.EXTENDED_ATTRIBUTES_MODULE.EVENTS._READY,shape)},__self.processViewerHandler=function(){$rootScope.$on(APP.PROCESS_VIEWER_MODULE.EVENTS._READY,__self.processViewerIsReady),$rootScope.$on(APP.PROCESS_VIEWER_MODULE.EVENTS._REFRESH,__self.processViewerRefresh),$rootScope.$on(APP.PROCESS_VIEWER_MODULE.EVENTS._SHAPE_COMMENT_CLICKED,__self.getCommentsByShape)},new __self.processViewerHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerSearch",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(){var __self=this;return __self.searchModuleIsReady=function(){},__self.searchModuleSearch=function(event,searchQuery){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Searching Workspaces"))}),applicationServices.$searchWorkspace(searchQuery,function(searchResults){searchResults?($rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{title:"",dataSource:searchResults}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)):$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit($app.$events().error,{message:error.message})})},__self.searchHandler=function(){$rootScope.$on(APP.SEARCH_MODULE.EVENTS._READY,__self.searchModuleIsReady),$rootScope.$on(APP.SEARCH_MODULE.EVENTS._SAVE,__self.searchModuleSearch)},new __self.searchHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerSignalR",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.updateAppMenu=function(event,objectType){$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._REFRESH),"ModelProperties"===objectType&&$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._READY,!0)},__self.signalRHandler=function(){$rootScope.$on(APP.SIGNAL_R_MODULE.EVENTS._SENDED,__self.updateAppMenu)},new __self.signalRHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerTeam",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(){var __self=this;return __self.teamModuleListIsReady=function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Team"))}),applicationServices.$teamList({},function(teamData){teamData?($rootScope.$emit(APP.TEAM_MODULE.NEW_TEAM.EVENTS._UPDATE,{showTeamNew:!1}),$rootScope.$emit(APP.TEAM_MODULE.LIST_TEAM.EVENTS._UPDATE,teamData),$rootScope.$emit(APP.MEMBER_MODULE.INVITE_MEMBER.EVENTS._UPDATE,{showMemberInvite:!0}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)):$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.teamModuleNew=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Creating New Team"))}),applicationServices.$teamNew(data,function(teamData){$rootScope.$emit(APP.TEAM_MODULE.NEW_TEAM.EVENTS._UPDATE,{showTeamNew:!1}),$rootScope.$emit(APP.TEAM_MODULE.LIST_TEAM.EVENTS._UPDATE,teamData),$rootScope.$emit(APP.MEMBER_MODULE.INVITE_MEMBER.EVENTS._UPDATE,{showMemberInvite:!0}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.teamModuleInvite=function(event,dataMemberList){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Sending Invites"))}),applicationServices.$memberInvite(dataMemberList,function(memberData){memberData.pageSize=6,$rootScope.$emit(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,memberData),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.teamHandler=function(){$rootScope.$on(APP.TEAM_MODULE.LIST_TEAM.EVENTS._READY,__self.teamModuleListIsReady),$rootScope.$on(APP.TEAM_MODULE.NEW_TEAM.EVENTS._SAVE,__self.teamModuleNew),$rootScope.$on(APP.TEAM_MODULE.INVITE_MEMBER.EVENTS._SAVE,__self.teamModuleInvite)},new __self.teamHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerUserProfile",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;return __self.userProfileIsReady=function(){$data.$fromModeler()&&($scope.getCredentialsFromModeler(),__self.setTitleForWindowModeler()),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading User Profile"))}),applicationServices.$getCountries({},function(countries){$rootScope.$emit(APP.USER_PROFILE_MODULE.EVENTS._UPDATE_COUNTRIES,countries)},function(){}),applicationServices.$me({},function(userProfile){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.USER_PROFILE_MODULE.EVENTS._UPDATE,userProfile)})},__self.setTitleForWindowModeler=function(){var windowTitle;windowTitle="User Profile",$rootScope.$emit(APP.EVENTS._WINDOW_TITLE,{title:windowTitle})},__self.userProfileSave=function(event,data){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Updating Profile"))}),applicationServices.$updateUserProfile(data,function(){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$data.$userProfile(data),$rootScope.$emit(APP.USER_PROFILE_MODULE.EVENTS._UPDATE,data),$data.$fromModeler()){var userProfileUpdatedStr=JSON.stringify(data);$data.$callWindowExternal(APP.MODELER.EXTERNAL.USER_PROFILE_UPDATED,userProfileUpdatedStr)}}),$scope.changePassword&&$scope.newPassword){var changePasswordData={oldPassword:$scope.oldPassword,newPassword:$scope.newPassword};applicationServices.$changePassword(changePasswordData,function(){$rootScope.$emit(APP.CHANGE_PASSWORD_MODULE.EVENTS._SUCCESS,"Your password has been changed")},function(result){$rootScope.$emit(APP.CHANGE_PASSWORD_MODULE.EVENTS._FAIL,result)})}},__self.setChangePasswordModule=function(event,data){$scope.changePassword=!0,$scope.newPassword=data.newPassword,$scope.oldPassword=data.currentPassword},__self.userProfileHandler=function(){$rootScope.$on(APP.CHANGE_PASSWORD_MODULE.EVENTS._ACTIVE,__self.setChangePasswordModule),$rootScope.$on(APP.USER_PROFILE_MODULE.EVENTS._READY,__self.userProfileIsReady),$rootScope.$on(APP.USER_PROFILE_MODULE.EVENTS._SAVE,__self.userProfileSave)},new __self.userProfileHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerWorkspace",function($rootScope,$state,$location,$timeout,$q,gettextCatalog,applicationServices,ServicesObjectFactory,$data,application,APP,$stateParams){var _self=this;return _self.handler=function(scope){var __self=this,$scope=scope;__self.actualPage=1,__self.maxPages=10,$scope.isBusy=!1,__self.workspaceModuleIsReady=function(event,refresh){var userData={};$scope.loadingImage=APP.LOADING_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Models"))}),refresh||$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:[],actions:[],viewName:"Workspace List"}),$stateParams.invitationId,$data.$fromModeler()?(__self.setTitleForWindowModeler(gettextCatalog.getString(gettext("Open Model"))),$scope.getCredentialsFromModeler(),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{options:[],actions:[],title:""}),userData={user:$data.$userProfile().userName},userData.blockContributors=!0,applicationServices.$workspaceList(userData,function(responseWorkspaceList){$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{title:"",dataSource:responseWorkspaceList,visibility:{newWorkspace:!1}}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})):(__self.actualPage=1,__self.listWorkspaces(refresh),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._START),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._EXTERNALURI))},__self.listWorkspaces=function(refresh){var nextPage=__self.actualPage++,userData={user:$data.$userProfile().userName64,page:nextPage};applicationServices.$getSubscriptionInfo(null,function(subscriptionInfo){applicationServices.$workspaceList(userData,function(data){__self.maxPages=data.totalPages,nextPage<=__self.maxPages&&$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{newPage:!0,title:"",dataSource:data,subscriptionInfo:subscriptionInfo,refreshFromBreadCrumb:refresh}),$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{visibility:{newWorkspace:!0,deleteWorkspace:!0},subscriptionInfo:subscriptionInfo}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})})},__self.setTitleForWindowModeler=function(windowTitle){$rootScope.$emit(APP.EVENTS._WINDOW_TITLE,{title:windowTitle})},__self.workspaceModuleNewIsReady=function(){if($data.$fromModeler()){var res=gettextCatalog.getString("New Cloud Model"),title=gettextCatalog.getString(res);$location.search().upload&&(res=gettextCatalog.getString(gettext("Save Model")),title=gettextCatalog.getString(res),$rootScope.$emit(APP.WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._UPDATE,{text:{workspaceName:"Model name",workspaceDescription:"Model description"},actions:APP.WORKSPACE_MODULE.NEW_WORKSPACE.ACTIONS_UPLOAD})),__self.setTitleForWindowModeler(title);var workspaceFromModeler=$data.$callWindowExternal(APP.MODELER.EXTERNAL.GET_WORKSPACE);$rootScope.$emit(APP.WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._UPDATE,{title:"",actions:APP.WORKSPACE_MODULE.NEW_WORKSPACE.ACTIONS,workspace:workspaceFromModeler}),$scope.getCredentialsFromModeler()}},__self.workspaceModuleEditIsReady=function(event,workspace){var workspaceId;if($data.$fromModeler()){var res=gettextCatalog.getString(gettext("Edit Model Properties")),translatedText=gettextCatalog.getString(res);__self.setTitleForWindowModeler(translatedText),$rootScope.$emit(APP.SIGNAL_R_MODULE.EVENTS._START),$rootScope.$emit(APP.WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._UPDATE,{title:"",actions:APP.WORKSPACE_MODULE.EDIT_WORKSPACE.ACTIONS}),$scope.getCredentialsFromModeler(),workspaceId=$data.$callWindowExternal(APP.MODELER.EXTERNAL.GET_WORKSPACE_ID),workspaceId&&workspaceId.length?applicationServices.$getWorkspace({id:workspaceId},function(workspace){$data.$selectedWorkspace(workspace),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._UPDATE,workspace)}):$rootScope.$emit(APP.EVENTS._ERROR,"The workspace id is undefined, please try to select another workspace")}else $data.$selectedWorkspace(workspace)},__self.workspaceIsSelected=function(event,workspace){if($data.$selectedWorkspace(workspace),$data.$fromModeler()){var workspaceStr=JSON.stringify(workspace);$data.$callWindowExternal(APP.MODELER.EXTERNAL.SELECTED_WORKSPACE,workspaceStr)}else $rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading model"))}),applicationServices.$getWorkspace({id:workspace.id},function(){$state.go("CloudIn.workspaces.diagrams",{workspaceId:workspace.id,selectedworkspace:workspace})})},__self.workspaceModuleShareIsReady=function(){var workspaceId;$data.$fromModeler()?(__self.setTitleForWindowModeler(gettextCatalog.getString(gettext("Share Model"))),$scope.getCredentialsFromModeler(),workspaceId=$data.$callWindowExternal(APP.MODELER.EXTERNAL.GET_WORKSPACE_ID),$rootScope.$emit(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._UPDATE,{workspaceId:workspaceId,member:{invite:APP.MEMBER_MODULE.INVITE_MEMBER.TEMPLATES.BASE,list:APP.MEMBER_MODULE.LIST_MEMBER.TEMPLATES.BASE}})):$rootScope.$emit(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._UPDATE,{workspaceId:workspaceId,member:{invite:APP.MEMBER_MODULE.INVITE_MEMBER.TEMPLATES.BASE,list:APP.MEMBER_MODULE.LIST_MEMBER.TEMPLATES.BASE}})},__self.setMemberAccess=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Updating Member Access"))}),applicationServices.$setMemberAccess(data,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){409==error.status&&$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("There are not available licenses"))}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})},__self.workspaceModuleShareInvite=function(event,dataMemberList){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Sending invitations to model"))}),applicationServices.$getSubscriptionInfo({},function(data){dataMemberList.subscriptionId=$data.$userProfile().subscription.id,applicationServices.$memberInviteWorkspace(dataMemberList,function(result){var errorExistsEmailInModel=__self.showErrorExistsEmailInModel(result),invitationsSentSuccessfully=__self.showInvitationsSentSuccessfully(result);result.saved.length>0&&$rootScope.$emit(APP.MEMBER_MODULE.INVITE_MEMBER.EVENTS._CHANGE_TAB,"pendingInvitations");var resultMessage=errorExistsEmailInModel+invitationsSentSuccessfully;$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._READY,{workspaceId:dataMemberList.workspaceId}),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,{message:resultMessage},null,1e4)})})},__self.showInvitationsSentSuccessfully=function(result){return result.saved.length>0?"<b>"+gettextCatalog.getString(gettext("Invitations sent successfully"))+"</b>":""},__self.showErrorExistsEmailInModel=function(result){var notSavedDatabaseError=_self.getDatabaseError(result);if(""!=notSavedDatabaseError)return notSavedDatabaseError;var notSavedConflict=_self.getConflictError(result),notSavedDuplicated=_self.getDuplicatedError(result),notSavedUnavailableLicenses=_self.getUnavailableLicensesError(result),notSavedUnavailableInvitations=_self.getUnavailableInvitationsError(result);return notSavedDuplicated+notSavedConflict+notSavedUnavailableLicenses+notSavedUnavailableInvitations},_self.getDatabaseError=function(result){return result=_self.selectWhere(result.notSaved,"DatabaseError"),result.length>0?"<b>"+gettextCatalog.getString(gettext("has occurred an error while the transaction was being processed"))+"</b>":""},_self.getDuplicatedError=function(result){var resultUl="";return result=_self.selectWhere(result.notSaved,"Duplicated"),result.length>0?(_.each(result,function(ech){resultUl+='<li><i class="fa fa-envelope"></i> '+ech.content.email+"</li>"}),"<b>"+gettextCatalog.getString(gettext("The following emails are already part of the model:"))+'</b><ul class="listMailMessage">'+resultUl+"</ul>"):resultUl},_self.getConflictError=function(result){var resultUl="";return result=_self.selectWhere(result.notSaved,"Conflict"),result.length>0?(_.each(result,function(ech){resultUl+='<li><i class="fa fa-envelope"></i> '+ech.content.email+"</li>"}),"<b>"+gettextCatalog.getString(gettext("The following emails already have a pending invitation:"))+'</b><ul class="listMailMessage">'+resultUl+"</ul>"):resultUl},_self.getUnavailableLicensesError=function(result){var resultUl="";return result=_self.selectWhere(result.notSaved,"UnavailableLicenses"),result.length>0?(_.each(result,function(ech){resultUl+='<li><i class="fa fa-envelope"></i> '+ech.content.email+"</li>"}),"<b>"+gettextCatalog.getString(gettext("Licenses not available for the following email invitations:"))+'</b><ul class="listMailMessage">'+resultUl+"</ul>"):resultUl},_self.getUnavailableInvitationsError=function(result){var resultUl="";return result=_self.selectWhere(result.notSaved,"UnavailableInvitations"),result.length>0?(_.each(result,function(ech){resultUl+='<li><i class="fa fa-envelope"></i> '+ech.content.email+"</li>"}),"<b>"+gettextCatalog.getString(gettext("Invitations not available for the following emails:"))+'</b><ul class="listMailMessage">'+resultUl+"</ul>"):resultUl},_self.selectWhere=function(result,propertyName){for(var resultWithFilter=[],i=0;i<result.length;i++)result[i].status==propertyName&&resultWithFilter.push(result[i]);return resultWithFilter},__self.validateAvailableLicenses=function(dataMemberList,licenses){var isEditor=!(!dataMemberList.list[0].hasOwnProperty("access")||"Editor"!==dataMemberList.list[0].access),countEditors=0,countContributors=0,editors=_.where(licenses,{licenseType:"Editor"}),contributors=_.where(licenses,{licenseType:"Contributor"});_.each(editors,function(val,i){val.hasOwnProperty("userId")&&countEditors++}),_.each(contributors,function(val,i){val.hasOwnProperty("userId")&&countContributors++});var editorsAvailableCount=editors.length-countEditors,contributorsAvailableCount=contributors.length-countContributors;return isEditor?editorsAvailableCount>0:contributorsAvailableCount>0},__self.workspaceModuleShareList=function(event,dataPage){applicationServices.$memberListWorkspace(dataPage,function(memberData){$rootScope.$emit(APP.MEMBER_MODULE.LIST_MEMBER.EVENTS._UPDATE,{memberList:memberData}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){$rootScope.$emit(APP.EVENTS._ERROR,{message:error.message})})},__self.getNextPage=function(){if($data.$userProfile()){var nextPage=__self.actualPage++;if(nextPage<=__self.maxPages){var userData={user:$data.$userProfile().userName64,page:nextPage};$scope.isBusy=!0,applicationServices.$workspaceList(userData,function(data){__self.maxPages=data.totalPages,$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._UPDATE,{newPage:!0,title:"",dataSource:data,visibility:{newWorkspace:!0,deleteWorkspace:!0}}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$scope.isBusy=!1})}}},__self.workspaceModuleShareAccept=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Accepting invitation to model"))}),applicationServices.$memberAcceptInvitation(data,function(data){$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,gettextCatalog.getString(gettext("You now have access to "))+data.name),__self.actualPage=1,__self.listWorkspaces(),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},function(error){if(400==error.status&&"UserInModel"==error.data.message?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The user is already part of the model"))}):400==error.status?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("This link has expired"))}):409==error.status?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The owner of the model has no licenses available"))}):403==error.status?$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("The invitation to the model has already been used"))}):404==error.status&&$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("Invitation not found"))}),400==error.status&&"ConflictEmailUserInvitation"==error.data.message.split(",")[0]){var emailInvitation=error.data.message.split(",")[1];$rootScope.$emit(APP.ALERT_MODULE.EVENTS._WARNING,gettextCatalog.getString("The invitation was for ")+obfuscateEmail(emailInvitation)+"<br>"+gettextCatalog.getString("You are logged with a different account."),function(){},null,{})}})};var obfuscateEmail=function(email){var firstPart=email.split("@")[0],secondPart=email.split("@")[1],finalEmail=firstPart.substring(0,3)+firstPart.substring(3,firstPart.length).replace(new RegExp(/[^]/g),"*")+"@"+secondPart;return finalEmail};return __self.routeExternalURIS=function(){var _actualPlan=$data.$subscription().subscriptionType,_workspaceTrial=function(m){return _actualPlan===APP.WORKSPACE_MODULE.ROUTE_EXTERNAL_URL.CONSTANTS.PERSONAL_PLAN||""===_actualPlan?void m.isPersonal():void m.isWorkGroup()},listTabs=function(actions,name){for(var tabs=[],i=0;i<actions.length;i++)tabs.push(actions[i]),tabs[i].hasOwnProperty("name")&&tabs[i].name===name?tabs[i].active=!0:tabs[i].active=!1;return tabs},openPlanTypeTab=function(){$rootScope.$off(APP.TABS_MODULE.EVENTS._READY),$rootScope.$on(APP.TABS_MODULE.EVENTS._READY,function(){var tabs=listTabs(APP.TABS.USER_OPTIONS,"upgrade");$rootScope.$emit(APP.TABS_MODULE.EVENTS._UPDATE,{tabs:tabs})}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Plan Management")),module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""})},_workspaceUpgrade=function(m){openPlanTypeTab(),$rootScope.selectExternalWorkgroup(!0)},privateMethods=function(currentPlan){};privateMethods.prototype.isPersonal=function(){$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Start your free trial")),module:APP.TEMPLATES.MODAL.UPGRADE_TRIAL,actions:APP.ACTIONS.UPGRADE_PLAN,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:{scope:scope,plan:""===_actualPlan||"personal"===_actualPlan?"personal":_actualPlan,label:{actualPlan:gettextCatalog.getString(gettext("your current plan"))}},layout:"modal-default",footerVisibility:!1})},privateMethods.prototype.isWorkGroup=function(){openPlanTypeTab()};var _routerMethod={trial:_workspaceTrial,upgrade:_workspaceUpgrade,unsupported:function(){}},_url=$state.$current.url.prefix;_url.toString().indexOf(APP.WORKSPACE_MODULE.ROUTE_EXTERNAL_URL.CONSTANTS.WORKSPACE_TRIAL)>-1&&_routerMethod.trial(new privateMethods(_actualPlan))},__self.workspaceHandler=function(){$rootScope.$off(APP.WORKSPACE_MODULE.EVENTS._READY),$rootScope.$off(APP.WORKSPACE_MODULE.EVENTS._NEXTPAGE),$rootScope.$on(APP.WORKSPACE_MODULE.EVENTS._READY,__self.workspaceModuleIsReady),$rootScope.$on(APP.WORKSPACE_MODULE.EVENTS._NEXTPAGE,__self.getNextPage),$rootScope.$on(APP.WORKSPACE_MODULE.EVENTS._SELECTED,__self.workspaceIsSelected),$rootScope.$on(APP.WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._READY,__self.workspaceModuleEditIsReady),$rootScope.$on(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._READY,__self.workspaceModuleShareIsReady),$rootScope.$on(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._LIST,__self.workspaceModuleShareList),$rootScope.$on(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._SAVE,__self.workspaceModuleShareInvite),$rootScope.$on(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._ACCEPT,__self.workspaceModuleShareAccept),$rootScope.$on(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._MEMBER_ACCESS,__self.setMemberAccess),$rootScope.$on(APP.WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._READY,__self.workspaceModuleNewIsReady),$rootScope.$on(APP.WORKSPACE_MODULE.EVENTS._EXTERNALURI,__self.routeExternalURIS)},new __self.workspaceHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerTabs",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.tabsChanged=function(event,data){$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,{name:data.title,module:APP.TABS_MODULE.TEMPLATES.BASE,modal:!0,side:"left",shapeTitle:""})},__self.tabsHandler=function(){$rootScope.$on(APP.TABS_MODULE.EVENTS._CHANGE,__self.tabsChanged)},new __self.tabsHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerUpgrade",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(){var __self=this;return __self.upgradeIsReady=function(){applicationServices.$getCollaborators({},function(data){var collaborators=data;applicationServices.$getSubscriptionInfo({},function(data){data.collaborators=collaborators,$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._GET_SUBSCRIPTION,data)})})},__self.downgradePlan=function(){$data.$userProfile({subscription:{subscriptionType:"personal"}}),$rootScope.$emit(APP.EVENTS._CHANGE_PLAN),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Downgrading Plan to Personal"))}),applicationServices.$getCollaborators({},function(data){var dataContent=data.content,collaborators=dataContent.length;0!==collaborators&&"undefined"!==collaborators&&collaborators?($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._ERROR,gettextCatalog.getString(gettext("In order to downgrade please remove your collaborators from your models")))):applicationServices.$downgradePlan(null,function(){$data.$userProfile({subscription:{subscriptionType:"personal"}}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,gettextCatalog.getString(gettext("Now you are in Personal plan")),null,4e3),$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._DOWNGRADED)},function(response){response&&409===response.status&&($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._ERROR,gettextCatalog.getString(gettext("In order to downgrade please remove your collaborators from your models"))))})})},__self.upgradeTrial=function(event,data,firstTime){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Activating Trial Plan"))}),applicationServices.$activeTrial({},function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$data.$userProfile({subscription:{subscriptionType:"trial"}}),$rootScope.$emit(APP.EVENTS._CHANGE_PLAN,{days:30}),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettext(""),module:APP.TEMPLATES.MODAL.WELCOME_TRIAL,closeButton:{name:gettext("Skip"),visibility:!0},layout:"modal-medium",data:$data.$subscription(),footerVisibility:!1}),$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._UPDATE_LICENSES,data,firstTime)},function(response){response&&409===response.status&&($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._ERROR,gettextCatalog.getString(gettext("In order to remove licenses from your subscription you need to release them by removing collaborators from your models"))))})},__self.validateAndUpdatePlan=function(event,data){data.typePlan&&"full"===data.typePlan&&"trial"==$data.$subscription().subscriptionType&&applicationServices.$validateAmountLicenses(data.dataLincences,function(valid){"true"==valid.toLowerCase()?$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._BILLING_FORM,data.dataForm):applicationServices.$getSubscriptionInfo({},function(data){var editors=_.where(data.licenses,{licenseType:"Editor"}),contributors=_.where(data.licenses,{licenseType:"Contributor"}),countEditors=0,countContributors=0;_.each(editors,function(val){val.hasOwnProperty("userId")&&countEditors++}),_.each(contributors,function(val){val.hasOwnProperty("userId")&&countContributors++}),$rootScope.$emit(APP.ALERT_MODULE.EVENTS._ERROR,gettextCatalog.getString(gettext("You cannot purchase less licenses than the ones you are using in your shared models:"))+" ("+countEditors+") "+gettextCatalog.getString(gettext("Editors and"))+" ("+countContributors+") "+gettextCatalog.getString(gettext("Contributors. Please adjust.")))})}),data.typePlan&&"full"===data.typePlan&&"trial"!=$data.$subscription().subscriptionType&&$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._BILLING_FORM,data.dataForm),$data.$subscription().subscriptionType===data.typePlan||"trial"!==data.typePlan||data.wasTrial?"trial"===data.typePlan&&$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._UPDATE_LICENSES,data.dataLincences):$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._UPGRADE_TRIAL,data.dataLincences)},__self.updateLicenses=function(event,data,firstTime){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Updating licenses"))}),applicationServices.$updateLicenses(data,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),firstTime||$rootScope.$emit(APP.ALERT_MODULE.EVENTS._NOTIFICATION,gettextCatalog.getString(gettext("Your licenses have been updated"))),$rootScope.$emit(APP.SLIDE_CONTENT_MODULE.EVENTS._CLOSE)},function(error){400==error.status&&"MaxNumberAllowedTrialLicenses"==error.data.message&&$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("During your trial you cannot add more than 100 collaborators. Thus the selected amount of licenses cannot be updated. Please check again or upgrade"))}),400==error.status&&"LicensesNotUpdated"==error.data.message&&$rootScope.$emit(APP.EVENTS._ERROR,{message:gettextCatalog.getString(gettext("License(s) have not been added/removed to your subscription."))}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})},__self.upgradeHandler=function(){$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._READY),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._DOWNGRADE),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._UPDATE_LICENSES),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._UPGRADE_TRIAL),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._VALIDATE_AMOUNT_LICENSES,__self.validateAndUpdatePlan),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._READY,__self.upgradeIsReady),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._DOWNGRADE,__self.downgradePlan),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._UPDATE_LICENSES,__self.updateLicenses),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._UPGRADE_TRIAL,__self.upgradeTrial),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._VALIDATE_AMOUNT_LICENSES,__self.validateAndUpdatePlan)},new __self.upgradeHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerUserMenu",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP){var _self=this;return _self.handler=function(){var __self=this;return __self.userMenuIsReady=function(){applicationServices.$userProfile({},function(profile){profile&&$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._UPDATE,profile)})},__self.userMenuHandler=function(){$rootScope.$off(APP.USER_MENU_MODULE.EVENTS._READY),$rootScope.$on(APP.USER_MENU_MODULE.EVENTS._READY,__self.userMenuIsReady)},new __self.userMenuHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerCollaborators",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){
var _self=this;return _self.handler=function(){var __self=this;return __self.getCollaborators=function(event,data){applicationServices.$getCollaborators({},function(data){$rootScope.$emit(APP.COLLABORATORS_MODULE.EVENTS._UPDATE,{dataSource:data})})},__self.deleteCollaborator=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting User"))}),applicationServices.$memberDelete(data,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),applicationServices.$getCollaborators({},function(data){$rootScope.$emit(APP.COLLABORATORS_MODULE.EVENTS._UPDATE,{dataSource:data})})})},__self.tabsHandler=function(){$rootScope.$off(APP.COLLABORATORS_MODULE.EVENTS._READY),$rootScope.$off(APP.COLLABORATORS_MODULE.EVENTS._DELETE),$rootScope.$on(APP.COLLABORATORS_MODULE.EVENTS._READY,__self.getCollaborators),$rootScope.$on(APP.COLLABORATORS_MODULE.EVENTS._DELETE,__self.deleteCollaborator)},new __self.tabsHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandlerBilling",function($rootScope,$state,$timeout,applicationServices,ServicesObjectFactory,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(){var __self=this;return __self.billingInfo=function(){applicationServices.$getSubscriptionInfo({},function(data){$rootScope.$emit(APP.BILLING_MODULE.EVENTS._UPDATE,data)})},__self.billingForm=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Upgrading Plan"))}),$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),applicationServices.$getCountries({},function(countries){data.countries=countries,applicationServices.$userProfile({},function(me){data.me=me,$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString(gettext("Billing information")),module:APP.BILLING_MODULE.BILLING_FORM.TEMPLATES.BASE,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:data,layout:"modal-default",footerVisibility:!1})})})},__self.initPayment=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Redirecting to Paypal"))}),applicationServices.$initTransaction(data,function(response){response.transactionId&&(window.location.href=response.paymentUrl)},function(response){})},__self.viewPayments=function(){applicationServices.$getInvoices(null,function(data){gettextCatalog.getString(gettext("Invoices & History")),$rootScope.$emit(APP.MODAL_CONTENT_MODULE.EVENTS._UPDATE,{name:gettextCatalog.getString("Invoices & History"),module:APP.BILLING_MODULE.PAYMENTS.TEMPLATES.INVOICES,closeButton:{name:gettextCatalog.getString(gettext("Cancel")),visibility:!0},data:data,layout:"modal-medium",footerVisibility:!0,fromRouting:!0})})},__self.getTransaction=function(event,data){applicationServices.$commitTransaction(data,function(transactionInfo){$data.$userProfile({subscription:{subscriptionType:"full"}}),$rootScope.$emit(APP.UPGRADE_MODULE.EVENTS._UPGRADE),$rootScope.$emit(APP.BILLING_MODULE.PAYMENTS.EVENTS._UPDATE_COMMIT,transactionInfo),$rootScope.$emit(APP.BILLING_MODULE.EVENTS._UPDATE,data),applicationServices.$userProfile(null,function(profile){profile.subscription.subscriptionType="full",$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._UPDATE,profile)})},function(response){500===response.status&&($rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),setTimeout(function(){var url=window.location.protocol+"//"+window.location.host+"/index.html#/dashboard/payment/error";window.location.href=url},20))})},__self.cancelTransaction=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading transaction"))}),applicationServices.$cancelTransaction(data,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})},__self.errorTransaction=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},__self.billingHandler=function(){$rootScope.$off(APP.BILLING_MODULE.EVENTS._READY),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._BILLING_FORM),$rootScope.$off(APP.UPGRADE_MODULE.EVENTS._INIT_PAYMENT),$rootScope.$off(APP.BILLING_MODULE.EVENTS._READY_PAYMENTS),$rootScope.$off(APP.BILLING_MODULE.PAYMENTS.EVENTS._GET_TRANSACTION),$rootScope.$off(APP.BILLING_MODULE.PAYMENTS.EVENTS._CANCEL_TRANSACTION),$rootScope.$off(APP.BILLING_MODULE.PAYMENTS.EVENTS._ERROR_TRANSACTION),$rootScope.$on(APP.BILLING_MODULE.EVENTS._READY,__self.billingInfo),$rootScope.$on(APP.UPGRADE_MODULE.EVENTS._BILLING_FORM,__self.billingForm),$rootScope.$on(APP.BILLING_MODULE.EVENTS._INIT_PAYMENT,__self.initPayment),$rootScope.$on(APP.BILLING_MODULE.EVENTS._READY_PAYMENTS,__self.viewPayments),$rootScope.$on(APP.BILLING_MODULE.PAYMENTS.EVENTS._GET_TRANSACTION,__self.getTransaction),$rootScope.$on(APP.BILLING_MODULE.PAYMENTS.EVENTS._CANCEL_TRANSACTION,__self.cancelTransaction),$rootScope.$on(APP.BILLING_MODULE.PAYMENTS.EVENTS._ERROR_TRANSACTION,__self.errorTransaction)},new __self.billingHandler},{handler:this.handler}}),angular.module("_CloudModule").service("_CloudModuleHandleInvitations",function($rootScope,$state,applicationServices,$data,APP,gettextCatalog){var _self=this;return _self.handler=function(scope){var __self=this;return __self.invitationsModuleIsReady=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Loading Invitations"))}),applicationServices.$getInvitationsPending(data,function(result){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._UPDATE,result)})},__self.deleteInvitation=function(event,data){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettextCatalog.getString(gettext("Deleting Invitation"))}),applicationServices.$deleteInvitation(data,function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE),$rootScope.$emit(APP.INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._READY,data)},function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)})},__self._invitationsHandler=function(){$rootScope.$on(APP.INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._READY,__self.invitationsModuleIsReady),$rootScope.$on(APP.INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._DELETE,__self.deleteInvitation)},new __self._invitationsHandler},{handler:this.handler}}),angular.module("_CloudModule").controller("_CloudModule.Controller",function($scope,$rootScope,$state,$base64,$http,$timeout,$data,$element,_CloudModuleHandlerApplication,applicationServices,APP,$location,gettextCatalog,COMMENTS_MODULE){APP.DEBUG.MODELER&&!APP.DEBUG.WEB,$data.$fromModeler()&&angular.element("html").addClass("isFromModeler"),$data.$fromModeler()&&$location.search().lang?($scope.lg=$location.search().lang,gettextCatalog.setCurrentLanguage($location.search().lang)):($scope.lg=$data.$getLanguage(),gettextCatalog.setCurrentLanguage($data.$getLanguage())),$data.changeMomentLocale($scope.lg),$scope.setDefaults=function(){$scope.windowTitle="",$data.$fromModeler()&&$scope.getCredentialsFromModeler(),APP.APPLICATION_MODULE.API.PATH.root=$data.$getBasePath(),applicationServices.$configDiscoveryServices({},function(dataDiscovery){var logged=$data.$login();if((logged||APP.DEBUG.WEB)&&logged.hasOwnProperty("access_token")){angular.extend(APP.APPLICATION_MODULE.API.PATH,dataDiscovery),$scope.footer=APP.TEMPLATES.FOOTER,$scope.logo=APP.RESOURCES.IMAGES.LOGO,$scope.commentsManager={},$scope.fromModeler=$data.$fromModeler();var urlHost=window.location.protocol+"//"+window.location.host;if(docCookies.hasItem("nba_temp")){var login=$data.$login();return docCookies.removeItem("nba_temp"),docCookies.removeItem("lg"),$data.$login({}),void(window.location=APP.APPLICATION_MODULE.API.PATH.membershipService+"core/connect/endsession?id_token_hint="+login.id_token+"&post_logout_redirect_uri="+urlHost)}if(APP.SIGNAL_R_MODULE.CONNECTIONS._HUB=APP.APPLICATION_MODULE.API.PATH.notificationService+APP.SIGNAL_R_MODULE.CONNECTIONS._HUB,$http.get(APP.RESOURCES.SVG.ICONS).then(function(res){$element.prepend(res.data)}),APP.DEBUG.WEB){var mockResponse=applicationServices.mock("login");mockResponse.then(function(data){$data.$login(data),$scope.successLogin(data)},function(){})}else $http.post(urlHost+"/collaboration/api/profile",{},{headers:{Authorization:"Bearer "+logged.access_token}}).success(function(){$scope.successLogin(logged)}).error(function(e){$rootScope.$emit(APP.EVENTS._LOGOUT)})}else $data.$fromModeler()?window.location="/oauth.html?isModeler=true":($data.$savePath(location.href),window.location="/oauth.html?isModeler=false")},function(){$state.go("Cloud.error")})},$scope.successLogin=function(data){$data.setAuthentication(!0),$data.$login(data),$rootScope.$emit(APP.DASHBOARD_MODULE.EVENTS._READY)},$scope.languages={current:$data.$getLanguage(),available:{es:"Espaol",en:"English"}},$scope.switchLenguage=function(data){gettextCatalog.setCurrentLanguage(data),$data.$saveNewLanguage(data),$data.changeMomentLocale(data),$rootScope.$emit(COMMENTS_MODULE.EVENTS._SET_DEFAULT),$rootScope.$emit(COMMENTS_MODULE.EVENTS._READY)},$scope.getCredentialsFromModeler=function(){var objLogin,credentials;credentials=$data.$callWindowExternal(APP.MODELER.EXTERNAL.CREDENTIALS),objLogin=""===credentials?{}:JSON.parse(credentials),objLogin.hasOwnProperty("access_token")?$data.$login(objLogin):$rootScope.$emit(APP.EVENTS._ERROR,{message:"The access token is not available from modeler, check the response."})},$scope.showLoading=function(message){var messageLoading=message||"";$rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:messageLoading})},$scope.hideLoading=function(){$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},$scope.showSlideContent=function(data){$rootScope.$emit(CONFIG.SLIDE_CONTENT_MODULE.EVENTS._UPDATE,data)},$scope.dashboardHandlers=function(){},$scope.IsFromModeler=function(){return $data.$fromModeler()},$scope.closeModelerModal=function(){$data.$fromModeler()&&$data.$callWindowExternal(APP.MODELER.EXTERNAL.MODAL_CANCEL)},_CloudModuleHandlerApplication.applicationHandlers($scope),$scope.diagramsModuleIsReady=function(){},$scope.changeWindowTitle=function(event,data){$scope.windowTitle=data.title},$scope.definitionStringTranslations=function(){$data.$translate("Invalid user or password combination")},$scope.diagramsModuleHandlers=function(){$rootScope.$on(APP.DIAGRAMS_MODULE.EVENTS._READY,$scope.diagramsModuleIsReady)},$rootScope.$on(APP.EVENTS._WINDOW_TITLE,$scope.changeWindowTitle),$rootScope.$on(void 0,function(){}),$scope.hideLoading(),$scope.dashboardHandlers(),$scope.diagramsModuleHandlers(),$scope.setDefaults()}),angular.module("_CloudModule").controller("ModelerLoginController",function($scope,$rootScope,$state,$data,$element,APP,$location,gettextCatalog){$scope.closeModelerWindow=APP.TEMPLATES.MODELER.CLOSE_WINDOW}).controller("ModelerInController",function($scope,$rootScope,$state,$data,APP,$location,gettextCatalog){if($scope.state=$state,$scope.closeModelerWindow=APP.TEMPLATES.MODELER.CLOSE_WINDOW,$scope.windowTitle="",$data.$fromModeler()&&$data.$login()){var loginDataStr=JSON.stringify($data.$login());$data.$callWindowExternal(APP.MODELER.EXTERNAL.LOGIN,loginDataStr)}}),angular.module("gettext").run(["gettextCatalog",function(gettextCatalog){gettextCatalog.setStrings("es",{"(Monthly)":"Mensuales","(No card required)":"(No requiere tarjeta)","(Trial expires on:":"(Prueba gratuita expira en:",'<a href="http://www.bizagi.com/en/cloud-bpm-collaboration-services-pricing" target="_blank">Click here</a> for more information on this plan':'<a href="http://www.bizagi.com/es/precios-servicios-de-colaboracion-bpm-en-la-nube" target="_blank">Haga clic aqu</a> para ms informacin del plan','<i class="fa fa-check-circle-o fa-lg"></i> Collaborate on your models':'<i class="fa fa-check-circle-o fa-lg"></i> Colaborar en sus modelos','<i class="fa fa-check-circle-o fa-lg"></i> Collaborating with teammates':'<i class="fa fa-check-circle-o fa-lg"></i> Colaborar con su equipo de trabajo','<i class="fa fa-check-circle-o fa-lg"></i> Edit, analyze and comment on your process models':'<i class="fa fa-check-circle-o fa-lg"></i>  Editar, analizar y comentar en sus procesos','<i class="fa fa-check-circle-o fa-lg"></i> Edit, analyze and comment on your processes':' <i class="fa fa-check-circle-o fa-lg"></i> Editar, analizar y comentar en sus procesos','<i class="fa fa-check-circle-o fa-lg"></i> More storage... and much more!':'<i class="fa fa-check-circle-o fa-lg"></i> Mas almacenamiento... y mucho mas!','<i class="fa fa-check-circle-o fa-lg"></i> No credit card required':'<i class="fa fa-check-circle-o fa-lg"></i> No requiere tarjeta de credito','<i class="fa fa-check-circle-o fa-lg"></i> Share your process models with your teammates':'<i class="fa fa-check-circle-o fa-lg"></i>  Compartir sus modelos de procesos con su grupo de trabajo','<i class="fa fa-check-circle-o fa-lg"></i> Sharing your models with anyone':'<i class="fa fa-check-circle-o fa-lg"></i> Compartir sus modelos con cualquiera','<span class="ng-scope">You can:</span>':'<span class="ng-scope">Usted puede:</span>',"$USD 10 /per contributor per month":"$USD 10 /por colaborador al mes","$USD 50 /per editor per month":"$USD 50 /por editor al mes","100 MB per Editor":"100 MB por editor","a Comment":"un Comentario","a Custom Artifact Type":"un Tipo de Artefacto Personalizado","a Diagram in the model":"un Diagrama en el modelo","Accepting invitation to model":"Aceptando la invitacin al modelo",Access:"Acceso","Activating Trial":"Activando prueba gratuita","Activating Trial Plan":"Activando Prueba Gratuita",activities:"Actividades","Add collaborators":"Agregar colaboradores","Add Email":"Agregar correo","Add new comment":"Agregar comentario","Add user":"Agregar usuario","Add User":"Agregar usuario","Adding people to model":"Aadiendo personas al modelo",Address:"Direcccin","Address 2":"Direccin 2","All password fields are required.":"Todos los campos contrasea son requeridos","An error has occurred while the transaction was being processed":"Ha ocurrido un error mientras se procesaba su transaccin","an Extended Attribute":"un Atributo Extendido",and:"y","and have full access to Bizagi Cloud Services.":"y tiene acceso total a los servicios de colaboracin en Bizagi Cloud.","Are you sure you want to delete this model? This action cannot be undone.":"Est seguro que desea borrar este modelo? Esta accin no se puede deshacer.",artifact:"Artefacto",artifacts:"Artefactos",association:"Asociacin",Attachment:"Adjunto",Author:"Autor","Balance Due":"Balance","Billing information":"Informacin de facturacin","Bizagi Cloud":"Bizagi","Bizagi Workgroup Plan":"Plan de Grupo de Trabajo",Buy:"Comprar",'By placing this order you acknowledge to have read and accept our "Terms of sale" and "Return policy".':"Al realizar esta compra usted reconoce haber ledo y aceptado nuestros 'Trminos de ventas' y 'Poltica de reembolso'. ",'By starting the trial, you agree to our <a href="http://www.bizagi.com/en/cloud-services-terms-and-conditions" target="_blank">terms and conditions.</a>':'Para comenzar la  prueba gratuita, esta de acuerdo con nuestros <a href="http://www.bizagi.com/en/cloud-services-terms-and-conditions" target="_blank">trminos y condiciones.</a>',Cancel:"Cancelar","Cancel Account":"Cancelar cuenta","Change Password":"Cambiar contrasea","Change Your Plan":"Cambie Su Plan","Change Your Plan to continue using our collaboration options.":"Cambie Su Plan y contine usando nuestras opciones de colaboracin","characters left":"caracteres restantes","Check the password match.":"Revise que las contraseas coincidan",City:"Ciudad","click here":"clic aqu","Click here":"Clic aqu","Click on the <strong>SHARE</strong> button to share your process models with your teammates":"Hga clic en el botn de <strong>COMPARTIR </strong>para compartir sus modelos de proceso con su equipo de trabajo.",Close:"Cerrar","Close Panel":"Cerrar Panel","Cloud Attachments":"Adjuntos en la nube",Collaborators:"Colaboradores",Comments:"Comentarios","Comments on":"Comentarios en","Company Information":"Informacin de la Compaa","Company Name":"Nombre de la Compaa","Compare plans":"Compare nuestros planes","Confirm New Password":"Confirme la nueva contrasea",Contributor:"Colaborador","Contributor (view and comment)":"Colaborador (ver y comentar)",Contributors:"Colaboradores","Contributors. Please adjust.":" Contribuidores. Por favor ajuste.","Copy to download local file":"Copiar para descargar archivo localmente",Country:"Pas","Creating Model":"Creando modelo","Creating New Team":"Creando nuevo equipo","Current password":"Contrasea Actual",Date:"Fecha","days remaining. It expires on":"das restantes. Expira en ",Delete:"Eliminar","Delete Model":"Eliminar modelo","Deleting Comment":"Eliminando Comentario","Deleting File":"Eliminando Archivo","Deleting Invitation":"Eliminando invitacin","Deleting Model":"Eliminando Modelo","Deleting User":"Eliminando Usuario",Description:"Descripcin",Designer:"Diseador",Diagram:"Diagrama","Display Name":"Nombre para mostrar","Don't show again":"No volver a mostrar",Downgrade:"Regresar a Personal","Downgrading Plan to Personal":"Cambiando Plan a Personal","Download Bizagi Modeler":"Descargar Bizagi Modeler","Download file":"Descargar archivo","During the trial you can:":"Durante la prueba gratuita usted puede:","During your trial you cannot add more than 100 collaborators. Thus the selected amount of licenses cannot be updated. Please check again or upgrade":"Durante su prueba no es posible adicionar ms de 100 usuarios. Por ello la cantidad seleccionada de licencias no puede ser actualizada. Por favor rectifique o cambie a un plan superior","Edit in Bizagi Modeler":"Editar en Bizagi Modeler","Edit Model Properties":"Editar propiedades del modelo","Edit payment Info":"Editar informacin de pago","Edit profile":"Editar mi Perfil","Edit, analyze and comment on your processes":"Editar, analizar y comentar sus procesos",Editor:"Editor","Editor (full access)":"Editor (acceso completo)",Editors:"Editores","Editors and":"Editores y",Email:"Correo","Email Address":"Direccin de correo electrnico","Email is Required":"Correo electrnico es requerido",events:"Eventos","Expand attributes to see the table":"Expanda los atributos para ver la tabla","Extended Attributes":"Atributos extendidos","Extended attributes are not found":"No se encontraron atributos extendidos","Extended Attributes for":"Atributos extendidos para","File name has invalid characters":"El nombre del archivo contiene caracteres no vlidos.",First:"Primera","First Name":"Nombres","for more information on this plan":"para ms informacin sobre este plan",gateways:"Compuertas","Getting Workspace Information":"Obteniendo informacin del modelo","Great news! Your trial activation was successful.":"Felicidades! Su periodo de prueba ha sido activado","Grid View":"Vista Cuadrcula","has added":"ha agregado","has expired!":"ha terminado!","has locked for edition":"ha bloqueado para edicin","has modified":"ha modificado","has occurred an error while the transaction was being processed":"Ha ocurrido un error mientras se procesaba la transaccin","has released":"ha liberado ","has removed":"ha eliminado",Help:"Ayuda",here:"aqu","If you are in the European Union, a tax will be charged according to your country. You will be exempt from this tax by filling the VAT registration number of your company":"Si usted est en la Unin Europea, se cobrar impuesto de acuerdo al pas donde se encuentre. Estar exento de dicho impuesto diligenciando el nmero de VAT registrado de su empresa.","If you would like to upgrade to the Bizagi Workgroup Plan,":"Si desea subir de categora al plan de Equipo de Trabajo de Bizagi,","In order to downgrade please remove your collaborators from your models":"Para regresar al plan personal elimine los colaboradores de sus modelos","In order to remove licenses from your subscription you need to release them by removing collaborators from your models":"Para remover las licencias de su suscripcin primero necesita eliminar los colaboradores de sus modelos.","in the model":"en el modelo","Invitation not found":"No se encuentra la invitacin","Invitations not available for the following emails:":"Invitaciones no disponibles para los siguientes correos electrnicos:","Invitations sent successfully":"Invitacin enviada satisfactoriamente",Invite:"Invitar","Invite collaborators":"Invitar colaboradores","Invite People to Model":"Invitar personas al modelo","Invoice #":"Factura #","Invoices & History":"Facturas e historial","is empty.":"est vaco.",Last:"ltima","Last Name":"Apellido","Launch Bizagi Modeler":"Abrir Bizagi Modeler","Launching Process Modeler Application":"Abriendo aplicacin modelador de procesos","License(s) has not been added to your subscription.":"Licencia (s) no se ha agregado a su suscripcin.","License(s) have not been added/removed to your subscription.":"Licencia(s) no se han aadido/eliminado a su suscripcin.","Licensed Users:":"Licencias:",Licenses:"Licencias","Licenses not available for the following email invitations:":"Licencias no disponibles para los siguientes correos invitados:","Link file":"Archivo de enlace","Linking File":"Linkeando archivo","List View":"Vista Lista","Loading Diagrams":"Cargando diagramas","Loading file information....":"Cargando informacin del archivo...","Loading Invitations":"Cargando Invitaciones","Loading List of Files":"Cargando lista de archivos","Loading Members":"Cargando miembros","Loading model":"Cargando Modelo","Loading Model Activity":"Cargando actividad del modelo","Loading Models":"Cargando modelos","Loading Process:":"Cargando proceso: ","Loading Team":"Cargando equipo","Loading transaction":"Cargando transaccin","Loading User Profile":"Cargando perfil de usuario","Loading...":"Cargando...","Locked by":"Bloqueado por ",message:"mensaje",messageflow:"Flujo de Mensajes","Model Activity":"Actividad del Modelo","Model description":"Descripcin del modelo","Model name":"Nombre del modelo","Model Offline":"Modelar Offline","Model Users":"Usuarios en el modelo",Models:"Modelos","Models owned:":"Modelos:",Modified:"Modificado","Modified by":"Modificado por",Monthly:"Mensual",Name:"Nombre","Need more storage?":"Necesita ms espacio de almacenamiento?","New Cloud Model":"Nuevo Modelo en la Nube","New Password":"Nueva contrasea",Next:"Siguiente","No invoices available":"No hay facturas disponibles","No notifications available":"No hay notificaciones","No properties available":"No hay propiedades disponibles","Not found file information":"No se encontr informacin de archivos","Now you are in Personal plan":"Ahora estas en Plan Personal",of:"de",Ok:"Ok",on:"en","Open Model":"Abrir Modelo",Owner:"Dueo",pages:"pginas","Payment term and Pricing":"Trminos de Pago y Precios","Pending Invitations":"Invitaciones pendientes",Personal:"Personal","Personal\r\n            Plan":"Plan\r\n            Personal","Personal Information":"Informacin Personal","Personal message (optional)":"Mensaje personal (opcional)",Phone:"Telfono",plan:"plan","Plan and Billing":"Plan y Facturacin","Plan and Billing Info":"Informacin de Facturacin y Plan","Plan Management":"Administrar Plan","Plan rate:":"Tarifa del plan:",'Plan type <a href="#" target="_blank" class="pull-right"><small translate="">Compare plans</small></a>':'Plan <a href="#" target="_blank" class="pull-right"><small translate="">Compare nuestros planes</small></a>',"Plan:":"Plan","Please enter a valid number":"Por favor ingrese un nmero vlido","Please enter the workspace name":"Por favor, ingrese el nombre del modelo","Please enter your address":"Por favor, ingrese su direccin","Please enter your city":"Por favor ingrese su ciudad","Please enter your company":"Por favor ingrese su compaa","Please enter your country":"Por favor, ingrese su pas","Please enter your first name":"Por favor ingrese su primer nombre","Please enter your last name":"Por favor ingrese su apellido","Please enter your phone":"Por favor ingrese su telfono","Please remember that you must have Bizagi Modeler installed in order to edit your models. You can download it":"Recuerde que debe tener instalado Bizagi Modeler en su ordenador para editar sus modelos. Lo puede descargar","Please upgrade to our Workgroup Plan to continue enjoying the benefits of the trial.":"Por favor cambie su plan a Grupo de Trabajo para seguir disfrutando de los beneficios de la prueba gratuita.","Please upgrade to the Workgroup Plan to continue enjoying the benefits our services.":"Por favor suba de categora al plan Grupo de Trabajo para seguir disfrutando de los beneficios de nuestros servicios.",Previous:"Anterior","Pricing and features":"Precios y Caracteristicas","Process Viewer":"Visor de Procesos",processpool:"Contenedor de Procesos",Properties:"Propiedades",Purchase:"Comprar","Purchase now":"Comprar Ahora","Recent Events":"Eventos Recientes","Redirecting to Paypal":"Redireccionando a Paypal","Remove file":"Remover archivo","Remove invitation":"Eliminar invitacin","Remove user":"Eliminar usuario","Rename file":"Renombrar archivo","Renaming File to:":"Editando nombre del archivo",Rendering:"Renderizando",Reply:"Responder","Reply to comment":"Responder","Reset zoom":"Restablecer zoom",Revoke:"Revocar","Revoke user privileges from Models.":"Revocar los privilegios de usuario de los modelos.",Role:"Rol",Save:"Guardar","Save Model":"Guardar Modelo","Search attributes...":"Bsqueda de atributos...","Search by User":"Buscar por usuario","Search Files":"Buscar archivos","Search invoice":"Buscar factura","Searching Workspaces":"Buscando modelos","Select...":"Seleccione...","Sending comment":"Enviando comentario","Sending invitations to model":"Enviando invitaciones al modelo","Sending Invites":"Enviando invitaciones",sequenceflow:"Flujo de Secuencia","Share Model":"Compartir Modelo","Share your process models with your teammates":"Compartir sus modelos con su grupo de trabajo.","Show Comments":"Ver comentarios","Show Model Activity":"Ver actividad del modelo","Sign Out":"Desconectarse",Size:"Tamao",Skip:"Saltar",Start:"Comenzar","Start free trial!":"Inicie su prueba gratuita","Start Trial":"Inicie prueba gratuita","Start your free trial":"Inicie su prueba gratuita","Step 1":"Paso 1","Step 2":"Paso 2",Support:"Soporte","Tax id":"Identificador de impuestos","Team Users":"Usuarios en el equipo","the Comment Categories":"las Categoras de Comentario","the Extended Attributes Order":"el orden de los Atributos Extendidos","The file that you are trying to upload is not valid":"El archivo que est intentando cargar no es vlido","The file type is not allowed":"El tipo de archivo no es permitido","The following emails already have a pending invitation:":"Los siguientes correos electrnicos ya tienen una invitacin pendiente:","The following emails are already part of the model:":"Los siguientes mensajes de correo electrnico que ya son parte del modelo","The invitation to the model has already been used":"La invitacin al modelo ya est siendo usada","The invitation was for":"La invitacin fue enviada a ","The length of comment is too short. You must be write a least 2 characters":"La longitud del comentario es demasiado corta. Se debe escribir un mnimo de 2 caracteres","the Model Properties":"las Propiedades del Modelo","The operation was completed successfully":"Operacin completada satisfactoriamente","The owner of the model has no licenses available":"El dueo del modelo no tiene licencias disponibles","The password fields requires at least 7 characters":"Los campos de tipo contrasea requieren al menos 7 caracteres","The password must have at least one number and one  uppercase character":"Las contraseas deben tener al menos un numero y un carcter en maysculas","The transaction has been canceled":"La transaccin ha sido cancelada","The transaction has been confirmed!":"La transaccin ha sido confirmada ","The user is already part of the model":"El usuario ya hace parte del modelo","There are not available licenses":"No hay licencias disponibles","There is already a model with this name.":"Ya existe un modelo con este nombre.","This link has expired":"El link ha expirado","This upload exceeds your quota":"Este archivo excede su cuota",'To add licenses please go to <a href="" ng-click="execute($event, {page:\'USER_MENU_MODULE.SHOW.UPGRADE\'})" class="btn btn-primary btn-sm">Upgrade</a>':'Para agregar licencias ir a <a href="" ng-click="execute($event, {page:\'USER_MENU_MODULE.SHOW.UPGRADE\'})" class="btn btn-primary btn-sm">Cambiar plan</a>',"Total files":"Total de archivos","Total storage:":"Almacenamiento total:","Trial\r\n            Plan":"Prueba\n            Gratuita","Unlimited Models":"Modelos ilimitados","Unlocking Diagram":"Desbloqueando diagrama","Update Licenses":"Actualizar Licencias ","Update Profile":"Actualizar perfil","Updating licenses":"Actualizando licencias","Updating Member Access":"Actualizando acceso a miembro","Updating Model":"Actualizando modelo","Updating Profile":"Actualizando perfil","Updating User Role":"Actualizando rol de usuario","Upgrade Plan":"Cambiar a un plan superior","Upgrade to Workgroup Plan and enable:":"Actualcese al Plan Grupo de Trabajo y podr:","Upgrade your plan":"Cambiar a un plan superior","Upgrade your Plan":"Cambiar a un Plan superior","Upgrading Plan":"Cambiar a un Plan superior",Upload:"Subir","User Options":"Opciones",Version:"Versin","View Invoices and history":"Ver historial de facturas",Viewer:"Visor",Workgroup:"Grupo de Trabajo","Workgroup\r\n            Plan":"Plan Grupo de\nTrabajo","Workgroup (Trial)":"Grupo de Trabajo (Prueba Gratuita)","Workgroup Plan":"Plan Grupo de Trabajo","You are about to leave to make your payment directly at PayPal's website, the safest and easiest way to pay online.":"Usted est a punto de salir para hacer su pago directamente en el portal de PayPal, La forma ms segura y sencilla de pagar en lnea",'You are currently on Bizagi Cloud Services free trial. It expires on {{data.subscriptionInfo.endDate | date:"yyyy/MM/dd"}}':'Usted est en la versin de  prueba gratuita de Bizagi Cloud. Expira en {{data.subscriptionInfo.endDate | date:"yyyy/MM/dd"}}',"You are currently on the":"Usted est actualmente en el",'You are currently on the <strong class="bz-cd-plan-name">Free Trial  </strong> and have':'Usted est en <strong class="bz-cd-plan-name">Prueba gratuita </strong> y tiene','You are currently on the <strong class="bz-cd-plan-name">Free Trial .</strong> It expires on <strong class="bz-cd-plan-days">{{endDate | date:\'yyyy/MM/dd\'}}</strong>':'Usted est en <strong class="bz-cd-plan-name">Prueba gratuita.</strong> Expira en  <strong class="bz-cd-plan-days">{{endDate | date:\'yyyy/MM/dd\'}}</strong>','You are currently on the <strong class="bz-cd-plan-name">Free Trial </strong> this is your <strong class="bz-cd-plan-days">last day.</strong>':'Usted est en <strong class="bz-cd-plan-name">Prueba gratuita </strong>este es su <strong class="bz-cd-plan-days">ultimo da.</strong>',"You are currently on the Workgroup plan and have full access to Bizagi Cloud Collaboration Services.":"Usted est actualmente en el plan de Grupo de Trabajo y tiene acceso total a los servicios de colaboracin en la nube de Bizagi.","You are in a":"Usted esta en","You are logged with a different account.":"Usted est logueado con una cuenta diferente.","You are using":"Est usando","You can add process models by using Bizagi Modeler and uploading them using your account.":"Usted puede agregar modelos de procesos usando Bizagi Modeler y subirlos usando su cuenta.","You can:":"Usted Puede","You cannot purchase less licenses than the ones you are using in your shared models:":"Usted no puede comprar menos licencias de las que est usando en sus modelos compartidos:","You have":"Usted tiene","You have {{data.editors}} Editors and {{data.contributors}} Contributors":"Usted tiene {{data.editors}} Editores y {{data.contributors}} Colaboradores",
"You have exceeded the personal plan quota.  In order to continue please delete some of your models or upgrade your plan.":"Usted ha excedido la cuota de su plan personal.  Para poder continuar por favor elimine modelos o cambie su plan a Grupo de Trabajo.","You have exceeded the personal plan quota. In order to continue please delete some of your models or upgrade your plan.":"Ha superado la cuota plan personal. Para continuar, elimine algunos de sus modelos o actualice su plan.","You have no collaborators":"Usted no tiene colaboradores","You now have access to":"Ahora tiene acceso al ","You will be covered by PayPal verified security and once the transaction is completed you will return to a confirmation page.":"Usted estar cubierto por la seguridad verificada de PayPal y una vez la transaccin se complete retornar a una pgina de confirmacin.","You will be restricted to 10MB of storage and your teammates will be unable to access and work on the models that you have shared.":"Est actualmente restringido a 10 MB de almacenamiento y su equipo de trabajo no podr acceder ni trabajar en los modelos compartidos.","You're currently on our Free Personal Plan.":"Usted esta en nuestro Plan Personal Gratuito",Your:"Su","Your account exceeded the quota":"Su cuenta ha sobrepasado la quota permitida","Your Bizagi Cloud Collaboration Services subscription has expired and we have returned your account to the Personal Plan.":"Su suscripcin a los Servicios de Colaboracin de Bizagi Cloud ha expirado y hemos regresado su cuenta al plan Personal.","your current plan":"Su plan actual","Your current plan allows {{totalContributors}} contributors. Adding {{inviteContributors}} account(s) will exceed that limit by {{expireContributors}}":"Su plan actual permite hasta {{totalContributors}} editores.  Agregar {{inviteContributors}} cuenta(s) excedera el limite de licencias disponibles por {{expireContributors}}","Your current plan allows {{totalEditors}} editors. Adding {{inviteEditors}} account(s) will exceed that limit by {{expireEditors}}":"Su plan actual permite hasta {{totalEditors}} editores.  Agregar {{inviteEditors}} cuenta(s) excedera el limite de licencias disponibles por {{expireEditors}}","Your Free Trial":"Su prueba gratuita","Your free trial ends on <span class=\"color-brand\">{{data.endDate | date:'yyyy/MM/dd'}}</span>":"Su periodo de prueba gratuito termina en <span class=\"color-brand\">{{data.endDate | date:'yyyy/MM/dd'}}</span>","Your licenses have been updated":"Su licencia ha sido actualizada","Your next payment is due on":"El siguiente pago tiene fecha lmite de","Your next payment is due on  {{data.nextPay | date:'yyyy/MM/dd'}}":"El siguiente pago tiene fecha lmite de  {{data.nextPay | date:'yyyy/MM/dd'}}","Your trial has been activated with 2 editors and 2 contributors":"Su prueba gratuita fue activada con 2 Editores y 2 Colaboradores"})}]),angular.module("applicationModule",["base64","ngCookies","ngResource","azureBlobUpload"]).run(function($rootScope){$rootScope.$off=function(name){return $rootScope.$$listeners[name]=[],$rootScope},$rootScope.$offAll=function(){return $rootScope.$$listeners={},$rootScope}}),angular.module("applicationModule").config(["$httpProvider",function($httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]),angular.module("applicationModule").constant("APPLICATION_MODULE",{DEBUG:_appConfig.debug.web,CLIENT_NAME:"bW9kZWxlci5iaXphZ2kuY29tOmh0TXFJeHhXcER2QWJ4SEkxQlI0MGlBdm45eWJ4VkhaQWx4SDM2ZkNiS0U2dVJtWmVRenFuOUVwSmtVSTVxMDNiYnNqZHp2c1E1VE9DSzlVZzdRN3laMm5NUg==",ACCESS_TOKEN:"access_token",AUTHORIZATION:"Authorization",EVENTS:{_ERROR:"ERROR",_AUTHENTICATION_REFRESH:"AUTH.REFRESH",_FROM_MODELER:"FROM_MODELER",_LOGOUT:"LOGOUT",_FAIL:"_FAIL",_EXPIRE_SESSION:"_EXPIRE_SESSION",_HIDE:"LOADING_MODULE._HIDE"},SERVICES:{DEBUG:_appConfig.debug.services},API:{PATH:{root:_appConfig.root},CLOUD_LINKS:{_COLLABORATION_SERVICES:"http://www.bizagi.com/en/products/cloud/collaboration-services",_COLLABORATION_SERVICES_ES:"http://www.bizagi.com/es/productos/cloud/servicios-de-colaboracion"},MODELER:{_INFORMATION_ES:"http://help.bizagi.com/processmodeler/es/Cloud_Collaboration.htm",_INFORMATION:"http://help.bizagi.com/processmodeler/en/Cloud_Collaboration.htm",_SUPPORT_ES:"http://feedback.bizagi.com/es/",_SUPPORT:"http://feedback.bizagi.com/en/",_SUPPORT_EMAIL:"support@bizagi.com",_DOWNLOAD:"http://www.bizagi.com/es/bpm-suite-es/productos/modeler#DownMod"},SERVICE:{_PARENT:"root",_DISCOVERY:{url:"services.json",method:"GET",data:{}}},AUTHENTICATION:{_PARENT:"membershipService",_LOGIN:{url:"core/connect/token",method:"POST",contentType:"application/x-www-form-urlencoded"},_REFRESH:{url:"core/connect/token",method:"POST",contentType:"application/x-www-form-urlencoded"}},BILLING:{_PARENT:"collaborationService",_INFO:{url:"api/subscription/billing",method:"GET",data:{}}},PROFILE_COLLABORATION:{_PARENT:"collaborationService",_GET:{url:"api/profile",method:"GET",data:{}},_SUBSCRIPTION_INFO:{url:"api/subscription/billing",method:"GET",data:{}}},PROFILE:{_PARENT:"membershipService",_SHORT:{url:"api/users/me",method:"GET",data:{}},_GET_USER_BY_ID:{url:"api/users/{{userId}}",method:"GET",data:{}},_GET_USERS:{url:"api/users/",method:"GET",data:{}},_SHORT_BY_EMAIL:{url:"api/users/{{email}}/decoded/",method:"GET",data:{}},_FULL:{url:"core/connect/userinfo",method:"GET",data:{}},_UPDATE:{url:"api/users/me",method:"PUT",data:{firstName:"",fullName:"",lastName:"",userName:"",phone:"",country:""}},_NEW:{url:"api/account/manage",method:"POST",data:{}},_REGISTER:{url:"api/users/register/all",method:"POST",data:{email:"",firstName:"",lastName:"",userName:"",password:"",company:"",industry:""}},_CHANGE_PASSWORD:{url:"api/users/changepassword",method:"PUT",data:{oldPassword:null,newPassword:null}},_RESET_PASSWORD:{url:"api/account/resetpassword",method:"PUT",data:{},noContentType:!0},_CONFIRM_RESET_PASSWORD:{url:"api/account/changepassword/{token}/{email}/",method:"PUT",data:{},noContentType:!0}},TEAM:{_PARENT:"teamService",_NEW:{url:"api/teams",method:"POST",data:{name:null}},_LIST:{url:"api/teams",method:"GET",data:{}}},MEMBER:{_PARENT:"collaborationService",_INVITE:{url:"api/teams/members",method:"POST",data:"Array"},_LIST:{url:"api/teams/members",method:"GET",data:{}},_UPDATE_ROLE:{url:"api/teams/members",method:"PUT",data:{email:null,role:null}},_DELETE:{url:"api/teams/members",method:"DELETE",data:{}},_WORKSPACE_INVITE_UNREGISTERED:{url:"api/workspace/{{workspaceId}}/invite",method:"POST",data:{workspaceId:null,grantAccesses:null,inviteNote:"",subscriptionId:null}},_WORKSPACE_DELETE:{url:"api/workspace/{{workspaceId}}/users/{{userId}}",method:"DELETE",data:{}},_ACCEPT:{url:"api/workspace/{{workspaceId}}/invite/{{invitationId}}",method:"POST",data:{}}},SEARCH:{_WORKSPACE_LIST:{url:"api/user/workspaces",method:"GET",data:{}}},NOTIFICATIONS:{_PARENT:"collaborationService",_COUNT:{url:"api/notifications/{{workspaceId}}/count",method:"GET",data:{}},_AS_READ:{url:"api/notifications/markAsRead/{{workspaceId}}",method:"PUT",data:{}},_WORKSPACE:{url:"api/notifications/{{workspaceId}}",method:"GET",data:{}}},PLAN:{_PARENT:"collaborationService",_ACTIVATE_TRIAL:{url:"api/subscriptions/trial",method:"POST",data:{}},_UPGRADE_PLAN:{url:"api/subscriptions/upgrade",method:"POST",data:{}},_DOWNGRADE_PLAN:{url:"api/subscriptions/downgrade",method:"POST",data:{}}},LICENSES:{_PARENT:"collaborationService",_UPDATE:{url:"api/subscriptions/updateTrialLicenses",method:"POST",data:"Array"},_VALIDATE_AMOUNT_LICENSES:{url:"api/subscriptions/licenses/validate",method:"POST",data:"Array"}},QUOTA:{_PARENT:"collaborationService",_GET_APP:{url:"api/quota",method:"GET",data:{}}},USER:{_NEW:{url:"api/users",method:"POST",data:{}}},PAYMENT:{_PARENT:"paymentService",_INIT_TRANSACTION:{url:"api/paypal/initTransaction",method:"POST",data:"Array"},_COMMIT_TRANSACTION:{url:"api/paypal/commitTransaction",method:"PUT",data:{}},_CANCEL_TRANSACTION:{url:"api/paypal/cancelTransaction",method:"DELETE",data:{}},_INVOICES:{url:"api/invoice/invoicesSummary",method:"GET",data:{}},_GET_COUNTRIES:{url:"api/countries",method:"GET",data:{}}},WORKSPACE:{_PARENT:"collaborationService",_NEW:{url:"api/workspaces/",method:"POST",data:{name:null,description:null}},_UPDATE:{url:"api/workspace/{{id:Guid}}",method:"PUT",data:{id:null,name:null,description:null}},_DELETE:{url:"api/workspace/{{id:Guid}}",method:"DELETE",data:""},_SEARCH:{url:"api/user/workspaces",method:"GET",data:""},_INFO:{url:"api/workspace/{{id:Guid}}",method:"GET",data:{}},_LIST:{url:"api/user/workspaces/",method:"GET",data:""},_LIST_MEMBERS:{url:"api/workspace/{{workspaceId}}/users",method:"GET",data:[]},_INVITE_MEMBERS:{url:"api/workspace/{{workspaceId}}/users",method:"POST",data:"Array"},_DELETE_MEMBERS:{url:"api/workspace/{{workspaceId}}/users/{{userId}}",method:"DELETE",data:""},_COMMENTS:"api/workspace/{{workspaceId:Guid}}/comments",_MEMBER_ACCESS:{url:"api/workspace/{{workspaceId:Guid}}/users",method:"PUT",data:{userId:null,email:null,access:null}}},DIAGRAMS:{_PARENT:"modelerService",_UNLOCK:{url:"api/workspace/{workspaceId}/diagram/{diagramId}/unlock",method:"PUT",data:""},_LIST:{url:"api/workspaces/:workspaceId/diagrams",method:"GET",data:""},_COMMENTS:"api/workspace/{{workspaceId:Guid}}/process/{{id:Guid}}/comments"},PROCESS_VIEWER:{_PARENT:"modelerService",_VIEW:{url:"api/workspaces/{{workspaceId}}/diagrams/{{diagramId}}/",method:"GET",data:{}}},FILE_MANAGER:{_PARENT:"collaborationService",_INFO:{url:"api/workspaces/{{id}}/files/{{fileId}}/metadata",method:"GET",data:{}},_LIST:{url:"api/workspaces/{{id}}/files",method:"GET",data:{}},_UPLOAD_START:{url:"api/workspaces/{{id}}/file/upload/start/{{transactionId}}",method:"POST",data:{fileName:null,extension:null,length:null}},_UPLOAD_FILES_START:{url:"api/workspaces/{{id}}/files/upload/{{transactionId}}",method:"POST",data:"Array"},_UPLOAD_CONFIRMATION:{url:"api/workspaces/{{id}}/file/{{fileId}}/confirm/{{transactionId}}",method:"PUT"},_UPLOAD_FILES_CONFIRMATION:{url:"api/workspaces/{{id}}/files/confirm/{{transactionId}}",method:"PUT",data:"Array"},_QUOTA:{url:"api/quota",method:"GET",data:{}},_QUOTA_BY_MODEL:{url:"api/quota/{{modelId}}",method:"GET",data:{}},_DELETE:{url:"api/workspaces/{{id}}/files/{{fileId}}",method:"DELETE",data:{}},_RENAME:{url:"api/workspaces/{{id}}/files/{{fileId}}/rename/",method:"PUT",data:{},contentType:"application/x-www-form-urlencoded"},_DOWNLOAD:{url:"api/workspaces/{{id}}/files/{{fileId}}",method:"GET",data:{}}},COMMENTS:{_PARENT:"collaborationService",_WORKSPACE:{url:"api/workspace/{{workspaceId}}/comments",method:"GET",data:{}},_DIAGRAM:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/comments",method:"GET",data:{}},_DELETE_FROM_WORKSPACE:{url:"api/workspace/{{workspaceId}}/comment/{{commentId}}",method:"DELETE",data:{}},_DELETE_FROM_DIAGRAM:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/comment/{{commentId}}",method:"DELETE",data:{}},_SEND_FROM_WORKSPACE:{url:"api/workspace/{{workspaceId}}/comments",method:"POST",data:{text:"",replyTo:null}},_SEND_FROM_DIAGRAM:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/comments",method:"POST",data:{text:"",replyTo:null}},_SEND_FROM_SHAPE:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/shape/{{shapeId}}/comments/",method:"POST",data:{text:"",replyTo:null}},_ADD_REPLY:{url:"api/workspace/{{workspaceId:Guid}}/comment/{{commentId:Guid}}/reply",method:"POST",data:{text:"",userId:""}},_GET_REPLIES:{url:"api/workspace/{{workspaceId:Guid}}/comment/{{commentId:Guid}}",method:"GET",data:{}},_LIST_SHAPES:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/shapes/comments/",method:"GET",data:{}},_LIST_COMMENTS_BY_SHAPE:{url:"api/workspace/{{workspaceId}}/diagram/{{diagramId}}/shape/{{shapeId}}/comments/",method:"GET",data:{}}},EXTENDED_ATTRIBUTES:{_PARENT:"modelerService",_LIST:{url:"api/workspaces/{{workspaceId}}/shape/{{shapeId}}/documentation",method:"GET",data:""}},PROCESS_EXTENDED_ATTRIBUTES:{_PARENT:"modelerService",_LIST:{url:"api/workspaces/{{workspaceId}}/process/{{processId}}/documentation",method:"GET",data:""}},COLLABORATORS:{_PARENT:"collaborationService",_LIST:{url:"api/subscription/users",method:"GET",data:""}},INVITATIONS:{_PARENT:"collaborationService",_LIST_PENDING:{url:"api/workspace/{{workspaceId}}/invite",method:"GET",data:""},_DELETE:{url:"api/workspace/{{workspaceId}}/invite/{{invitationId}}",method:"DELETE",data:""}},ENDPOINTS:"api/serviceInformation/",deleteComment:"api/workspace/{{workspaceId:Guid}}/comment/{{commentId:Guid}}",newTeam:"api/teams/",uploadFilesWorkspace:"api/workspaces/{{id:Guid}}/files",listFilesWorkspace:"api/workspaces/{{id:Guid}}/files",quota:"api/quota",deleteFilesWorkspace:"api/workspaces/{{id}}/files/{{fileId}}",renameFile:"api/workspaces/{{id}}/files/{{fileId}}/rename/",downloadFile:"/api/workspaces/{{id}}/files/{{fileId}}",getFileManagerPage:"api/workspaces/{{id}}/files",getFileInfo:"api/workspaces/{{id}}/files/{{fileId}}/metadata"},EXCEPTIONS:{COMMON:{0:gettext("There was a communication problem, please try again."),400:gettext("400 Bad Request"),401:gettext("401 Unauthorized"),403:gettext("403 Forbidden"),404:gettext("404 Not Found"),405:gettext("405 Method Not Allowed"),406:gettext("406 Not Acceptable"),407:gettext("407 Proxy Authentication Required"),408:gettext("408 Request Timeout"),409:gettext("409 Conflict"),410:gettext("410 Gone"),498:gettext("498 Token expired/invalid (Esri)"),402:gettext("402 Payment Required")},NEW_WORKSPACE_MODULE:{0:gettext("net::ERR_CONNECTION_REFUSED"),400:gettext("400 Bad Request"),401:gettext("401 Unauthorized"),403:gettext("403 Forbidden"),404:gettext("404 Not Found"),405:gettext("405 Method Not Allowed"),406:gettext("406 Not Acceptable"),407:gettext("407 Proxy Authentication Required"),408:gettext("408 Request Timeout"),409:gettext("Workspace names must be unique"),410:gettext("410 Gone"),498:gettext("498 Token expired/invalid (Esri)")},EDIT_WORKSPACE_MODULE:{0:gettext("net::ERR_CONNECTION_REFUSED"),400:gettext("400 Bad Request"),401:gettext("401 Unauthorized"),403:gettext("403 Forbidden"),404:gettext("404 Not Found"),405:gettext("405 Method Not Allowed"),406:gettext("406 Not Acceptable"),407:gettext("407 Proxy Authentication Required"),408:gettext("408 Request Timeout"),409:gettext("Workspace names must be unique"),410:gettext("410 Gone"),498:gettext("498 Token expired/invalid (Esri)")},WORKSPACE_MODULE:{0:gettext("net::ERR_CONNECTION_REFUSED"),400:gettext("400 Bad Request"),401:gettext("401 Unauthorized"),403:gettext("403 Forbidden"),404:gettext("404 Not Found"),405:gettext("405 Method Not Allowed"),406:gettext("406 Not Acceptable"),407:gettext("407 Proxy Authentication Required"),408:gettext("408 Request Timeout"),409:gettext("409 Conflict"),410:gettext("410 Gone"),498:gettext("498 Token expired/invalid (Esri)")},GET_WORKSPACE_INFO:{402:gettext("Payment Required"),413:gettext("Quota exceeded"),404:gettext("Workspace not found")},FILE_UPLOAD:{412:gettext("Model Quota Exceeded"),404:gettext("404 Not Found File Upload")},_UPLOAD_CONFIRMATION:{404:gettext("404 Not Found File Upload Confirmation")},_UPLOAD_FILES_CONFIRMATION:{404:gettext("404 Not Found File Upload Files Confirmation")},RENAME_FILE:{409:gettext("The name was not changed")},_CONFIRM_RESET_PASSWORD:{400:gettext("This link has expired"),409:gettext("Token expired")},_RESET_PASSWORD:{404:gettext("Email not found")},_ACCEPT:{400:gettext("This link has expired"),409:gettext("The owner of the model has no licenses available")}}}),angular.module("applicationModule").controller("ApplicationController",function(){}),angular.module("applicationModule").service("$data",function($base64,$q,$storage,$state,$rootScope,$location,$window,APPLICATION_MODULE,gettextCatalog){var self=this,translateOptions=function(list){return _.each(list,function(item,i){list[i].name=gettextCatalog.getString(item.name)}),list};self.selectedProcess={},self.token="",self.device=bizagi.detectDevice(),self.user={logged:!1},self.currentLanguage="en_US",self.clearSession=function(){self.$login({}),$storage.$empty()},self.$userProfile=function(userProfile){var userProfileLoad=$storage.$load("up"),tempUserProfile={userName:"",id:"",fullName:"",email:"",role:"",editors:1,contributors:0,userName64:""};if(userProfile){if(userProfile.fullName=(userProfile.firstName||"")+" "+(userProfile.lastName||""),void 0===userProfileLoad||null===userProfileLoad){self.userProfile||(self.userProfile={});for(var prop in tempUserProfile)self.userProfile[prop]=userProfile.hasOwnProperty(prop)?userProfile[prop]:""}else{for(var prop in tempUserProfile)userProfileLoad.hasOwnProperty(prop)&&""!==userProfileLoad[prop]&&(tempUserProfile[prop]=userProfileLoad[prop]),userProfile.hasOwnProperty(prop)&&""!==userProfile[prop]&&(tempUserProfile[prop]=userProfile[prop]);self.userProfile=tempUserProfile}$storage.$save("up",JSON.stringify(self.userProfile))}return self.userProfile||(self.userProfile=$storage.$load("up")),userProfile&&self.userProfile&&(angular.extend(self.userProfile,{subscription:userProfile.subscription}),self.$subscription(self.userProfile.subscription)),self.userProfile},self.$isMobile=function(){return self.isMobile="ontouchstart"in $window,self.isMobile},self.$isIE9Version=function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE 9");return msie>0},self.$subscription=function(subscription){var subscriptionLoad=$storage.$load("sb"),tempSubscription={id:"",ownerId:"",subscriptionType:"",quota:0,startDate:"",endDate:"",wasTrialActivated:"",isDowngraded:""};if(subscription){if(void 0===subscriptionLoad||null===subscriptionLoad){self.subscription||(self.subscription={});for(var prop in tempSubscription)self.subscription[prop]=subscription.hasOwnProperty(prop)?subscription[prop]:""}else{for(var prop in tempSubscription)subscriptionLoad.hasOwnProperty(prop)&&""!==subscriptionLoad[prop]&&(tempSubscription[prop]=subscriptionLoad[prop]),subscription.hasOwnProperty(prop)&&""!==subscription[prop]&&(tempSubscription[prop]=subscription[prop]);self.subscription=tempSubscription}$storage.$save("sb",JSON.stringify(self.subscription))}return self.subscription||(self.subscription=$storage.$load("sb")),self.subscription&&self.subscription.hasOwnProperty("subscriptionType")&&"string"==typeof self.subscription.subscriptionType&&(self.subscription.subscriptionType=self.subscription.subscriptionType.toLowerCase()),self.userProfile&&angular.extend(self.userProfile,{subscription:self.subscription}),self.subscription},self.$updateUserProfileRole=function(role){var profile=angular.copy(self.$userProfile());profile.role=role,self.$userProfile(profile)},self.$login=function(login){return login?(self.login=login,self.token=login.access_token,$storage.$save("lg",login,!0)):self.login||(self.login=$storage.$load("lg")),self.login},self.cloneObject=function(destination,source){for(var property in source)"object"==typeof source[property]?(destination[property]=destination[property]||{},arguments.callee(destination[property],source[property])):destination[property]=source[property];return destination},self.$savePath=function(path){return path?(self.path=path,$storage.$save("pp",path,!0)):self.path||(self.path=$storage.$load("pp")),self.path},self.$removePath=function(){self.path=null,$storage.$remove("pp")},self._extractActionAccess=function(action,workspace){for(var aValueAccess=!1,i=0;i<action.access.length;i++)if(action.access[i].toLowerCase()===workspace.accessType.toLowerCase()){aValueAccess=!0;break}return aValueAccess},self._extractPlanAccess=function(action){for(var aValuePlan=!1,p=0;p<action.plan.length;p++)if(action.plan[p].toLowerCase()===self.$subscription().subscriptionType){aValuePlan=!0;break}return aValuePlan},self.$validateAccessMenu=function(actions){for(var i=0;i<actions.length;i++){var action=actions[i],aValueAccess=!1,aValuePlan=!1,workspace=self.$selectedWorkspace();workspace?action&&workspace.accessType&&(aValueAccess=self._extractActionAccess(action,workspace)):aValueAccess=!0,aValueAccess===!0&&"Comments"===action.title||"Show Comments"===action.name||"Show Model Activity"===action.name?aValuePlan=!0:action.hasOwnProperty("plan")&&self.$subscription()&&(aValuePlan=self._extractPlanAccess(action));var aDevice=self.validateDevices(action.device);action.show=aValueAccess&&aValuePlan&&aDevice}return actions},self.validateDevices=function(devices){var accepted=!0;return accepted=self.isMobile?_.indexOf(devices,"Mobile"):_.indexOf(devices,"Desktop"),-1!==accepted?!0:!1},self.$validateAccess=function(actions){for(var i=0;i<actions.length;i++){var action=actions[i];if(action.show=!1,null!==self.$subscription()){var plan=self.$subscription().subscriptionType;if(action&&plan)for(var e=0;e<action.access.length;e++)if(action.access[e].toLowerCase()===plan.toLowerCase()){action.show=!0;break}}var aDevice=self.validateDevices(action.device);action.show&&(action.show=aDevice)}return actions},self.$configureOptions=function(options,layoutSettings){2==options.length?"GRID"===layoutSettings.models.layout?(options[0].state="enabled",options[1].state="enabled bz-cd-active"):(options[0].state="enabled bz-cd-active",options[1].state="enabled"):6==options.length&&("GRID"===layoutSettings.diagrams.layout?(options[4].state="enabled",options[5].state="enabled bz-cd-active"):(options[4].state="enabled bz-cd-active",options[5].state="enabled"))},self.$checkRouting=function(toState,APP){if("CloudIn.workspaces"===toState.name){var options=translateOptions(APP.APP_MENU.WORKSPACE_LIST.OPTIONS);$rootScope.layoutSettings&&self.$configureOptions(options,$rootScope.layoutSettings),$rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:options,actions:APP.APP_MENU.WORKSPACE_LIST.ACTIONS}),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._UPDATE,{workspace:null,workspaceId:null,diagram:null}),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:[],close:!0})}else if("CloudIn.workspaces.diagrams"===toState.name){var options=translateOptions(APP.APP_MENU.DIAGRAMS_LIST.OPTIONS);$rootScope.layoutSettings&&self.$configureOptions(options,$rootScope.layoutSettings),self.$selectedWorkspace()&&($rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:options,actions:translateOptions(APP.APP_MENU.DIAGRAMS_LIST.ACTIONS),refresh:!0}),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._UPDATE,{workspace:self.$selectedWorkspace().name,workspaceId:null,diagram:null}),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:APP.SIDE_MODULE.RIGHT_SIDE.TABS._COMMENTS,close:!0}))}else"CloudIn.workspaces.processviewer"===toState.name&&self.$selectedDiagram()&&($rootScope.$emit(APP.APP_MENU_MODULE.EVENTS._UPDATE,{options:translateOptions(APP.APP_MENU.PROCESS_VIEWER.OPTIONS),actions:translateOptions(APP.APP_MENU.PROCESS_VIEWER.ACTIONS),refresh:!0}),$rootScope.$emit(APP.APP_BREADCRUMB_MODULE.EVENTS._UPDATE,{workspace:self.$selectedWorkspace().name,workspaceId:self.$selectedWorkspace().id,diagram:self.$selectedDiagram().name}),$rootScope.$emit(APP.ASIDE_MODULE.EVENTS._UPDATE,{tabs:translateOptions(APP.SIDE_MODULE.RIGHT_SIDE.TABS._COMMENTS),close:!0}))},self.$selectedWorkspace=function(workSpace){var workspaceLoad=$storage.$load("ws");return workSpace?(void 0!==workspaceLoad&&null!==workspaceLoad?(angular.extend(workspaceLoad,workSpace),self.workSpace=workspaceLoad):self.workSpace={id:workSpace.id,name:workSpace.name,accessType:workSpace.accessType},$storage.$save("ws",self.workSpace)):self.workSpace||(self.workSpace=$storage.$load("ws")),self.workSpace},self.$selectedShape=function(shape){var shapeLoad=$storage.$load("s");return shape?(void 0!=shapeLoad&&null!=shapeLoad?(angular.extend(shapeLoad,shape),self.shape=shapeLoad):self.shape={id:shape.id,name:shape.name},$storage.$save("s",self.shape)):self.shape||(self.shape=$storage.$load("s")),self.shape},self.$removeSelectedShape=function(){$storage.$remove("s"),self.shape=void 0},self.$editWorkspace=function(workSpace){return workSpace?(self.workSpace=workSpace,$storage.$save("ws",workSpace)):self.workSpace&&(self.workSpace=$storage.$load("ws")),self.workSpace},self.$validateState=function(currentState){var state=!1;return self.state=$state.current.name,self.state===currentState&&(state=!0),state},self.$selectedDiagram=function(diagram){var diagramLoad=$storage.$load("dg"),tempDiagram={id:"",name:"",workspaceId:""};if(diagram){if(void 0!==diagramLoad&&null!==diagramLoad){for(var prop in tempDiagram)diagramLoad.hasOwnProperty(prop)&&(tempDiagram[prop]=diagramLoad[prop]),diagram.hasOwnProperty(prop)&&(tempDiagram[prop]=diagram[prop]);self.diagram=tempDiagram}else self.diagram={id:diagram.id,name:diagram.name,workspaceId:diagram.workspaceId};$storage.$save("dg",JSON.stringify(self.diagram))}else self.diagram||(self.diagram=$storage.$load("dg"));return self.diagram},self.$getLanguage=function(){var userLang="";self.language="";var languageLoad=$storage.$load("l",!0);return languageLoad&&void 0!==languageLoad&&null!==languageLoad&&""!==languageLoad?userLang=languageLoad:(userLang=navigator.language||navigator.userLanguage,$storage.$save("l",userLang.substring(0,2),!1,!0)),self.language=userLang,self.language},self.$saveNewLanguage=function(data){$storage.$save("l",data,!1,!0)},self.$layout=function(){var layout=$storage.$load("ly");return layout},self.setAuthentication=function(auth){self.user={logged:auth}},self.getAuthentication=function(){return self.user},self.setDevice=function(device){self.device=device},self.getDevice=function(){return self.device},self.setUser=function(user){self.user=user},self.getUser=function(){return self.user},self.$currentLanguage=function(lang){return lang&&(self.currentLanguage=lang),self.currentLanguage},self.$validateSpecialCharacters=function(e){(91==e.keyCode||91==e.which||38==e.keyCode||38==e.which||93==e.keyCode||93==e.which||46==e.keyCode||46==e.which||180==e.keyCode||180==e.which||172==e.keyCode||172==e.which||35==e.keyCode||35==e.which||37==e.keyCode||37==e.which||42==e.keyCode||42==e.which||123==e.keyCode||123==e.which||125==e.keyCode||125==e.which||58==e.keyCode||58==e.which||63==e.keyCode||63==e.which||191==e.keyCode||191==e.which||47==e.keyCode||47==e.which||34==e.keyCode||34==e.which||44==e.keyCode||44==e.which||124==e.keyCode||124==e.which||33==e.keyCode||33==e.which||36==e.keyCode||36==e.which||61==e.keyCode||61==e.which||161==e.keyCode||161==e.which||176==e.keyCode||176==e.which||39==e.keyCode||39==e.which||92==e.keyCode||92==e.which||168==e.keyCode||168==e.which||59==e.keyCode||59==e.which||94==e.keyCode||94==e.which||96==e.keyCode||96==e.which||126==e.keyCode||126==e.which||62==e.keyCode||62==e.which||60==e.keyCode||60==e.which||64==e.keyCode||64==e.which)&&e.preventDefault()},self.$parseEvent=function(evt){var parseEvt={isString:!1,isObject:!1,signalEvent:""},objEvaluate=evt;try{objEvaluate=JSON.parse(evt)}catch(e){}return"string"==typeof objEvaluate?(parseEvt.isString=!0,parseEvt.signalEvent=objEvaluate):"object"==typeof objEvaluate&&(parseEvt.isObject=!0,parseEvt.signalEvent=objEvaluate),parseEvt},self.$linkHeader=function(name,attrs){var data={},appState={},linkHeader=[];if(self.$validateState("CloudIn.workspaces.diagrams")?(data.workspaceId=self.$selectedWorkspace().id,data.workspaceName=self.$selectedWorkspace().name,appState.isProcessList=!0):self.$validateState("CloudIn.workspaces.diagrams.processviewer")&&(data.workspaceId=self.$selectedWorkspace().id,data.workspaceName=self.$selectedWorkspace().name,data.processId=self.$selectedDiagram().id,data.processName=self.$selectedDiagram().name,appState.isProcessViewer=!0),appState.isProcessViewer&&(linkHeader=[{filterBy:"selectedProcess",headerName:data.processName}]),name){var nameObject={filterBy:"selectedShape",headerName:name};if(attrs)for(var prop in attrs)nameObject[prop]=attrs[prop];linkHeader.push(nameObject)}return linkHeader},self.$fromModeler=function(){var isModeler=!1,stateName=location.hash.toLowerCase();return-1!==stateName.indexOf("modeler")&&(isModeler=!0,$rootScope.$emit(APPLICATION_MODULE.EVENTS._FROM_MODELER,isModeler)),isModeler},self.$timeZone=function(date){var result,timeZone=parseInt(moment(date).format("Z")),timeStamp=moment(date);return result=timeZone>0?timeStamp.add(timeZone,"h").toDate():0>timeZone?timeStamp.subtract(Math.abs(timeZone),"h").toDate():timeStamp.toDate()},self.$callWindowExternal=function(key,p1,p2){var returned="";try{return returned=p1&&!p2?window.external[key](p1):p1&&p2?window.external[key](p1,p2):window.external[key]()}catch(e){return returned}},self.tryouts=0,self.$isReady=function(objDOM,callback){return $(objDOM).length?(self.tryouts=0,callback()):self.tryouts<5&&(self.tryouts++,setTimeout(function(){self.$isReady(objDOM,callback)},200)),$(objDOM)},self.$misc=function(key,value){var misc="";return"string"!=typeof key||value?"string"==typeof key&&"string"==typeof value&&(self.evalSetFunctionValue(key,value,"self._miscellaneous"),misc=self.$extractObjectItems(key,self._miscellaneous)):misc=self.$extractObjectItems(key,self._miscellaneous),misc},self.$getSelectExternalWorkgroup=function(){return localStorage.getItem("wkg")},self.$getShowExternalPopupTrial=function(){return localStorage.getItem("exspt")},self.$getShowPopupDowngraded=function(){return localStorage.getItem("spd")},$rootScope.selectExternalWorkgroup=function(value){return localStorage.setItem("wkg",value)},$rootScope.showExternalPopupTrial=function(value){localStorage.setItem("exspt",value)},$rootScope.noShowPopupIsDowngraded=function(value){localStorage.setItem("spd",value)},self.$extractObjectItems=function(key,oObj){for(var value="",tmpObj=oObj,oTemp=key.split("."),i=0;i<oTemp.length;i++)tmpObj=tmpObj[oTemp[i]];return value=tmpObj},self.$getBasePath=function(){return(location.protocol+"//"+location.host+location.pathname).replace("index.html","").replace("#/","")},self.counterLimitForDomValidation=80,self.$elementDOMExist=function(keys){var deferred=$q.defer(),counter=0,completeDOM=!1,check=setInterval(function(){for(var keyArray=keys.split(","),validDOM=[],i=0;i<keyArray.length;i++){var el=angular.element(keyArray[i]);el.length&&validDOM.push(el)}return validDOM.length>=keyArray.length&&(completeDOM=!0),completeDOM?(clearInterval(check),deferred.resolve(el)):counter>self.counterLimitForDomValidation?(clearInterval(check),deferred.reject(key)):void counter++},100);return deferred.promise},self.changeMomentLocale=function(language){"es"===language&&moment.locale("es",{months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:function(m,format){return/-MMM-/.test(format)?es__monthsShort[m.month()]:monthsShortDot[m.month()]},weekdays:"Domingo_Lunes_Martes_Mi&eacute;rcoles_Jueves_Viernes_S&aacute;bado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mi._Jue._Vie._Sb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma&ntilde;ana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d&iacute;a",dd:"%d d&iacute;as",M:"un mes",MM:"%d meses",y:"un a&ntilde;o",yy:"%d a&ntilde;os"},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})}}),angular.module("applicationModule").service("$storage",function($cookieStore,$cookies){var self=this;self.$save=function(key,value,wCookie,unerase){sStorage.remove(key),sStorage.save(key,value,wCookie,unerase)},self.$remove=function(key){sStorage.remove(key);
},self.$load=function(key,unerase){var value=sStorage.load(key,unerase);try{value=JSON.parse(value)}catch(e){}return value},self.$empty=function(){sStorage.empty()},self.$count=function(){var count=0;for(var countCookie in $cookies)count++;return count}}),angular.module("applicationModule").factory("ServicesObjectFactory",function(){var Credentials=function(userCredentials){var credentials={};return credentials.userName=null,credentials.password=null,credentials.grant_type="password",credentials.scope="read write profile openid offline_access country",Object.preventExtensions(credentials),userCredentials&&(credentials.userName=userCredentials.userName,credentials.password=userCredentials.password),Credentials.prototype.getUserName=function(){return credentials.userName},Credentials.prototype.getPassword=function(){return credentials.password},credentials},CredentialsRefresh=function(refreshToken){var credentials={};return credentials.refresh_token=null,credentials.grant_type="refresh_token",credentials.client_id="modelercloud.bizagi.com",credentials.client_secret="yzQjjspGHznH9EdS0Oh1vVpEco5KmAIVeC9L7eQfqDkKWQvbi1Zkpun82n1hZyU9MwWvd57GtItHT58DjqXTxm4XbT",Object.preventExtensions(credentials),refreshToken&&(credentials.refresh_token=refreshToken),credentials};return{Credentials:Credentials,CredentialsRefresh:CredentialsRefresh}}).factory("Workspace",function(){function Workspace(){return this._time=function(){var stamp=(new Date).toString();return stamp},this.id=null,this.name=null,this.description=null,this.creationDate=null,this.lastModificationDate=this._time,this.workspace=function(){return this._time=function(){return new Date},{id:null,name:null,description:null,creationDate:null,lastModificationDate:this._time()}},this.workspace()}return Workspace}).factory("Notification",function(){function Notification(){return this._time=function(){var stamp=moment.utc();return stamp=stamp.toISOString()},this.clientId=null,this.eventType="Modified",this.objectType=null,this.sender=null,this.ref=null,this.timeStamp=this._time(),this.notification=function(){return{clientId:null,eventType:"Modified",objectType:null,sender:null,ref:null,timeStamp:this._time()}},this.notification()}return Notification}).factory("Comment",function(){function Comment(){return this._time=function(){var stamp=(new Date).toString();return stamp},this.id=null,this.replyTo=null,this.relatedElementId=null,this.relatedDiagramId=null,this.text=null,this.categoryColor=null,this.time=this._time,this.comment=function(){return this._time=function(){return new Date},{id:null,replyTo:null,relatedElementId:null,relatedDiagramId:null,text:null,categoryColor:null,time:this._time()}},this.comment()}return Comment}).factory("CommentState",function(){function CommentState(wsId,psId,shId,processList,processViewer,processShape,mock){return this.commentSate={},this.commentSate.workspaceId=wsId,this.commentSate.processId=psId,this.commentSate.shapeId=shId,this.commentSate.isProcessList=processList,this.commentSate.isProcessViewer=processViewer,this.commentSate.isShape=processShape,this.commentSate.mock=mock,this.commentSate}return CommentState}).factory("ObjectException",function(){function ObjectException(type,message){return this.message=message,this.name="PMCloud Object Error: "+type,this.message}return ObjectException}).factory("Credentials",function(data){function Credentials(userCredentials){this.user=userCredentials.user||null,this.password=userCredentials.password||null}return new Credentials(data)}),angular.module("applicationModule").service("applicationServices",function($rootScope,$resource,$http,$q,$data,$timeout,$stateParams,ServicesObjectFactory,APPLICATION_MODULE,Comment,Workspace,CommentState,azureBlob){function connectExt(apiLocal,queryString,loginObject,noCache,api,service,headers,deferred){if(apiLocal.url=APPLICATION_MODULE.API.PATH[api._PARENT]+apiLocal.url,queryString&&(apiLocal.url=apiLocal.url+queryString),$stateParams)for(var param in $stateParams)apiLocal.url=apiLocal.url.replace(":"+param,$stateParams[param]);return loginObject.hasOwnProperty("access_token")&&"_REFRESH"!==service?headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[APPLICATION_MODULE.ACCESS_TOKEN]:$data.$fromModeler()&&(headers[APPLICATION_MODULE.AUTHORIZATION]="Basic "+APPLICATION_MODULE.CLIENT_NAME),noCache&&(apiLocal.url=apiLocal.url.concat("?ng=cloud-"+(new Date).getTime())),apiLocal.headers=headers,$http(apiLocal).success(function(data){deferred.resolve(data)}).error(function(data,status){var result={data:data,status:status};deferred.reject(result)}),deferred.promise}$http.defaults.useXDomain=!0;var self=this;self.constants={accessToken:"access_token"},self.$configDiscoveryServices=function(data,success,fail){var response={};response=self.$connect(APPLICATION_MODULE.API.SERVICE,"_DISCOVERY",data,!0),response.then(success,fail)},self.$connect=function(api,service,data,noCache,queryString){var deferred=$q.defer();if(!api[service])return $timeout(function(){deferred.reject("API object to create a connection is not defined.")},500),deferred.promise;var apiLocal={};angular.extend(apiLocal,api[service]);var lang=$data.$getLanguage(),headers={"Content-Type":"application/json; charset=utf-8","Accept-Language":lang},loginObject=$data.$login()||{};if(data&&"object"==typeof data&&apiLocal.data)if("Array"===apiLocal.data)apiLocal.data=data;else for(var apiLocalProp in apiLocal.data)data.hasOwnProperty(apiLocalProp)&&(apiLocal.data[apiLocalProp]=data[apiLocalProp]);else"string"==typeof data?apiLocal.data=data:apiLocal.data="";return apiLocal.noContentType&&(headers={},delete apiLocal.noContentType),apiLocal.contentType&&(headers={"Content-Type":apiLocal.contentType},delete apiLocal.contentType),(!api._PARENT||api._PARENT.length<1)&&$rootScope.$emit(APPLICATION_MODULE.EVENTS._ERROR,"The parent is not defined for :"+service),!APPLICATION_MODULE.API.PATH[api._PARENT],connectExt(apiLocal,queryString,loginObject,noCache,api,service,headers,deferred)},self.$login=function(data,success,fail){_self.name="$login";var response={};self.debug().then(function(debug){if(debug){var mockResponse=self.mock("login");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.AUTHENTICATION,"_LOGIN",$.param(data)),response.then(success,fail)})},self.$register=function(data,successCallback,failCallback){var apiLocal={};angular.extend(apiLocal,APPLICATION_MODULE.API.PROFILE._REGISTER),apiLocal.url=APPLICATION_MODULE.API.PATH[APPLICATION_MODULE.API.PROFILE._PARENT]+apiLocal.url;var req={method:"POST",url:apiLocal.url,headers:{"Content-Type":"application/json"},data:data};$http(req).success(successCallback).error(failCallback)},self.userInfoIdentityServerEndpoint=function(accessToken,success,fail){var deferred=$q.defer(),apiLocal={},userInfoUrl="/core/connect/userinfo",urlHost=window.location.protocol+"//"+window.location.host;apiLocal.url=urlHost+userInfoUrl,apiLocal.headers={Authorization:"Bearer "+accessToken},$http(apiLocal).success(function(data){deferred.resolve(data)}).error(function(data,status){var result={data:data,status:status};deferred.reject(result)});var result=deferred.promise;result.then(success,fail)},self.$me=function(data,success,fail){var response={},_self=this;_self.name="$me",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("userProfile");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE,"_SHORT",data),fail||(fail=function(e){e.reference="PROFILE",self.$responseError({},function(){self.$me(data,success,fail)},e)}),response.then(success,fail)})},self.$userProfile=function(data,success,fail){var response,_self=this;_self.name="$userProfile",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("userProfile");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE_COLLABORATION,"_GET",data),fail||(fail=function(e){e.reference="USER_PROFILE_MODULE",self.$responseError({},function(){self.$userProfile(data,success,fail)},e)}),response.then(success,fail)})},self.$resetPassword=function(data,success,fail){var response,_self=this;_self.name="$resetPassword",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("$resetPassword");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE,"_RESET_PASSWORD",'"'+data+'"'),fail||(fail=function(e){e.reference="_RESET_PASSWORD",self.$responseError({},function(){self.$resetPassword(data,success,fail)},e)}),response.then(success,fail)})},self.$confirmResetPassword=function(data,success,fail){var response,_self=this;_self.name="$confirmResetPassword",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("$confirmResetPassword");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.PROFILE);API._CONFIRM_RESET_PASSWORD.url=API._CONFIRM_RESET_PASSWORD.url.replace("{token}",data.token).replace("{email}",data.email),response=self.$connect(API,"_CONFIRM_RESET_PASSWORD",'"'+data.newPassword+'"'),fail||(fail=function(e){e.reference="_CONFIRM_RESET_PASSWORD",self.$responseError({},function(){self.$confirmResetPassword(data,success,fail)},e)}),response.then(success,fail)}})},self.$getUserById=function(data,success,fail){var API,response={},_self=this;_self.name="$getUserById",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("me");mockResponse.then(success,fail)}else API=angular.copy(APPLICATION_MODULE.API.PROFILE),API._GET_USER_BY_ID.url=API._GET_USER_BY_ID.url.replace("{{userId}}",data.userId),response=self.$connect(API,"_GET_USER_BY_ID",{}),fail||(fail=function(e){e.reference="PROFILE",self.$responseError({},function(){self.$getUserById(data,success,fail)},e)}),response.then(success,fail)})},self.$getUsersById=function(data,success,fail){var response={},_self=this;_self.name="$getUsersById",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("me");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE,"_GET_USERS",{},!1,data.queryStringIds),fail||(fail=function(e){e.reference="PROFILE",self.$responseError({},function(){self.$getUserById(data,success,fail)},e)}),response.then(success,fail)})},self.$getCountries=function(data,success,fail){var response,_self=this;_self.name="$getCountries",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("countries");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PAYMENT,"_GET_COUNTRIES",null),fail||(fail=function(e){e.reference="_GET_COUNTRIES",self.$responseError({},function(){self.$getCountries(data,success,fail)},e)}),response.then(success,fail)})},self.$updateUserProfile=function(data,success,fail){var response,_self=this;_self.name="$updateUserProfile",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("updateUserProfile");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE,"_UPDATE",data),fail||(fail=function(e){e.reference="USER_PROFILE_MODULE",self.$responseError({},function(){self.$userProfile(data,success,fail)},e)}),response.then(success,fail)})},self.$changePassword=function(data,success,fail){var response={},_self=this;_self.name="$changePassword",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("changePassword");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PROFILE,"_CHANGE_PASSWORD",data),response.then(success,fail)})},self.$workspaceList=function(data,success,fail){var response={},_self=this;_self.name="$workspaceList",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("workspaceList");mockResponse.then(success,fail)}else response=data.hasOwnProperty("page")?data.blockContributors?self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_LIST",data,!1,"?pageNumber="+data.page+"&blockContrubutorAccess="+data.blockContributors):self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_LIST",data,!1,"?pageNumber="+data.page):data.blockContributors?self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_LIST",data,!1,"?blockContrubutorAccess="+data.blockContributors):self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_LIST",data),fail||(fail=function(e){e.reference="WORKSPACE_MODULE",self.$responseError({},function(){self.$workspaceList(data,success,fail)},e)}),response.then(success,fail)})},self.$newWorkspace=function(data,success,fail){var response,workspace=new Workspace,_self=this;_self.name="$newWorkspace",workspace.creationDate=(new Date).toString(),workspace.lastModificationDate=(new Date).toString(),angular.extend(workspace,data.workspace),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("newWorkspace");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_NEW",data),fail||(fail=function(e){e.reference="NEW_WORKSPACE_MODULE",self.$responseError({},function(){self.$newWorkspace(data,success,fail)},e)}),response.then(success,fail)})},self.$updateWorkspace=function(data,success,fail){var response,workspace={id:data.id,name:data.name,description:data.description},_self=this;_self.name="$updateWorkspace",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("updateWorkspace");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.WORKSPACE);API._UPDATE.url=API._UPDATE.url.replace("{{id:Guid}}",data.id),response=self.$connect(API,"_UPDATE",workspace),fail||(fail=function(e){e.reference="EDIT_WORKSPACE_MODULE",self.$responseError({},function(){self.$updateWorkspace(data,success,fail)},e)}),response.then(success,fail)}})},self.$deleteWorkspace=function(data,success,fail){var response,_self=this;_self.name="$deleteWorkspace",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("updateWorkspace");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.WORKSPACE);API._DELETE.url=API._DELETE.url.replace("{{id:Guid}}",data.id),response=self.$connect(API,"_DELETE",null),fail||(fail=function(e){e.reference="DELETE_WORKSPACE_MODULE",self.$responseError({},function(){self.$deleteWorkspace(data,success,fail)},e)}),response.then(success,fail)}})},self.$setMemberAccess=function(data,success,fail){var response={},_self=this;_self.name="$setMemberAccess",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberAccess");mockResponse.then(success,fail)}else{var memberAccess={userId:data.id,access:data.access,email:data.email},API=angular.copy(APPLICATION_MODULE.API.WORKSPACE);API._MEMBER_ACCESS.url=API._MEMBER_ACCESS.url.replace("{{workspaceId:Guid}}",data.workspaceId),response=self.$connect(API,"_MEMBER_ACCESS",memberAccess),response.then(success,fail)}})},self.$diagramsList=function(data,success,fail){var response={},_self=this;_self.name="$diagramsList",fail||(fail=function(e){e.reference="DIAGRAMS_MODULE",self.$responseError({},function(){self.$diagramsList(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("diagramsList");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.DIAGRAMS,"_LIST",data),response.then(success,fail)})},self.$unlockDiagram=function(data,success,fail){var response={},_self=this;_self.name="$unlockDiagram",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("unlockDiagram");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.DIAGRAMS);API._UNLOCK.url=API._UNLOCK.url.replace("{workspaceId}",data.workspaceId).replace("{diagramId}",data.diagramId),response=self.$connect(API,"_UNLOCK",null),fail||(fail=function(e){e.reference="DIAGRAMS_MODULE",self.$responseError({},function(){self.$unlockDiagram(data,success,fail)},e)}),response.then(success,fail)}})},self.$teamNew=function(data,success,fail){var response={},_self=this;_self.name="$teamNew",fail||(fail=function(e){e.reference="TEAM_MODULE",self.$responseError({},function(){self.$teamNew(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("teamNew");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.TEAM,"_NEW",data),response.then(function(data){success(data),self.$refreshToken({},function(dataRefresh){$data.$updateUserProfileRole("Admin")},function(e){})},fail)})},self.$teamList=function(data,success,fail){var response={},_self=this;_self.name="$teamList",fail||(fail=function(e){e.reference="TEAM_MODULE",self.$responseError({},function(){self.$teamList(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("teamList");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.TEAM,"_LIST",data),response.then(success,fail)})},self.$memberInvite=function(data,success,fail){data.workspaceId?self.$memberInviteWorkspace(data,success,fail):self.$memberInviteTeam(data,success,fail)},self.$memberInviteTeam=function(data,success,fail){var response={},_self=this;_self.name="$memberInviteTeam",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberInviteTeam(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberInviteTeam");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.MEMBER,"_INVITE",data),response.then(success,fail)})},self.$memberInviteWorkspace=function(data,success,fail){var API,response={},_self=this;_self.name="$memberInviteWorkspace",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberInviteTeam(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.WORKSPACE),API._INVITE_MEMBERS.url=API._INVITE_MEMBERS.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberInviteWorkspace");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.MEMBER);API._WORKSPACE_INVITE_UNREGISTERED.url=API._WORKSPACE_INVITE_UNREGISTERED.url.replace("{{workspaceId}}",data.workspaceId);var invitationModel={workspaceId:data.workspaceId,grantAccesses:data.list,inviteNote:data.noteInvite,subscriptionId:data.subscriptionId};response=self.$connect(API,"_WORKSPACE_INVITE_UNREGISTERED",invitationModel),response.then(success,fail)}})},self.$memberAcceptInvitation=function(data,success,fail){var response={},_self=this;_self.name="$memberAcceptInvitationWorkspace",fail||(fail=function(e){e.reference="_ACCEPT",self.$responseError({},function(){self.$memberAcceptInvitation(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberAcceptInvitation");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.MEMBER);API._ACCEPT.url=API._ACCEPT.url.replace("{{workspaceId}}",data.workspaceId).replace("{{invitationId}}",data.invitationId),response=self.$connect(API,"_ACCEPT"),response.then(success,fail)}})},self.$getSubscriptionInfo=function(data,success,fail){var response={},_self=this;_self.name="$getSubscriptionInfo",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$getSubscriptionInfo(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("getSubscriptionInfo");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.BILLING,"_INFO",data),response.then(success,fail)})},self.$sendEmailModelShared=function(data,success,fail){var req={method:"POST",url:APPLICATION_MODULE.API.PATH.collaborationService+"api/email/custom/"+data.to+"/",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"body="+data.body};$http(req).success(success).error(fail)},self.$memberList=function(data,success,fail){data.workspaceId?self.$memberListWorkspace(data,success,fail):self.$memberListTeam(data,success,fail)},self.$memberListTeam=function(data,success,fail){var response={},_self=this;_self.name="$memberListTeam",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberListTeam(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberList");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.MEMBER,"_LIST",null,!1,"?pageNumber="+data.pageNumber+"&pageSize="+data.pageSize),response.then(success,fail)})},self.$memberListWorkspace=function(data,success,fail){var API,response={},_self=this;_self.name="$memberListWorkspace",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberListWorkspace(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.WORKSPACE),API._LIST_MEMBERS.url=API._LIST_MEMBERS.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberList");mockResponse.then(success,fail)}else response=data.pageNumber&&data.pageSize?self.$connect(API,"_LIST_MEMBERS",null,!1,"?pageNumber="+data.pageNumber+"&pageSize="+data.pageSize):self.$connect(API,"_LIST_MEMBERS",null,"?pageNumber="+data.pageNumber+"&pageSize="+data.pageSize),response.then(success,fail)})},self.$memberUpdate=function(data,success,fail){data.workspaceId?self.$memberUpdateAccess(data,success,fail):self.$memberUpdateRole(data,success,fail)},self.$memberUpdateRole=function(data,success,fail){var response={},_self=this;_self.name="$memberUpdateRole",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberUpdateRole(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberUpdate");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.MEMBER,"_UPDATE_ROLE",data,!1,"/"+encodeURIComponent(data.email)+"/"),response.then(success,fail)})},self.$memberDelete=function(data,success,fail){data.workspaceId?self.$memberDeleteWorkspace(data,success,fail):self.$memberDeleteTeam(data,success,fail)},self.$memberDeleteTeam=function(data,success,fail){var response={},_self=this;_self.name="$memberDeleteTeam",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberDeleteTeam(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberDelete");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.MEMBER,"_DELETE",null,!1,"/"+data),response.then(success,fail)})},self.$memberDeleteWorkspace=function(data,success,fail){var API,response={},_self=this;_self.name="$memberDeleteWorkspace",fail||(fail=function(e){e.reference="MEMBER_MODULE",self.$responseError({},function(){self.$memberDeleteTeam(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.WORKSPACE),API._DELETE_MEMBERS.url=API._DELETE_MEMBERS.url.replace("{{workspaceId}}",data.workspaceId).replace("{{userId}}",data.userId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("memberDelete");mockResponse.then(success,fail)}else response=self.$connect(API,"_DELETE_MEMBERS",null),response.then(success,fail)})},self.$searchWorkspace=function(data,success,fail){var response={},_self=this;_self.name="$searchWorkspace",fail||(fail=function(e){e.reference="WORKSPACE_MODULE",self.$responseError({},function(){self.$searchWorkspace(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("searchWorkspace");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.WORKSPACE,"_SEARCH",null,!1,"?withNameOrDescriptionLike="+data),response.then(success,fail)})},self.$newUser=function(data,success,fail){var response={},_self=this;_self.name="$newUser",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("newUser");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.USER._NEW,data),response.then(success,fail)})},self.$refreshToken=function(data,success,fail){var response,refreshToken=$data.$login().refresh_token,credentialsRefresh=new ServicesObjectFactory.CredentialsRefresh(refreshToken),_self=this;_self.name="$refreshToken",fail||(fail=function(){self.$logout()}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("refreshToken");mockResponse.then(success,fail)}else if($data.$isIE9Version()){var dataPost={grant_type:credentialsRefresh.grant_type,url:APPLICATION_MODULE.API.PATH.membershipService,clientId:credentialsRefresh.client_id,refresh_token:credentialsRefresh.refresh_token,client_secret:credentialsRefresh.client_secret};$http.post(APPLICATION_MODULE.API.PATH.collaborationService+"api/token",dataPost).success(function(responseToken){$rootScope.$emit(APPLICATION_MODULE.EVENTS._AUTHENTICATION_REFRESH,responseToken),$data.$login(responseToken),success(responseToken)}).error(function(){self.$logout()})}else response=self.$connect(APPLICATION_MODULE.API.AUTHENTICATION,"_REFRESH",$.param(credentialsRefresh)),response.then(function(dataForCallback){$rootScope.$emit(APPLICATION_MODULE.EVENTS._AUTHENTICATION_REFRESH,dataForCallback),$data.$login(dataForCallback),success(dataForCallback)},fail)})},self.$getNotifications=function(data,success,fail){var API,response={},_self=this;_self.name="$getNotifications",fail||(fail=function(e){e.reference="NOTIFICATIONS_MODULE",self.$responseError({},function(){self.$getNotifications(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.NOTIFICATIONS),API._WORKSPACE.url=API._WORKSPACE.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("getNotifications");mockResponse.then(success,fail)}else response=self.$connect(API,"_WORKSPACE",data,!1,"?continueWithToken="+data.continuationToken),response.then(success,fail)})},self.$countNotifications=function(data,success,fail){var API,response={},_self=this;_self.name="$countNotifications",API=angular.copy(APPLICATION_MODULE.API.NOTIFICATIONS),API._COUNT.url=API._COUNT.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("countNotifications");mockResponse.then(success,fail)}else response=self.$connect(API,"_COUNT",data),response.then(success,fail)})},self.$markAsReadNotifications=function(data,success,fail){var API,response={},_self=this;_self.name="$markAsReadNotifications",API=angular.copy(APPLICATION_MODULE.API.NOTIFICATIONS),API._AS_READ.url=API._AS_READ.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("markAsReadNotifications");mockResponse.then(success,fail)}else response=self.$connect(API,"_AS_READ",null,null,data.markAsRead),response.then(success,fail)})},self.tryouts={},self.$responseError=function(data,success,result){self.tryouts[result.reference]||(self.tryouts[result.reference]=3),self.tryouts[result.reference]--;var validate=self.$validateStatus(result);if(validate.refresh&&self.tryouts[result.reference]>0)self.$refreshToken({},success);else{delete self.tryouts[result.reference],$rootScope.$emit(APPLICATION_MODULE.EVENTS._HIDE);var message=validate.message&&validate.message.length?validate.message:APPLICATION_MODULE.EXCEPTIONS.COMMON[0];self.fail(message,result.status)}},self.$getSignalRScript=function(hubUrl){var deferred=$q.defer();return $.getScript(hubUrl+"/hubs").done(function(script){deferred.resolve(script)}).fail(function(jqxhr,settings,exception){deferred.reject(exception)}),deferred.promise},self.$logout=function(){$rootScope.$emit(APPLICATION_MODULE.EVENTS._LOGOUT)},self.$validateStatus=function(result){var rValue=!0,exception={};return(400===result.status||412===result.status||413===result.status||403===result.status||409===result.status||404===result.status||500===result.status||0===result.status)&&(rValue=!1,exception.message=APPLICATION_MODULE.EXCEPTIONS[result.reference.toUpperCase()]?APPLICATION_MODULE.EXCEPTIONS[result.reference.toUpperCase()][result.status]:APPLICATION_MODULE.EXCEPTIONS.COMMON[result.status]),exception.refresh=rValue,exception},self.$replyComment=function(data,success,fail){var response={},_self=this;_self.name="$replyComment",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("replyComment");mockResponse.then(success,fail)}else{var comment={text:data.text,userId:data.userId},API=angular.copy(APPLICATION_MODULE.API.COMMENTS);API._ADD_REPLY.url=API._ADD_REPLY.url.replace("{{workspaceId:Guid}}",data.workspaceId).replace("{{commentId:Guid}}",data.id),response=self.$connect(API,"_ADD_REPLY",comment),response.then(success,fail)}})},self.$getRepliesComment=function(data,success,fail){var response={},_self=this;_self.name="$getRepliesComment",self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("replyComment");mockResponse.then(success,fail)}else{var API=angular.copy(APPLICATION_MODULE.API.COMMENTS);API._GET_REPLIES.url=API._GET_REPLIES.url.replace("{{workspaceId:Guid}}",data.workspaceId).replace("{{commentId:Guid}}",data.id),response=self.$connect(API,"_GET_REPLIES",{}),response.then(success,fail)}})},self.$getWorkspace=function(data,success,fail){var response,API,_self=this;_self.name="$getWorkspace",fail||(fail=function(e){e.reference="GET_WORKSPACE_INFO",self.$responseError({},function(){self.$getWorkspace(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.WORKSPACE),API._INFO.url=API._INFO.url.replace("{{id:Guid}}",data.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("getWorkspace");mockResponse.then(success,fail)}else response=self.$connect(API,"_INFO",{}),response.then(success,fail)})},self.$getFileInfo=function(data,success,fail){var response,API,_self=this;_self.name="$getFileInfo",fail||(fail=function(e){e.reference="GET_FILE_INFO",self.$responseError({},function(){self.$getFileInfo(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._INFO.url=API._INFO.url.replace("{{id}}",data.workspace.id).replace("{{fileId}}",data.file.id),self.debug(_self.name).then(function(debug){debug?success($app.$mock("fileInfo")):(response=self.$connect(API,"_INFO",{}),response.then(success,fail))})},self.$getListFiles=function(data,success,fail){var response,API,_self=this;_self.name="$getListFiles",fail||(fail=function(e){e.reference="GET_FILE_LIST",self.$responseError({},function(){self.$getListFiles(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._LIST.url=API._LIST.url.replace("{{id}}",data.workspace.id),self.debug(_self.name).then(function(debug){if(debug)success($app.$mock("listFiles"));else{var pageSize=data.itemsPerPage||10;response=data.hasOwnProperty("page")&&data.hasOwnProperty("searchFileName")?self.$connect(API,"_LIST",{},!1,"?pageSize="+pageSize+"&pageNumber="+data.page+"&withFileNameLike="+data.searchFileName):data.hasOwnProperty("page")?self.$connect(API,"_LIST",{},!1,"?pageSize="+pageSize+"&pageNumber="+data.page):data.hasOwnProperty("searchFileName")?self.$connect(API,"_LIST",{},!1,"?pageSize="+pageSize+"&withFileNameLike="+data.searchFileName):self.$connect(API,"_LIST",{},!1,"?pageSize="+pageSize),response.then(success,fail)}})},self.$uploadFileProcess=function(data,success,fail){var config={baseUrl:data.url,sasToken:data.transactionId,file:data.fileData,progress:function(data){},complete:success,error:fail};azureBlob.upload(config)},self.$uploadSingleFileConfirm=function(data,success,fail){var headers={"Content-Type":void 0},API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER);if(API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{id}}",data.workspace.id),
API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{transactionId}}",data.transactionId),API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{fileId}}",data.fileId),$data.$login()){var loginObject=$data.$login();headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[self.constants.accessToken]}self.debug().then(function(debug){if(!debug){var response=self.$connect(API,"_UPLOAD_CONFIRMATION");fail||(fail=function(e){e.reference="_UPLOAD_CONFIRMATION",self.$responseError({},function(){self.$uploadFileConfirm(data,success,fail)},e)}),response.then(success,fail)}})},self.$uploadFileConfirm=function(data,success,fail){var headers={"Content-Type":void 0},API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER);if(API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{id}}",data.content.workspace.id),API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{transactionId}}",data.transactionId),API._UPLOAD_CONFIRMATION.url=API._UPLOAD_CONFIRMATION.url.replace("{{fileId}}",data.uploadedFile.id),$data.$login()){var loginObject=$data.$login();headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[self.constants.accessToken]}self.debug().then(function(debug){if(!debug){var response=self.$connect(API,"_UPLOAD_CONFIRMATION",data.content);fail||(fail=function(e){e.reference="_UPLOAD_CONFIRMATION",self.$responseError({},function(){self.$uploadFileConfirm(data,success,fail)},e)}),response.then(success,fail)}})},self.$uploadFilesConfirm=function(data,success,fail){var headers={"Content-Type":void 0},API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER);if(API._UPLOAD_FILES_CONFIRMATION.url=API._UPLOAD_FILES_CONFIRMATION.url.replace("{{id}}",data.workspace.id),API._UPLOAD_FILES_CONFIRMATION.url=API._UPLOAD_FILES_CONFIRMATION.url.replace("{{transactionId}}",data.transactionId),$data.$login()){var loginObject=$data.$login();headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[self.constants.accessToken]}self.debug().then(function(debug){if(!debug){var response=self.$connect(API,"_UPLOAD_FILES_CONFIRMATION",data.filesConfirm);fail||(fail=function(e){e.reference="_UPLOAD_FILES_CONFIRMATION",self.$responseError({},function(){self.$uploadFilesConfirm(data,success,fail)},e)}),response.then(success,fail)}})},self.$uploadFileStart=function(data,success,fail){var headers={"Content-Type":void 0},workSpaceId=void 0==data.content?data.workspace.id:data.content.workspace.id,API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER);if(API._UPLOAD_START.url=API._UPLOAD_START.url.replace("{{id}}",workSpaceId),API._UPLOAD_START.url=API._UPLOAD_START.url.replace("{{transactionId}}",data.transactionId),$data.$login()){var loginObject=$data.$login();headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[self.constants.accessToken]}self.debug().then(function(debug){if(!debug){var response=self.$connect(API,"_UPLOAD_START",data.file);fail||(fail=function(e){e.reference="UPLOAD_FILE_START",self.$responseError({},function(){self.$uploadFileStart(data,success,fail)},e)}),response.then(success,fail)}})},self.$uploadFilesStart=function(data,success,fail){var headers={"Content-Type":void 0};if(void 0!=data.workspace.id){var API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER);if(API._UPLOAD_FILES_START.url=API._UPLOAD_FILES_START.url.replace("{{id}}",data.workspace.id),API._UPLOAD_FILES_START.url=API._UPLOAD_FILES_START.url.replace("{{transactionId}}",data.transactionId),$data.$login()){var loginObject=$data.$login();headers[APPLICATION_MODULE.AUTHORIZATION]="Bearer "+loginObject[self.constants.accessToken]}self.debug().then(function(debug){if(!debug){var response=self.$connect(API,"_UPLOAD_FILES_START",data.files);fail||(fail=function(e){e.reference="UPLOAD_FILE_START",self.$responseError({},function(){self.$uploadFilesStart(data,success,fail)},e)}),response.then(success,fail)}})}},self.$getQuota=function(data,success,fail){var response,API,_self=this;_self.name="$getQuota",fail||(fail=function(e){e.reference="GET_QUOTA",self.$responseError({},function(){self.$getQuota(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._QUOTA.url=API._QUOTA.url.replace("{{id}}",data.content.workspace.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("quota");mockResponse.then(success,fail)}else response=self.$connect(API,"_QUOTA",{}),response.then(success,fail)})},self.$getAppQuota=function(data,success,fail){var response,_self=this;_self.name="$getAppQuota",fail||(fail=function(e){e.reference="GET_QUOTA_APP",self.$responseError({},function(){self.$getAppQuote(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("app_quota");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.QUOTA,"_GET_APP",{}),response.then(success,fail)})},self.$getQuotaByModel=function(data,success,fail){var response,API,_self=this;_self.name="$getQuotaByModel",fail||(fail=function(e){e.reference="GET_QUOTA_APP",self.$responseError({},function(){self.$getAppQuote(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._QUOTA_BY_MODEL.url=API._QUOTA_BY_MODEL.url.replace("{{modelId}}",data),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("quota_by_model");mockResponse.then(success,fail)}else response=self.$connect(API,"_QUOTA_BY_MODEL",{}),response.then(success,fail)})},self.$deleteFile=function(data,success,fail){var response,API,_self=this;_self.name="$deleteFile",fail||(fail=function(e){e.reference="DELETE_FILE",self.$responseError({},function(){self.$deleteFile(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._DELETE.url=API._DELETE.url.replace("{{id}}",data.workspace.id).replace("{{fileId}}",data.file.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("deleteFile");mockResponse.then(success,fail)}else response=self.$connect(API,"_DELETE",{}),response.then(success,fail)})},self.$renameFile=function(data,success,fail){var response,API,_self=this;_self.name="$renameFile",fail||(fail=function(e){e.reference="RENAME_FILE",self.$responseError({},function(){self.$renameFile(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._RENAME.url=API._RENAME.url.replace("{{id}}",data.workspace.id).replace("{{fileId}}",data.file.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("renameFile");mockResponse.then(success,fail)}else response=self.$connect(API,"_RENAME","newName="+data.file.newName),response.then(success,fail)})},self.$downloadFile=function(data,success,fail){var response,API,_self=this;_self.name="$downloadFile",fail||(fail=function(e){e.reference="DOWNLOAD_FILE",self.$responseError({},function(){self.$downloadFile(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.FILE_MANAGER),API._DOWNLOAD.url=API._DOWNLOAD.url.replace("{{id}}",data.workspace.id).replace("{{fileId}}",data.file.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("downloadFile");mockResponse.then(success,fail)}else response=self.$connect(API,"_DOWNLOAD",{}),response.then(success,fail)})},self.$getComments=function(data,success,fail){var response,appState,API,_self=this;_self.name="$getComments",fail||(fail=function(e){e.reference="COMMENTS",self.$responseError({},function(){self.$getComments(data,success,fail)},e)}),appState=self.validateStateForComments(),API=angular.copy(APPLICATION_MODULE.API.COMMENTS),1!=appState.isWorkspaceList&&(appState.isProcessList?API._WORKSPACE.url=API._WORKSPACE.url.replace("{{workspaceId}}",appState.workspaceId):appState.isShape?API._LIST_COMMENTS_BY_SHAPE.url=API._LIST_COMMENTS_BY_SHAPE.url.replace("{{workspaceId}}",appState.workspaceId).replace("{{diagramId}}",appState.processId).replace("{{shapeId}}",appState.shapeId):API._DIAGRAM.url=API._DIAGRAM.url.replace("{{workspaceId}}",appState.workspaceId).replace("{{diagramId}}",appState.processId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("getComments");mockResponse.then(success,fail)}else response=appState.isProcessList?self.$connect(API,"_WORKSPACE",data,!1,"?continueWithToken="+data.continuationToken):appState.isShape?self.$connect(API,"_LIST_COMMENTS_BY_SHAPE",data,!1,"?continueWithToken="+data.continuationToken):self.$connect(API,"_DIAGRAM",data,!1,"?continueWithToken="+data.continuationToken),response.then(success,fail)}))},self.$getDiagramDefinition=function(data,success,fail){var response,_self=this;_self.name="$getDiagramDefinition",fail||(fail=function(e){e.reference="PROCESS_VIEWER",self.$responseError({},function(){self.$getDiagramDefinition(data,success,fail)},e)});var API=angular.copy(APPLICATION_MODULE.API.PROCESS_VIEWER);API._VIEW.url=API._VIEW.url.replace("{{diagramId}}",data.diagram.id).replace("{{workspaceId}}",data.workspace.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("processViewer");mockResponse.then(success,fail)}else response=self.$connect(API,"_VIEW",{},!1,"?useDiagramViewer=true"),response.then(success,fail)})},self.$deleteComment=function(comment,success,fail){var response,appState,API,_self=this;_self.name="$deleteComment",fail||(fail=function(e){e.reference="COMMENTS",self.$responseError({},function(){self.$deleteComment(data,success,fail)},e)}),appState=self.validateStateForComments(),API=angular.copy(APPLICATION_MODULE.API.COMMENTS),API._DELETE_FROM_WORKSPACE.url=API._DELETE_FROM_WORKSPACE.url.replace("{{workspaceId}}",appState.workspaceId).replace("{{commentId}}",comment.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("deleteComment");mockResponse.then(success,fail)}else response=comment.hasOwnProperty("repliedTo")?self.$connect(API,"_DELETE_FROM_WORKSPACE",{},!1,"?repliedTo="+comment.repliedTo):self.$connect(API,"_DELETE_FROM_WORKSPACE",{}),response.then(success,fail)})},self.$sendComments=function(data,success,fail){var response,appState,API,_self=this;appState=self.validateStateForComments(),_self.name="$sendComments",fail||(fail=function(e){e.reference="COMMENTS",self.$responseError({},function(){self.$sendComments(data,success,fail)},e)}),appState=self.validateStateForComments(),API=angular.copy(APPLICATION_MODULE.API.COMMENTS),appState.isProcessList?API._SEND_FROM_WORKSPACE.url=API._SEND_FROM_WORKSPACE.url.replace("{{workspaceId}}",appState.workspaceId):appState.isShape?API._SEND_FROM_SHAPE.url=API._SEND_FROM_SHAPE.url.replace("{{workspaceId}}",appState.workspaceId).replace("{{diagramId}}",appState.processId).replace("{{shapeId}}",appState.shapeId):API._SEND_FROM_DIAGRAM.url=API._SEND_FROM_DIAGRAM.url.replace("{{workspaceId}}",appState.workspaceId).replace("{{diagramId}}",appState.processId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("sendComment");mockResponse.then(function(dataMock){var max=9e15,min=1e4;dataMock.id=Math.floor(Math.random()*(max-min))+min,dataMock.time=(new Date).toString(),dataMock.text=data.text,success(dataMock)},fail)}else response=appState.isProcessList?self.$connect(API,"_SEND_FROM_WORKSPACE",data):appState.isShape?self.$connect(API,"_SEND_FROM_SHAPE",data):self.$connect(API,"_SEND_FROM_DIAGRAM",data),response.then(success,fail)})},self.$getShapesWithComments=function(data,success,fail){var response,API,_self=this;_self.name="$getShapesWithComments",fail||(fail=function(e){e.reference="COMMENTS",self.$responseError({},function(){self.$getShapesWithComments(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.COMMENTS),API._LIST_SHAPES.url=API._LIST_SHAPES.url.replace("{{workspaceId}}",data.workspace.id).replace("{{diagramId}}",data.diagram.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("shapeCommentsList_multiProcess");mockResponse.then(success,fail)}else response=self.$connect(API,"_LIST_SHAPES",{}),response.then(success,fail)})},self.$getExtendedAttributes=function(data,success,fail){var response,API,_self=this;_self.name="$getExtendedAttributes",fail||(fail=function(e){e.$getExtendedAttributes="EXTENDED_ATTRIBUTES",self.$responseError({},function(){self.$getExtendedAttributes(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.EXTENDED_ATTRIBUTES),API._LIST.url=API._LIST.url.replace("{{workspaceId}}",$data.$selectedWorkspace().id).replace("{{shapeId}}",$data.$selectedShape().id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("extendedAttributes");mockResponse.then(success,fail)}else response=self.$connect(API,"_LIST",{}),response.then(success,fail)})},self.$getProcessExtendedAttributes=function(data,success,fail){var response,API,_self=this;_self.name="$getProcessExtendedAttributes",fail||(fail=function(e){e.reference="PROCESS_EXTENDED_ATTRIBUTES",self.$responseError({},function(){self.$getProcessExtendedAttributes(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.PROCESS_EXTENDED_ATTRIBUTES),API._LIST.url=API._LIST.url.replace("{{workspaceId}}",$data.$selectedWorkspace().id).replace("{{processId}}",data.process.id),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("processExtendedAttributes");mockResponse.then(success,fail)}else response=self.$connect(API,"_LIST",{}),response.then(success,fail)})},self.$validateAmountLicenses=function(data,success,fail){var response,_self=this;_self.name="$validateAmountLicenses",fail||(fail=function(e){e.$validateAmountLicenses="VALIDATE_AMOUNT_LICENCES",self.$responseError({},function(){self.$updateLicenses(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("updateLicenses");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.LICENSES,"_VALIDATE_AMOUNT_LICENSES",data),response.then(success,fail)})},self.$activeTrial=function(data,success,fail){var response,_self=this;_self.name="$activeTrial",fail||(fail=function(e){e.$activeTrial="ACTIVATE_PLAN",self.$responseError({},function(){self.$activeTrial(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("activateTrial");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PLAN,"_ACTIVATE_TRIAL",{}),response.then(success,fail)})},self.$upgradePlan=function(data,success,fail){var response,_self=this;_self.name="$upgradePlan",fail||(fail=function(e){e.$upgradePlan="ACTIVATE_PLAN",self.$responseError({},function(){self.$upgradePlan(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("upgradePlan");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PLAN,"_UPGRADE_PLAN",{}),response.then(success,fail)})},self.$downgradePlan=function(data,success,fail){var response,_self=this;_self.name="$downgradePlan",fail||(fail=function(e){e.$downgradePlan="ACTIVATE_PLAN",self.$responseError({},function(){self.$downgradePlan(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("downgradePlan");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PLAN,"_DOWNGRADE_PLAN",{}),response.then(success,fail)})},self.$updateLicenses=function(data,success,fail){var response,_self=this;_self.name="$updateLicenses",fail||(fail=function(e){e.$updateLicenses="LICENSES",self.$responseError({},function(){self.$updateLicenses(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("updateLicenses");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.LICENSES,"_UPDATE",data),response.then(success,fail)})},self.$initTransaction=function(data,success,fail){var response,_self=this;_self.name="$initTransaction",fail||(fail=function(e){e.$initTransaction="PAYMENTS",self.$responseError({},function(){self.$initTransaction(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("initTransactions");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PAYMENT,"_INIT_TRANSACTION",data),response.then(success,fail)})},self.$commitTransaction=function(data,success,fail){var response,_self=this;_self.name="$commitTransaction",fail||(fail=function(e){e.$commitTransaction="PAYMENTS",self.$responseError({},function(){self.$cancelTransaction(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("commitTransaction");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PAYMENT,"_COMMIT_TRANSACTION",{},!1,"?ecToken="+data.token+"&payerID="+data.PayerID),response.then(success,fail)})},self.$cancelTransaction=function(data,success,fail){var response,_self=this;_self.name="$cancelTransaction",fail||(fail=function(e){e.$cancelTransaction="PAYMENTS",self.$responseError({},function(){self.$cancelTransaction(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("cancelTransaction");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PAYMENT,"_CANCEL_TRANSACTION",{},!1,"?ecToken="+data.token),response.then(success,fail)})},self.$getInvoices=function(data,success,fail){var response,_self=this;_self.name="$getInvoices",fail||(fail=function(e){e.$getInvoices="PAYMENTS",self.$responseError({},function(){self.$getInvoices(data,success,fail)},e)}),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("invoices");mockResponse.then(success,fail)}else response=self.$connect(APPLICATION_MODULE.API.PAYMENT,"_INVOICES",data),response.then(success,fail)})},self.$getCollaborators=function(data,success,fail){var response,API,_self=this;_self.name="$getCollaborators",fail||(fail=function(e){e.$getCollaborators="COLLABORATORS",self.$responseError({},function(){self.$getCollaborators(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.COLLABORATORS),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("collaborators");mockResponse.then(success,fail)}else response=self.$connect(API,"_LIST",{}),response.then(success,fail)})},self.$getInvitationsPending=function(data,success,fail){var response,API,_self=this;_self.name="$getInvitationsPending",fail||(fail=function(e){e.$getInvitationsPending="INVITATIONS",self.$responseError({},function(){self.$getInvitationsPending(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.INVITATIONS),API._LIST_PENDING.url=API._LIST_PENDING.url.replace("{{workspaceId}}",data.workspaceId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("invitations","");mockResponse.then(success,fail)}else response=self.$connect(API,"_LIST_PENDING",{}),response.then(success,fail)})},self.$deleteInvitation=function(data,success,fail){var response,API,_self=this;_self.name="$deleteInvitation",fail||(fail=function(e){e.$getInvitationsPending="INVITATIONS",self.$responseError({},function(){self.$deleteInvitation(data,success,fail)},e)}),API=angular.copy(APPLICATION_MODULE.API.INVITATIONS),API._DELETE.url=API._DELETE.url.replace("{{workspaceId}}",data.workspaceId).replace("{{invitationId}}",data.invitationId),self.debug(_self.name).then(function(debug){if(debug){var mockResponse=self.mock("invitations","");mockResponse.then(success,fail)}else response=self.$connect(API,"_DELETE",{}),response.then(success,fail)})},self.newUser=function(newUserData){var ntObject,response={},_self=this;_self.name="newUser",self.debug(_self.name).then(function(debug){debug?$rootScope.$emit($app.$events().newUser.success,$app.$mock("newUser")):(ntObject=new ConnectionObject($app.$service("newUser"),"POST",newUserData),response=self.connect(ntObject),response.then(function(data){$data.newUser(data),$rootScope.$emit($app.$events().newUser.success,newUserData)},function(message){$rootScope.$emit($app.$events().newUser.fail,message)}))})},self.getFileManagerPage=function(page,callback){var response,ntObject;self.debug().then(function(debug){debug?callback($app.$mock("getFileManagerPage")):(ntObject=new ConnectionObject($app.$service("getFileManagerPage").replace("{{id}}",$data.$selectedWorkspace().id)+"?pageNumber="+page,"GET",!0),response=self.connect(ntObject),response.then(function(dataDeleted){$rootScope.fileDeleted=dataDeleted,callback(dataDeleted)},function(result){self.responseError(function(){self.getFileManagerPage(page,callback)},result)}))})},self.mock=function(key,path){var deferred=$q.defer(),resource="";return resource=path?path+"app/mocks/"+key+".mock.json":"app/mocks/"+key+".mock.json",$.getJSON(resource).done(function(script){deferred.resolve(script)}).fail(function(jqxhr,settings,exception){$rootScope.$emit(APPLICATION_MODULE.EVENTS._ERROR,exception),deferred.reject(exception)}),deferred.promise},self.debug=function(name){var deferred=$q.defer(),nameDebug=name?name:"";return APPLICATION_MODULE.DEBUG||self.findServicesOnDebug(nameDebug)?deferred.resolve(!0):deferred.resolve(!1),deferred.promise},self.fail=function(message,status){void 0===message&&(message="The message is not defined yet!!"),$rootScope.$emit(APPLICATION_MODULE.EVENTS._FAIL,message),$rootScope.$emit(APPLICATION_MODULE.EVENTS._ERROR,message),401===status&&self.$logout()},self.logout=function(message){$rootScope.$emit(APPLICATION_MODULE.EVENTS._LOGOUT,message)},self.findServicesOnDebug=function(val){for(var debugServices=APPLICATION_MODULE.SERVICES.DEBUG,rValue=!1,i=0,l=debugServices.length;l>i;i++)debugServices[i]===val&&(rValue=!0);return rValue},self.validateStateForComments=function(){var commentsState;return $data.$validateState("CloudIn.workspaces.diagrams")?commentsState=new CommentState($data.$selectedWorkspace().id,null,null,!0,null,!1,"commentsWorkspace"):$data.$validateState("CloudIn.workspaces.processviewer")?(commentsState=new CommentState($data.$selectedWorkspace().id,$data.$selectedDiagram().id,null,!1,!0,!1,"commentsProcess"),$data.$selectedShape()&&(commentsState=new CommentState($data.$selectedWorkspace().id,$data.$selectedDiagram().id,$data.$selectedShape().id,!1,!1,!0,"commentsShape"))):(commentsState=new CommentState(null,null,null,!1,!1,!1,""),commentsState.isWorkspaceList=!0),commentsState},self.updateFile=function(){self.debug().then(function(debug){debug&&callback($app.$mock("updateFile"))})}}),angular.module("addOnsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("addOnsModule").constant("ADD_ONS_MODULE",{EVENTS:{_ERROR:"ERROR"},MODULES:[{template:"app/modules/alertModule/",controller:""}]}),angular.module("addOnsModule").controller("AddOnsController",function($scope,ADD_ONS_MODULE){$scope.modules=ADD_ONS_MODULE.MODULES}),angular.module("oauthModule",["ngCookies"]),angular.module("oauthModule").constant("OAUTH_MODULE",{API:{DISCOVERY_SERVICE:{_PARENT:"",_SERVICES:{url:"services.json",method:"GET",data:{}},_TOKEN:{url:"core/connect/token",method:"POST",data:{},headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"{{clientId}}"}}}},MODELER:{EXTERNAL:{LOGIN:"authentication"}},APPLICATION:{SESSION_STORAGE:{KEY:""},MODELER:{CLOUD:"modelercloud.bizagi.com",BIZAGI:"modeler.bizagi.com"},OAUTH_AUTHORIZE_SERVICE_URL:"core/connect/authorize",OAUTH_TOKEN_SERVICE_URL:"core/connect/token",SCOPE:"openid email offline_access",AUTHORIZATION:{MODELER:"Basic bW9kZWxlci5iaXphZ2kuY29tOmh0TXFJeHhXcER2QWJ4SEkxQlI0MGlBdm45eWJ4VkhaQWx4SDM2ZkNiS0U2dVJtWmVRenFuOUVwSmtVSTVxMDNiYnNqZHp2c1E1VE9DSzlVZzdRN3laMm5NUg==",WEB:"Basic bW9kZWxlcmNsb3VkLmJpemFnaS5jb206eXpRampzcEdIem5IOUVkUzBPaDF2VnBFY281S21BSVZlQzlMN2VRZnFEa0tXUXZiaTFaa3B1bjgybjFoWnlVOU13V3ZkNTdHdEl0SFQ1OERqcVhUeG00WGJU"}}}),angular.module("oauthModule").service("oauthServices",function($rootScope,$http,$q,$location,OAUTH_MODULE){var self=this;self.$connect=function(api,service,data){var deferred=$q.defer(),apiLocal={url:api._PARENT+api[service].url,method:api[service].method,data:data};return api[service].hasOwnProperty("headers")&&(apiLocal.headers=api[service].headers),data&&data.url&&(apiLocal.url=data.url),"POST"===apiLocal.method&&(apiLocal.data=data.post),$http(apiLocal).success(function(data){deferred.resolve(data)}).error(function(data,status){var result={data:data,status:status};deferred.reject(result)}),deferred.promise},self.$callWindowExternal=function(key,p1,p2){var returned="";try{return returned=p1&&!p2?window.external[key](p1):p1&&p2?window.external[key](p1,p2):window.external[key]()}catch(e){return returned}},self.$queryString=function(){var qs=$location.search();if(0===Object.size($location.search())){for(var query_string={},query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("="),pair1=pair[1];try{pair1=eval(pair[1])}catch(e){}if("undefined"==typeof query_string[pair[0]])query_string[pair[0]]=pair1;else if("string"==typeof query_string[pair[0]]){var arr=[query_string[pair[0]],pair1];query_string[pair[0]]=arr}else query_string[pair[0]].push(pair1)}qs=query_string}return qs},self.$isIE9Version=function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE 9");return msie>0},self.$discoveryServices=function(data,success,fail){response=self.$connect(OAUTH_MODULE.API.DISCOVERY_SERVICE,"_SERVICES"),response.then(success,fail)},self.$token=function(data,success,fail){var API=angular.copy(OAUTH_MODULE.API.DISCOVERY_SERVICE);API._TOKEN.headers.Authorization=API._TOKEN.headers.Authorization.replace("{{clientId}}",data.client_id),response=self.$connect(API,"_TOKEN",data),response.then(success,fail)}}),angular.module("oauthModule").controller("OAuthController",function($scope,$location,oauthServices,OAUTH_MODULE,$http){$scope.setDefaults=function(){$scope.tokenUrl="",$scope.urlHost=window.location.protocol+"//"+window.location.host,$scope.queryString=$location.search(),$scope.isFromModeler=!1,$scope.scope="",$scope.clientId="",$scope.authorizationclientId="",$scope.accountUrl="",$scope.authorizationUrl="",$scope.client_id=""},oauthServices.$discoveryServices({},function(dataDiscovery){$scope.tokenUrl=dataDiscovery.collaborationService,$scope.accountUrl=dataDiscovery.membershipService,$scope.urlHost=window.location.protocol+"//"+window.location.host,$scope.queryString=oauthServices.$queryString(),$scope.isFromModeler=$scope.queryString&&$scope.queryString.hasOwnProperty("isModeler")?$scope.queryString.isModeler:!1,$scope.scope=OAUTH_MODULE.APPLICATION.SCOPE,$scope.authorizationclientId=$scope.isFromModeler?OAUTH_MODULE.APPLICATION.AUTHORIZATION.MODELER:OAUTH_MODULE.APPLICATION.AUTHORIZATION.WEB,$scope.clientId=$scope.isFromModeler?OAUTH_MODULE.APPLICATION.MODELER.BIZAGI:OAUTH_MODULE.APPLICATION.MODELER.CLOUD,$scope.queryString&&docCookies.setItem("qs",JSON.stringify($scope.queryString)),$scope.queryString.code||$scope.authorization(dataDiscovery),$scope.queryString.lang?docCookies.setItem("lang",$scope.queryString.lang,void 0,"/",".bizagi.com"):$scope.queryString.code&&""!==$scope.queryString.code&&($scope.queryString.hasOwnProperty("prd")&&docCookies.setItem("prd","std"),$scope.queryString.hasOwnProperty("version")&&docCookies.setItem("version",$scope.queryString.version),$scope.queryString.hasOwnProperty("guid")&&docCookies.setItem("guid",$scope.queryString.guid),$scope.loadToken())}),$scope.authorization=function(dataDiscovery){$scope.authorizationUrl=dataDiscovery.membershipService+OAUTH_MODULE.APPLICATION.OAUTH_AUTHORIZE_SERVICE_URL;var isFromModeler=$scope.isFromModeler?"true":"false",promptLogin=$scope.isFromModeler?"prompt=login&":"",redirect_uri=$scope.urlHost+"/oauth.html?isModeler="+isFromModeler,response_type="code",userEmail="";$scope.isFromModeler&&(userEmail=""),window.location=$scope.authorizationUrl+"?"+promptLogin+"client_id="+encodeURI($scope.clientId)+"&redirect_uri="+encodeURI(redirect_uri)+"&response_type="+encodeURI(response_type)+"&login_hint="+encodeURI(userEmail)+"&scope="+encodeURI($scope.scope)+"&"},$scope.loadToken=function(){var dataPost,isFromModeler=$scope.isFromModeler?"true":"false";oauthServices.$isIE9Version()?(dataPost={grant_type:"authorization_code",code:$scope.queryString.code,redirect_uri:$scope.urlHost+"/oauth.html?isModeler="+isFromModeler,scope:$scope.scope,url:$scope.accountUrl,clientId:$scope.authorizationclientId},$http.post($scope.tokenUrl+"api/token",dataPost).success(function(responseToken){$scope.redirectToCollaboration(responseToken)}).error(function(){})):(dataPost={grant_type:"authorization_code",code:$scope.queryString.code,redirect_uri:$scope.urlHost+"/oauth.html?isModeler="+isFromModeler,scope:$scope.scope},$http.post($scope.accountUrl+OAUTH_MODULE.APPLICATION.OAUTH_TOKEN_SERVICE_URL,$.param(dataPost),{transformRequest:angular.identity,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:$scope.authorizationclientId}}).success(function(responseToken){$scope.redirectToCollaboration(responseToken)}).error(function(){}))},$scope.redirectToCollaboration=function(responseToken){if(sStorage.remove("lg"),sStorage.save("lg",responseToken,!0),$scope.isFromModeler){var version=docCookies.getItem("version");if(version&&null!==version&&void 0!==version&&"cloud"===version){var ul=docCookies.getItem("ul"),guid=docCookies.getItem("guid");ul&&guid&&$http.post("http://www.bizagi.com/smtool/modeler/services/ModelerRegister.svc/Register/?guid="+guid+"&usrnm="+ul,null).success(function(response){}).error(function(e){}),window.external.SignInCompleted(ul)}var loginDataStr=JSON.stringify(responseToken);oauthServices.$callWindowExternal(OAUTH_MODULE.MODELER.EXTERNAL.LOGIN,loginDataStr)}else{var previousPage=sStorage.load("pp");previousPage?window.location=sStorage.load("pp"):window.location=$scope.urlHost+"/index.html"}},$scope.setDefaults()}),angular.module("searchModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("searchModule").constant("SEARCH_MODULE",{EVENTS:{_READY:"SEARCH_MODULE._READY",_UPDATE:"SEARCH_MODULE._UPDATE",_SAVE:"SEARCH_MODULE._SAVE",_ERROR:"ERROR",_FAIL:"FAIL"}}),angular.module("searchModule").controller("SearchController",function($scope,$rootScope,$state,SEARCH_MODULE){$scope.setDefaults=function(){$scope.showSearch=!1,$scope.showSearchIcon=!0,$scope.search={},$scope.options={name:"Search",img:"search",state:"secondary",type:"icon"},$scope.label={search:"Search",placeholder:"Search Bizagi Cloud"}},$scope.openSearch=function(){$scope.showSearch=!0,$scope.showSearchIcon=!1},$scope.closeSearch=function(){$scope.showSearch=!1,$scope.showSearchIcon=!0},$scope.searchQuery=function(){""!==$scope.search.query&&$scope.search.query!==$scope.search.oldQuery&&($scope.showSearch=!1,$scope.showSearchIcon=!0,$scope.search.oldQuery=$scope.search.query,$rootScope.$emit(SEARCH_MODULE.EVENTS._SAVE,$scope.search.query))},$scope.update=function(){},$scope.setDefaults(),$rootScope.$on(SEARCH_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(SEARCH_MODULE.EVENTS._READY)}).directive("focusOnVisibility",function($timeout){return function(scope,element){scope.$watch("showSearch",function(){scope.showSearch===!0&&$timeout(function(){element.focus()},10)})}}),angular.module("loadingModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("loadingModule").constant("LOADING_MODULE",{EVENTS:{_READY:"LOADING_MODULE._READY",_HIDE:"LOADING_MODULE._HIDE",_SHOW:"LOADING_MODULE._SHOW",_ERROR:"ERROR"},TEMPLATE:{LOADING:"views/loading.module.view.html"},RESOURCES:{IMAGES:{PLACEHOLDER:"app/img/loader.gif"}}}),angular.module("loadingModule").controller("LoadingController",function($scope,$rootScope,$timeout,LOADING_MODULE,gettextCatalog){$scope.visible=!1,$scope.message="",$scope.loadingImage=LOADING_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.show=function(event,data){$scope.visible=!0,data.hasOwnProperty("concat")?$scope.message=gettextCatalog.getString(data.message)+data.concat:$scope.message=gettextCatalog.getString(data.message),
data.hasOwnProperty("delay")&&$timeout(function(){$scope.hide(event)},data.delay)},$scope.hide=function(){$scope.visible=!1,$scope.message=""},$rootScope.$on(LOADING_MODULE.EVENTS._SHOW,$scope.show),$rootScope.$on(LOADING_MODULE.EVENTS._HIDE,$scope.hide)}),angular.module("userMenuModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("userMenuModule").constant("USER_MENU_MODULE",{TEMPLATES:{MENU:"views/user.menu.module.view.html",SEARCH:"views/search.module.view.html"},RESOURCES:{IMAGES:{PLACEHOLDER:"app/img/bizagi-placeholder-avatar.png"}},EVENTS:{_READY:"USER_MENU_MODULE._READY",_UPDATE:"USER_MENU_MODULE._UPDATE",_SUCCESS:"USER_MENU_MODULE._SUCCESS",_ERROR:"ERROR",_ACTION:"USER_MENU_MODULE._ACTION",_EXECUTE:"EXECUTE"},CSS:{ACTIVE:"bz-cd-active"},ACTIONS:{SHOW_OPTIONS:"USER_MENU_MODULE.SHOW.OPTIONS",SHOW_SEARCH:"USER_MENU_MODULE.SHOW.SEARCH",SHOW_UPGRADE:"USER_MENU_MODULE.SHOW.UPGRADE",SHOW_COLLABORATORS:"USER_MENU_MODULE.SHOW.COLLABORATORS",SHOW_BILLING:"USER_MENU_MODULE.SHOW.BILLING",INFORMATION_MODELER:"USER_MENU_MODULE.INFORMATION.MODELER",SUPPORT_MODELER:"USER_MENU_MODULE.INFORMATION.SUPPORT",DOWNLOAD_MODELER:"USER_MENU_MODULE.DOWNLOAD.MODELER",LOGOUT:"USER_MENU_MODULE.LOGOUT"},USER_OPTIONS:[{name:gettext("Plan Management"),url:"USER_MENU_MODULE.SHOW.UPGRADE",img:"upgrade",state:"secondary",type:"icon",access:["Personal","Trial","Full"],device:["Desktop"]},{name:gettext("Plan and Billing"),url:"USER_MENU_MODULE.SHOW.BILLING",img:"coin",state:"secondary",type:"icon",access:["Trial","Full"],device:["Desktop"]},{name:gettext("Collaborators"),url:"USER_MENU_MODULE.SHOW.COLLABORATORS",img:"team",state:"secondary",type:"icon",access:["Trial","Full"],device:["Desktop"]}],OPTIONS:[{name:gettext("Download Bizagi Modeler"),url:"USER_MENU_MODULE.DOWNLOAD.MODELER",img:"modeler-download",state:"secondary",type:"icon",responsive:"hidden-xs hidden-sm",device:["Desktop","Mobile"]},{name:gettext("Help"),url:"USER_MENU_MODULE.INFORMATION.MODELER",img:"modeler-help",state:"secondary",type:"icon",responsive:"hidden-xs",device:["Desktop","Mobile"]},{name:gettext("Support"),url:"USER_MENU_MODULE.INFORMATION.SUPPORT",img:"modeler-support",state:"secondary",type:"icon",responsive:"hidden-xs",device:["Desktop","Mobile"]},{name:gettext("Sign Out"),url:"USER_MENU_MODULE.LOGOUT",img:"log-out",state:"secondary",type:"icon",device:["Desktop","Mobile"]}],USER_MENU:{url:"USER_MENU_MODULE.SHOW.OPTIONS"}}),angular.module("userMenuModule").controller("UserMenuController",function($scope,$rootScope,$data,USER_MENU_MODULE,APP){$scope.setDefaults=function(){$scope.template=USER_MENU_MODULE.TEMPLATES.MENU,$scope.searchTemplate=USER_MENU_MODULE.TEMPLATES.SEARCH,$scope.options=USER_MENU_MODULE.OPTIONS,$scope.userMenu=USER_MENU_MODULE.USER_MENU.url,$scope.userAvatar=USER_MENU_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.accountUrl=APP.APPLICATION_MODULE.API.PATH.membershipService,$scope.isMobile=$data.$isMobile()},$scope.execute=function(event,obj){angular.extend(obj,{from:"userMenuModule"}),$rootScope.$emit(USER_MENU_MODULE.EVENTS._EXECUTE,obj)},$scope.update=function(event,data){$scope.userProfile=data,$scope.userProfile.fullName=$scope.userProfile.fullName||($scope.userProfile.firstName||"")+" "+($scope.userProfile.lastName||""),$scope.fullName=$scope.userProfile.fullName,$scope.userName=$scope.userProfile.userName,$scope.userOptions=$data.$validateAccess(USER_MENU_MODULE.USER_OPTIONS),$scope.userAvatar=USER_MENU_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.email=$scope.userProfile.email,data.options&&data.actions&&($scope.options=$data.$validateAccess(data.options),$scope.actions=$data.$validateAccess(data.actions)),$rootScope.$emit(APP.EVENTS._GET_APP_QUOTA)},$scope.toggled=function(open){open===!0&&$rootScope.$emit(APP.EVENTS._GET_APP_QUOTA)},$scope.activeIcon=function(event){$(event.currentTarget).toggleClass(USER_MENU_MODULE.CSS.ACTIVE)},$rootScope.$off(USER_MENU_MODULE.EVENTS._UPDATE),$rootScope.$on(USER_MENU_MODULE.EVENTS._UPDATE,$scope.update),$scope.ready=function(){$rootScope.$emit(USER_MENU_MODULE.EVENTS._READY)},$scope.setDefaults()}),angular.module("alertModule",["ui.router","ui.bootstrap","applicationModule","ngAnimate"]),angular.module("alertModule").constant("ALERT_MODULE",{EVENTS:{_ERROR:"ERROR",_CONFIRM:"CONFIRM",_WARNING:"WARNING",_NOTIFICATION:"NOTIFICATION",_NOTIFICATION_WITHOUT_TRANSLATE:"_NOTIFICATION_WITHOUT_TRANSLATE"},TEMPLATES:{BASE:"views/alert.module.view.html"}}),angular.module("alertModule").controller("AlertController",function($scope,$rootScope,$timeout,ALERT_MODULE,gettextCatalog){$rootScope.$on(ALERT_MODULE.EVENTS._CONFIRM,function(e,message,done,cancel,primaryMessage,defaultMessage){$scope.type="success",$scope.alert(gettextCatalog.getString(message),done,cancel,primaryMessage||"YES",defaultMessage||"NO")}),$rootScope.$on(ALERT_MODULE.EVENTS._ERROR,function(e,message,done,primaryMessage){$scope.type="error",$scope.alert(gettextCatalog.getString(message),done,void 0,primaryMessage||"OK",void 0)}),$rootScope.$on(ALERT_MODULE.EVENTS._WARNING,function(e,message,done,primaryMessage,btn){$scope.type="warning",$scope.showSkipBtn=btn.showSkipBtn||!1,$scope.alert(gettextCatalog.getString(message),done,void 0,primaryMessage||"OK",void 0,btn)}),$rootScope.$on(ALERT_MODULE.EVENTS._NOTIFICATION,function(e,message,done,delay){var dataDelay=delay||$scope.delay;$scope.type="notification",$scope.alert(gettextCatalog.getString(message),done,void 0),$timeout(function(){$scope.visibleAlert=!1},dataDelay)}),$rootScope.$on(ALERT_MODULE.EVENTS._NOTIFICATION_WITHOUT_TRANSLATE,function(e,message,done,delay){var dataDelay=delay||$scope.delay;$scope.type="notification",$scope.alert(message,done,void 0),$timeout(function(){$scope.visibleAlert=!1},dataDelay)}),$scope.setDefaults=function(){$scope.visibleAlert=!1,$scope.message="",$scope.done=function(){},$scope.cancel=function(){},$scope.delay=5e3,$scope.template=ALERT_MODULE.TEMPLATES.BASE,$scope.closeButton={name:gettext("Cancel"),visibleAlert:!1}},$scope.setVisibleAlert=function(visible,eDone){$scope.visibleAlert=visible,$scope.close(eDone)},$scope.alert=function(message,done,cancel,primaryMessage,defaultMessage,btn){if($scope.visibleAlert=!0,$scope.btn=btn,"object"==typeof message)for(var property in message)$scope[property]=message[property];else $scope.message=message||"The message is not defined yet!!",$scope.primaryMessage=primaryMessage,$scope.defaultMessage=defaultMessage,done&&($scope.done=done),cancel&&($scope.cancel=cancel)},$scope.close=function(response){var done=$scope.done,cancel=$scope.cancel;$scope.setDefaults(),response?done():cancel()},$scope.noShowPopupAgain=function(noShowAgain){if(noShowAgain){var date=new Date;docCookies.setItem("do_not_show_again_ME",noShowAgain,date.getTime()+31536e4)}else docCookies.getItem("do_not_show_again_ME")&&docCookies.removeItem("do_not_show_again_ME")},$scope.setDefaults()}),angular.module("slideContentModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("slideContentModule").constant("SLIDE_CONTENT_MODULE",{NAME:"Slide Content Module",TEMPLATES:{BASE:"views/slide.content.module.view.html",EMPTY:"views/slide.content.module.empty.view.html",HEADER:"views/slide.content.module.header.view.html"},EVENTS:{_READY:"SLIDE_CONTENT_MODULE._READY",_UPDATE:"SLIDE_CONTENT_MODULE._UPDATE",_OPEN:"SLIDE_CONTENT_MODULE._OPEN",_CLOSE:"SLIDE_CONTENT_MODULE._CLOSE",_CLOSED:"SLIDE_CONTENT_MODULE._CLOSED",_HEADER_ACTION:"SLIDE_CONTENT_MODULE._HEADER_ACTION",_ERROR:"ERROR"}}),angular.module("slideContentModule").directive("slideHeaderDirective",function(SLIDE_CONTENT_MODULE){return{templateUrl:SLIDE_CONTENT_MODULE.TEMPLATES.HEADER}}),angular.module("slideContentModule").directive("slideHeightDirective",function(){return{controller:function($window,$scope,$rootScope,APP,SLIDE_CONTENT_MODULE,$element){$rootScope.$off(SLIDE_CONTENT_MODULE.EVENTS._READY),$rootScope.$on(SLIDE_CONTENT_MODULE.EVENTS._READY,function(){var pageHeight=$window.innerHeight,headerHeight=$element.find(".bz-cd-slide-header").outerHeight(),contentHeight=pageHeight-headerHeight,pageWidth=$window.innerWidth,wrapperScroll=$element.find(".wrapper-scroll");if(pageWidth>=768){if(angular.element(".bz-cd-slide-wrapper").css({height:"auto",overflow:"inherit"}),$element.find(".bz-cd-slide-content").css({"max-height":contentHeight+"px"}),wrapperScroll.length){setTimeout(function(){wrapperScroll.css({"max-height":contentHeight-60+"px",overflow:"auto"});var result=wrapperScroll.hasScrollBar();result||$rootScope.$emit(APP.NOTIFICATIONS_MODULE.EVENTS._GET_PAGE)},500)}}else if(angular.element(".bz-cd-slide-wrapper").css({height:pageHeight,overflow:"scroll"}),wrapperScroll.length){setTimeout(function(){wrapperScroll.css({"max-height":pageHeight-60+"px",overflow:"auto"});var result=wrapperScroll.hasScrollBar();result||$rootScope.$emit(APP.NOTIFICATIONS_MODULE.EVENTS._GET_PAGE)},500)}})}}}),angular.module("slideContentModule").controller("SlideContentController",function($scope,$rootScope,SLIDE_CONTENT_MODULE){$scope.setDefaults=function(){$scope.name=SLIDE_CONTENT_MODULE.NAME,$scope.header="",$scope.visibility=!1,$scope.side="centered",$scope.modal=!1},$scope.$off=function(name){return $scope.$$listeners[name]=[],$scope},$scope.update=function(event,data){angular.extend($scope,data),$rootScope.$emit(SLIDE_CONTENT_MODULE.EVENTS._OPEN)},$scope.updateTab=function(event,data){$scope.name=data.title},$scope.ready=function(){$scope.$off("$includeContentLoaded"),$scope.$on("$includeContentLoaded",function(){$rootScope.$emit(SLIDE_CONTENT_MODULE.EVENTS._READY)})},$scope.open=function(){$scope.visibility=!0,$scope.ready()},$scope.close=function(){$scope.visibility=!1,$scope.modal=!1,$scope.empty(),$rootScope.$emit(SLIDE_CONTENT_MODULE.EVENTS._CLOSED)},$scope.empty=function(){$scope.module=SLIDE_CONTENT_MODULE.TEMPLATES.EMPTY},$scope.triggerEvents=function(ev,data){$(ev.target).closest("div.bz-cd-slide-header-path").next().remove(),$rootScope.$emit($app.$events().slideContent.headerAction,data)},$rootScope.$off(SLIDE_CONTENT_MODULE.EVENTS._UPDATE),$rootScope.$off(SLIDE_CONTENT_MODULE.EVENTS._OPEN),$rootScope.$off(SLIDE_CONTENT_MODULE.EVENTS._CLOSE),$rootScope.$on(SLIDE_CONTENT_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(SLIDE_CONTENT_MODULE.EVENTS._OPEN,$scope.open),$rootScope.$on(SLIDE_CONTENT_MODULE.EVENTS._CLOSE,$scope.close),$scope.setDefaults()}),angular.module("asideModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("asideModule").constant("ASIDE_MODULE",{NAME:"Aside Module",TEMPLATES:{BASE:"views/aside.module.view.html",EMPTY:"views/aside.module.empty.view.html"},EVENTS:{_UPDATE:"ASIDE_MODULE._UPDATE",_READY:"ASIDE_MODULE._READY",DIRECTIVE:{_READY:"ASIDE_MODULE.DIRECTIVE._READY"}}}),angular.module("asideModule").directive("asideHeightDirective",function(){return{controller:function($window,$scope,$rootScope,ASIDE_MODULE,$element){$scope.getDimentions=function(){var pageHeight=$window.innerHeight,headerHeight=angular.element(".bz-cd-inner-header").outerHeight(),contentHeight=pageHeight-headerHeight,elementScroll=$element.find(".aside-scroll"),pageWidth=$window.innerWidth;768>=pageWidth?($element.parent().css("height",pageHeight),_.each(elementScroll,function(){var asidePosition=elementScroll.position().top;elementScroll.css({height:pageHeight-asidePosition-15,overflowY:"auto",overflowX:"hidden"})})):($element.parent().css("height",contentHeight),_.each(elementScroll,function(item){var $item=angular.element(item),asidePosition=$item.position().top;$item.css({height:contentHeight-asidePosition-15,overflowY:"auto",overflowX:"hidden"})}))},angular.element($window).bind("resize",function(){$scope.getDimentions()}),$rootScope.$off(ASIDE_MODULE.EVENTS.DIRECTIVE._READY),$rootScope.$on(ASIDE_MODULE.EVENTS.DIRECTIVE._READY,$scope.getDimentions)}}}),angular.module("asideModule").controller("AsideController",function($window,$data,$scope,$rootScope,ASIDE_MODULE,$timeout){$scope.$setDefaults=function(){$scope.name=ASIDE_MODULE.NAME,$scope.header="",$scope.visibility=!1,$scope.tabs=[],$scope.firstTabAllwaysActive=!1},$scope.$open=function(){if($scope.visibility=!0,$rootScope.$emit("changeLayout",{open:!0}),$scope.module=ASIDE_MODULE.TEMPLATES.BASE,$scope.firstTabAllwaysActive)for(var i=0,le=$scope.tabs.length;le>i;i++)0===i?$scope.tabs[i].active=!0:$scope.tabs[i].active=!1},$scope.$update=function(event,data){angular.extend($scope,data),data&&data.open&&$scope.$open(),data&&data.close&&$scope.$close(),data&&data.empty&&$scope.$empty()},$scope.$close=function(){$scope.visibility=!1,$scope.$empty(),$rootScope.$emit("changeLayout")},$scope.$empty=function(){$scope.visibility=!1,$scope.module=ASIDE_MODULE.TEMPLATES.EMPTY,$scope.$$phase||$scope.$apply()},$scope.validateAccess=function(tab){return $data.$validateAccess(tab)},$scope.changeTab=function(tab){$timeout(function(){$rootScope.$emit(ASIDE_MODULE.EVENTS.DIRECTIVE._READY)},100)},$rootScope.$off(ASIDE_MODULE.EVENTS._UPDATE),$rootScope.$on(ASIDE_MODULE.EVENTS._UPDATE,$scope.$update),$scope.$setDefaults()}),angular.module("modalContentModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("modalContentModule").constant("MODAL_CONTENT_MODULE",{EVENTS:{_UPDATE:"MODAL_CONTENT_MODULE._UPDATE",_OPEN:"MODAL_CONTENT_MODULE._OPEN",_CLOSE:"MODAL_CONTENT_MODULE._CLOSE",_EXECUTE:"EXECUTE"},TEMPLATES:{BASE:"views/modal.content.module.view.html",EMPTY:"views/modal.content.module.empty.view.html"},RESOURCES:{LOGO:"app/img/bizagi-logo-white.png"}}),angular.module("modalContentModule").controller("ModalContentController",function($scope,$rootScope,MODAL_CONTENT_MODULE,$data,APP){$scope.setDefaults=function(){$scope.name="Slide Content Module",$scope.visibility=!1,$scope.template=MODAL_CONTENT_MODULE.TEMPLATES.BASE,$scope.actions=[],$scope.data={},$scope.layout="modal-default",$scope.footerVisibility=!0},$scope.update=function(event,data){angular.extend($scope,data),$rootScope.$emit(MODAL_CONTENT_MODULE.EVENTS._OPEN)},$scope.open=function(){$scope.visibility=!0},$scope.close=function(){$scope.visibility=!1,$scope.module=MODAL_CONTENT_MODULE.TEMPLATES.EMPTY},$scope.execute=function(event,_exe){angular.extend(_exe,$scope.data),_exe.hasOwnProperty("action")?$rootScope.$emit(_exe.action,_exe):_exe.hasOwnProperty("page")&&$rootScope.$emit("EXECUTE",_exe)},$rootScope.$on(MODAL_CONTENT_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(MODAL_CONTENT_MODULE.EVENTS._OPEN,$scope.open),$rootScope.$on(MODAL_CONTENT_MODULE.EVENTS._CLOSE,$scope.close),$scope.setDefaults()}),angular.module("modalContentModule").directive("focusMe",function($timeout,$parse){return{link:function(scope,element,attrs){var model=$parse(attrs.focusMe);scope.$watch(model,function(value){value===!0&&$timeout(function(){element[0].focus()})}),element.bind("blur",function(){scope.$apply(model.assign(scope,!1))})}}}),angular.module("endPointsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("endPointsModule").controller("EndPointsController",function($scope,$rootScope,$state,applicationServices,$data){$scope.getEndPoints=function(){$rootScope.$emit($data.getEvent().loading,{message:"Loading End Points"}),applicationServices.endPoints({},function(status,data){1===status?($scope.endpoints=data,$rootScope.$emit($data.getEvent().loaded)):$rootScope.$emit($data.getEvent().error,data)})},$scope.getEndPoints()}),angular.module("fileManagerModule",["ui.router","ui.bootstrap","applicationModule"]).filter("bytes",function(){return function(bytes,precision){if(isNaN(parseFloat(bytes))||!isFinite(bytes))return"-";"undefined"==typeof precision&&(precision=1);var units=["bytes","KB","MB","GB","TB","PB"],number=Math.floor(Math.log(bytes)/Math.log(1024));return(bytes/Math.pow(1024,Math.floor(number))).toFixed(precision)+" "+units[number]}}),angular.module("fileManagerModule").constant("FILE_MANAGER_MODULE",{EVENTS:{_ERROR:"ERROR",_READY:"FILE_MANAGER_MODULE._READY",_DELETE:"FILE_MANAGER_MODULE._DELETE",_UPDATE:"FILE_MANAGER_MODULE._UPDATE",_UPLOAD_UPDATE:"FILE_MANAGER_MODULE._UPLOAD_UPDATE",_FILE_UPLOAD_CHANGE:"FILE_MANAGER_MODULE._FILE_UPLOAD_CHANGE",_HAS_PRESELECTED_FILE:"FILE_MANAGER_MODULE._HAS_PRESELECTED_FILE",_UPDATE_FILE_NAME:"FILE_MANAGER_MODULE._UPDATE_FILE_NAME",_UPDATED_FILE_NAME:"FILE_MANAGER_MODULE._UPDATED_FILE_NAME",_GET_PAGE:"FILE_MANAGER_MODULE._GET_PAGE",_SEARCH_FILES:"FILE_MANAGER_MODULE._SEARCH_FILES",_DOWNLOAD:"FILE_MANAGER_MODULE._DOWNLOAD",_LINK_FILE:"FILE_MANAGER_MODULE._LINK_FILE",_EDIT_FILE_NAME_OK:"FILE_MANAGER_MODULE._EDIT_FILE_NAME_OK"},TEMPLATES:{EDIT_FILE_DIRECTIVE:"views/file.edit.file.name.tmpl.html",SEARCH_FILES_DIRECTIVE:"views/file.search.tmpl.html"}}),angular.module("fileManagerModule").controller("FileManagerController",function(paginationConfig,gettextCatalog,$scope,$rootScope,$location,$data,FILE_MANAGER_MODULE,applicationServices){$scope.setDefaults=function(){$scope.pageTitle="",$scope.files=[],$scope.toUpload=[],$scope.quotaPercent=0,$scope.notSaved=[],$scope.actualPage=1,$scope.totalPages=1,$scope.maxSizes=5,$scope.itemsPerPage=5,$scope.totalRecords=0,$scope.preselectedFile=!1,$scope.linkedOption=!1,$scope.preselected=!1,$scope.sizeUnit="MB",$scope.pagerVisible=$scope.files.length?!0:!1,$location.search().linkedFiles&&($scope.linkedOption=!0),$scope.setPaginationConfig()},$scope.setPaginationConfig=function(){var res=gettext("First"),translatedText=gettextCatalog.getString(res);paginationConfig.firstText=translatedText,res=gettext("Previous"),translatedText=gettextCatalog.getString(res),paginationConfig.previousText=translatedText,res=gettext("Next"),translatedText=gettextCatalog.getString(res),paginationConfig.nextText=translatedText,res=gettext("Last"),translatedText=gettextCatalog.getString(res),paginationConfig.lastText=translatedText},$scope.validateCharacters=function(e){$data.$validateSpecialCharacters(e)},$scope.edit=function(){$rootScope.$emit("editFileName.edit",!0)},$scope["delete"]=function(file,i){$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._DELETE,file.id),$scope.files.splice(i,1),$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._GET_PAGE,$scope.actualPage)},$scope.updateFileName=function(event,fileId,newName){$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._UPDATE_FILE_NAME,fileId,newName)},$scope.updatedFileName=function(event,fileId){$rootScope.$emit("editFileName.updated",fileId)},$scope.hasPreselectedFile=function(event,file){$scope.preselected=!0,$scope.preselectedFile=file},$scope.getPage=function(event,page){$scope.actualPage=page,$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._GET_PAGE,$scope.actualPage)},$scope.download=function(file){$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._DOWNLOAD,file)},$scope.link=function(file){$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._LINK_FILE,file)},$scope.update=function(event,data){data.hasOwnProperty("pageTitle")&&($scope.pageTitle=data.pageTitle),data.hasOwnProperty("files")&&($scope.files=data.files,$scope.totalPages=data.totalPages,$scope.totalRecords=data.totalRecords),data.hasOwnProperty("quotaByModel")&&($scope.quotaTotal=data.quotaByModel.quota,$scope.quotaUsed=data.quotaByModel.used,$scope.sizeUnit=data.quotaByModel.sizeUnit,$scope.quotaPercent=$scope.quotaUsed/$scope.quotaTotal*100),$scope.pagerVisible=$scope.files.length?!0:!1,angular.element(".progress-bar-success").css("width",$scope.quotaPercent+"%")},$scope.getDate=function(date){var res=gettext("Modified"),translatedText=gettextCatalog.getString(res);return translatedText+" "+moment(date).fromNow()},$scope.setDefaults(),$rootScope.$on(FILE_MANAGER_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(FILE_MANAGER_MODULE.EVENTS._UPDATED_FILE_NAME,$scope.updatedFileName),$rootScope.$on(FILE_MANAGER_MODULE.EVENTS._HAS_PRESELECTED_FILE,$scope.hasPreselectedFile),$rootScope.$on(FILE_MANAGER_MODULE.EVENTS._EDIT_FILE_NAME_OK,$scope.updateFileName),$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._READY,{itemsPerPage:$scope.itemsPerPage})}).filter("range",function(){return function(input,total){total=parseInt(total);for(var i=0;total>i;i++)input.push(i);return input}}),angular.module("fileManagerModule").directive("chooseFile",function($rootScope,FILE_MANAGER_MODULE){return{restrict:"A",link:function(scope,iElement){var inputFileVal="",inputFileFake=angular.element(".bz-cd-file-fake");iElement.on("change",function(){inputFileVal=iElement.val(),inputFileFake.val(inputFileVal),$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._FILE_UPLOAD_CHANGE,iElement),scope.actualPage=1,inputFileFake.val("")})}}}),angular.module("fileManagerModule").directive("editFileName",function($rootScope,FILE_MANAGER_MODULE,$data){return{restrict:"A",templateUrl:FILE_MANAGER_MODULE.TEMPLATES.EDIT_FILE_DIRECTIVE,controller:function($scope){$scope.visible="noEdit",$scope.edit=function(){$scope.visible="edit"},$scope.cancel=function(){$scope.visible="noEdit",$scope.$apply()},$scope.ok=function(event,fileId){$scope.visible="noEdit",$scope.file.id===fileId&&($scope.file.fileName=$scope.newName,$scope.file.lastModifiedDate=moment().utc().format(),$scope.file.lastModifiedBy.userName=$data.$userProfile().userName)},$rootScope.$on("editFileName.edit",$scope.edit),$rootScope.$on("editFileName.updated",$scope.ok)},link:function(scope,iElement){iElement.on("change keyup paste","input",function(){iElement.find(".bz-cd-edit-ok").removeClass("disabled")}),iElement.on("click",".bz-cd-edit-ok",function(){scope.oldName=iElement.find("input").data("old-name"),scope.newName=iElement.find("input").val(),scope.oldName!=scope.newName&&($rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._UPDATE_FILE_NAME,scope.file.id,scope.newName),scope.changed=!1)}),iElement.on("click",".bz-cd-edit-cancel",function(){scope.cancel()})}}}),angular.module("fileManagerModule").directive("scrollableFiles",["$timeout",function($timeout){return{restrict:"A",scope:{tableHeight:"@"},link:function($scope,$elem){$scope.$watch(function(){return $elem.find("tbody").is(":visible")},function(newValue){newValue===!0&&($elem.find("thead, tbody, tfoot").css("display",""),$timeout(function(){$elem.find("th").each(function(i,thElem){thElem=$(thElem);var tdElems=$elem.find("tbody tr:first td:nth-child("+(i+1)+")"),tfElems=$elem.find("tfoot tr:first td:nth-child("+(i+1)+")"),columnWidth=tdElems.width();thElem.width(columnWidth),tdElems.width(columnWidth),tfElems.width(columnWidth)}),$elem.find("thead, tfoot").css({display:"block"}),$elem.find("tbody").css({display:"block",height:$scope.tableHeight||"400px",overflow:"auto"});var scrollBarWidth=$elem.find("thead").width()-$elem.find("tbody")[0].clientWidth;scrollBarWidth>0&&(scrollBarWidth-=2,$elem.find("tbody tr:first td:last-child").each(function(i,elem){$(elem).width($(elem).width()-scrollBarWidth)}))}))})}}}]),angular.module("fileManagerModule").directive("searchFiles",function(FILE_MANAGER_MODULE){return{restrict:"A",scope:{ngModel:"="},templateUrl:FILE_MANAGER_MODULE.TEMPLATES.SEARCH_FILES_DIRECTIVE,controller:"FileManagerSearchController",link:function(scope,element){}}}),angular.module("fileManagerModule").controller("FileManagerSearchController",function($scope,$rootScope,FILE_MANAGER_MODULE){$scope.searchText="",$scope.search=function(){$rootScope.searchText=$scope.searchText,$rootScope.$emit(FILE_MANAGER_MODULE.EVENTS._SEARCH_FILES,$scope.searchText)},$scope.checkChange=function(){0==$scope.searchText.length&&$scope.search()},$scope.searchEnter=function(event){var code=event.which||event.keyCode;13===code&&$scope.search()}}),angular.module("tabsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("tabsModule").constant("TABS_MODULE",{TEMPLATES:{BASE:"views/tabs.module.view.html"},EVENTS:{_READY:"TABS_MODULE._READY",_UPDATE:"TABS_MODULE._UPDATE",_CHANGE:"TABS_MODULE._CHANGE",_ERROR:"ERROR",_FAIL:"FAIL"}}),angular.module("tabsModule").controller("TabsController",function($scope,$rootScope,TABS_MODULE,$data){$scope.setDefaults=function(){$scope.tabs=[]},$scope.changeTab=function(data){$rootScope.$emit(TABS_MODULE.EVENTS._CHANGE,data)},$scope.setTabs=function(event,data){angular.extend($scope,data)},$scope.validateAccess=function(action){var aValueAccess=!1,plan=$data.$subscription().subscriptionType;if(action&&plan){aValueAccess=!1;for(var i=0;i<action.access.length;i++)if(action.access[i].toLowerCase()===plan.toLowerCase()){aValueAccess=!0;break}}return aValueAccess},$scope.setDefaults(),$rootScope.$on(TABS_MODULE.EVENTS._UPDATE,$scope.setTabs),$rootScope.$emit(TABS_MODULE.EVENTS._READY)}),angular.module("memberModule",["ui.router","ui.bootstrap","applicationModule","ngTagsInput"]),angular.module("memberModule").constant("MEMBER_MODULE",{EVENTS:{_READY:"MEMBER_MODULE._READY",_UPDATE:"MEMBER_MODULE._UPDATE",_SEND:"MEMBER_MODULE._SEND",_ERROR:"ERROR",_FAIL:"FAIL",_LIST_MODULE:{_READY:"MEMBER_MODULE._LIST_MODULE._READY",_SAVE:"MEMBER_MODULE._LIST_MODULE._SAVE",_UPDATE:"MEMBER_MODULE._LIST_MODULE._UPDATE",_UPDATE_ROLE:"MEMBER_MODULE._LIST_MODULE._UPDATE_ROLE",_GET:"MEMBER_MODULE._LIST_MODULE._GET",_DELETE:"MEMBER_MODULE._LIST_MODULE._DELETE"},_INVITE_MODULE:{_READY:"MEMBER_MODULE._INVITE_MODULE._READY",_SAVE:"MEMBER_MODULE._INVITE_MODULE._SAVE",_SUCCESS:"MEMBER_MODULE._INVITE_MODULE._SUCCESS",_UPDATE:"MEMBER_MODULE._INVITE_MODULE._UPDATE"}},FILTERS:{roles:[{name:"Viewer",id:gettext("Viewer")},{name:"Designer",id:gettext("Designer")}],accesses:[{name:"Editor",id:gettext("Editor (full access)")},{name:"Contributor",id:gettext("Contributor (view and comment)")}]},INVITE_MEMBER:{TEMPLATES:{BASE:"views/member.invite.module.view.html",LIST_INVITATIONS:"views/invitations.list.module.view.html"},EVENTS:{_SAVE:"MEMBER_MODULE.INVITE_MEMBER._SAVE",_UPDATE:"MEMBER_MODULE.INVITE_MEMBER._UPDATE",_READY:"MEMBER_MODULE.INVITE_MEMBER._READY",_CANCEL:"MEMBER_MODULE.INVITE_MEMBER._CANCEL",_CHANGE_TAB:"MEMBER_MODULE.INVITE_MEMBER._CHANGE_TAB"}},LIST_MEMBER:{TEMPLATES:{BASE:"views/member.list.module.view.html"},EVENTS:{_SAVE:"MEMBER_MODULE.LIST_MEMBER._SAVE",_UPDATE:"MEMBER_MODULE.LIST_MEMBER._UPDATE",_READY:"MEMBER_MODULE.LIST_MEMBER._READY",_DELETE:"MEMBER_MODULE.LIST_MEMBER._DELETE",_CANCEL:"MEMBER_MODULE.LIST_MEMBER._CANCEL",_HIDE:"MEMBER_MODULE.LIST_MEMBER._HIDE"}},ERRORS:{INVITE_EXCEED_EDITOR:gettext("Your current plan allows {{totalEditors}} editors. Adding {{inviteEditors}} account(s) will exceed that limit by {{expireEditors}}"),INVITE_EXCEED_CONTRIBUTOR:gettext("Your current plan allows {{totalContributors}} contributors. Adding {{inviteContributors}} account(s) will exceed that limit by {{expireContributors}}")}}),angular.module("memberModule").controller("MemberListController",function($scope,$rootScope,$data,MEMBER_MODULE,WORKSPACE_MODULE){$scope.setDefaults=function(){$scope.showMemberList=!1,$scope.memberList={},$scope.memberList.pageNumber=1,$scope.memberList.pageSize=6,$scope.memberList.totalPages=1,$scope.memberList.totalRecords=0,$scope.userProfile=$data.$userProfile(),$scope.predicate="role",$scope.roles=MEMBER_MODULE.FILTERS.roles,$scope.accesses=MEMBER_MODULE.FILTERS.accesses,$scope.memberWorkspace={},$scope.memberList.workspaceId=$scope.workspaceShareId?$scope.workspaceShareId:"",$scope.memberList.workspaceOwnerId=$scope.workspaceOwnerId?$scope.workspaceOwnerId:"",$scope.label={totalUsersName:gettext($scope.memberList.workspaceId?"Model Users":"Team Users")},$scope.invitationsTemplate=MEMBER_MODULE.INVITE_MEMBER.TEMPLATES.LIST_INVITATIONS,$scope.showInvitations=!1},$scope.setPredicate=function(predicate){event.preventDefault();var sortPredicate=predicate.toLowerCase();"username"===sortPredicate?$scope.predicate="userName":$scope.predicate=sortPredicate},$scope.setMemberRole=function(member){$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._SAVE,{email:member.email,role:member.role})},$scope.setMemberAccess=function(member){member.workspaceId=$scope.workspaceShareId,$rootScope.$emit(WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._MEMBER_ACCESS,member)},$scope.deleteMember=function(member){for(var i=0;i<$scope.memberList.content.length;i++){var item=$scope.memberList.content[i],removeItem=member.id;-1!==removeItem.indexOf(item.id)&&($scope.memberList.content.splice(i,1),i--)}$scope.memberList.totalRecords--,member.role?$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._DELETE,member.id):member.access&&($scope.memberWorkspace.userId=member.id,$scope.memberWorkspace.workspaceId=$scope.workspaceShareId,$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._DELETE,$scope.memberWorkspace)),$scope.memberList.content.length<=3&&$scope.memberList.totalPages>1&&$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,{pageSize:6})},$scope.getPage=function(event,page){event.preventDefault(),$scope.memberList.pageNumber=page,$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,$scope.memberList)},$scope.update=function(event,data){if(data&&data.hasOwnProperty("memberList")){var memberList=data.memberList;$scope.memberList.content=memberList.content,$scope.memberList.pageNumber=memberList.pageNumber,$scope.memberList.pageSize=memberList.pageSize,$scope.memberList.totalPages=memberList.totalPages,$scope.memberList.totalRecords=memberList.totalRecords;for(var i=0;i<memberList.content.length;i++)"owner"===memberList.content[i].access.toLowerCase()&&$scope.memberList.totalRecords--}$scope.showMemberList=$scope.memberList.totalRecords>0,$scope.memberList.totalRecords>0&&$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._HIDE)},$scope.$watch("memberList.content",function(){if($scope.memberList.content)for(var i=0;i<$scope.memberList.content.length;i++){if($scope.memberList.content[i].hasOwnProperty("role")){$scope.label.memberTitle=gettext("Role");break}$scope.label.memberTitle=gettext("Access");break}}),$scope.showMember=function(){$scope.showMemberList=!0,$scope.showInvitations=!1},$scope.visibleInvitations=function(){$scope.showMemberList=!1,$scope.showInvitations=!0},$scope.showMemberInvite=function(){$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._CANCEL),$scope.showMemberList=!1,$scope.showInvitations=!1},$scope.setDefaults(),$rootScope.$off(MEMBER_MODULE.LIST_MEMBER.EVENTS._UPDATE),$rootScope.$on(MEMBER_MODULE.LIST_MEMBER.EVENTS._UPDATE,$scope.update),$rootScope.$off(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CANCEL),$rootScope.$on(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CANCEL,$scope.showMember),$rootScope.$emit(MEMBER_MODULE.LIST_MEMBER.EVENTS._READY,$scope.memberList),$scope.IsFromModeler=function(){return $data.$fromModeler()}}).filter("range",function(){return function(input,total){total=parseInt(total);for(var i=0;total>i;i++)input.push(i);return input}}),angular.module("memberModule").controller("MemberInviteController",function($scope,$rootScope,$data,$http,APP,MEMBER_MODULE){$scope.active={inviteCollaborators:!0},$scope.activateTab=function(event,tab){$scope.active={},$scope.active[tab]=!0},$scope.setDefaults=function(){$scope.isWorkspaceShare=$scope.workspaceShareId?!0:!1,$scope.showMemberInvite=!1,$scope.showCancelButton=!1,$scope.isAutoCompleteOn=!1,$scope.inviteMember={},$scope.inviteMember.list=[],$scope.inviteMember.array=[],$scope.inviteMember.autocompleteList=[],$scope.inviteMember.pageSize=6,$scope.inviteMember.pageNumber=1,$scope.inviteMember.note="",$scope.inviteMember.memberInviteForm=null,$scope.membersWorkspace={},$scope.noteInvite="",$scope.predicate="access",$scope.roles=MEMBER_MODULE.FILTERS.roles,$scope.roles.selected=$scope.roles[0],$scope.accesses=MEMBER_MODULE.FILTERS.accesses,$scope.accesses.selected=$scope.accesses[0],$scope.label={emailAddress:gettext("Email Address"),emailAlert:gettext("Email is Required"),addUser:gettext("Add user"),sendInvite:gettext("Invite"),
memberEmail:gettext("Email"),memberTitle:gettext("Role"),cancelInvite:gettext("Cancel")},$scope.invitationsTemplate=MEMBER_MODULE.INVITE_MEMBER.TEMPLATES.LIST_INVITATIONS,$scope.selectedAccess=$scope.accesses[0]},$scope.assignAccess=function(accessName){$scope.selectedAccess=accessName},$scope.update=function(event,data){data&&data.hasOwnProperty("showMemberInvite")?$scope.showMemberInvite=data.showMemberInvite:$scope.showMemberInvite=!1,$scope.workspaceShareId&&($scope.isWorkspaceShare=!0,$scope.showMemberInvite=!0,$scope.isAutoCompleteOn=!0,$scope.label.memberTitle="Access Rights",$scope.inviteMember.workspaceId=$scope.workspaceShareId,$scope.inviteMember.workspaceName=$scope.workspaceShareName)},$scope.setPredicate=function(predicate){event.preventDefault();var sortPredicate=predicate.toLowerCase();$scope.predicate=sortPredicate},$scope.validateEmail=function(email){var filter=/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;return filter.test(email)?($scope.emailError="",$scope.isValidEmail=!1,!0):($scope.emailError="Invalid email",$scope.isValidEmail=!0,!1)},$scope.getMemberList=function(){if($scope.isAutoCompleteOn){$scope.isAutoCompleteOn=!1;var loginObj=$data.$login(),accessToken="Bearer "+loginObj.access_token,httpObj={},userRole=void 0!=$data.$userProfile()?$data.$userProfile().role:"";return httpObj.method="GET",httpObj.url=APP.APPLICATION_MODULE.API.PATH.membershipService+"/api/teams/members?pageSize=100",httpObj.headers={},httpObj.headers={Authorization:accessToken,"Content-Type":"application/json"},$http(httpObj).then(function(response){if("Admin"===userRole)for(var i=response.data.content.length-1;i>=0;i--)if("Admin"===response.data.content[i].role){response.data.content.splice(i,1);break}return response.data.content.map(function(item){return $scope.inviteMember.autocompleteList.push(item),$scope.inviteMember.autocompleteList})})}return!1},$scope.addMemberToTeam=function(){var isValidEmail=$scope.validateEmail($scope.inviteMember.email);if(isValidEmail){var memberObject={role:$scope.roles.selected.name,email:$scope.inviteMember.email};$scope.inviteMember.array[$scope.inviteMember.email]=memberObject,$scope.inviteMember.list=[];for(var key in $scope.inviteMember.array)$scope.inviteMember.list.push($scope.inviteMember.array[key])}},$scope.addMemberToWorkspace=function(member){var isValidEmail=$scope.validateEmail(member.email);if(!isValidEmail)return!1;var memberObject={userId:member.id,access:"Contributor",email:member.email};"Viewer"===member.role&&(memberObject.accessViewer=!0),$scope.inviteMember.array[$scope.inviteMember.email]=memberObject,$scope.inviteMember.list=[];for(var key in $scope.inviteMember.array)$scope.inviteMember.list.push($scope.inviteMember.array[key]);$scope.memberInviteForm.$setPristine(),$scope.inviteMember.email=null},$scope.checkKeyup=function(event){if($scope.workspaceShareId){var inputEmail=angular.element(event.currentTarget).val();13===event.keyCode&&($scope.inviteMember.email.length>0||inputEmail.length>0)&&$scope.addMemberToWorkspace({id:"",email:inputEmail})}},$scope.addMemberClick=function(){$scope.addMemberToWorkspace({id:"",email:$scope.inviteMember.email})},$scope.deleteMember=function(member){for(var i=0;i<$scope.inviteMember.list.length;i++){var item=$scope.inviteMember.list[i],removeItem=member.email;-1!==removeItem.indexOf(item.email)&&($scope.inviteMember.list.splice(i,1),i--)}delete $scope.inviteMember.array[member.email]},$scope.sendInvites=function(){0!=$scope.inviteMember.email.length&&($scope.isWorkspaceShare?$scope.sendInvitesToWorkspace():$scope.sendInvitesToTeam(),$scope.inviteMember.list=[],$scope.inviteMember.array=[],$scope.inviteMember.email=null,$scope.inviteMember.memberInviteForm.$setPristine())},$scope.sendInvitesToTeam=function(){$rootScope.$emit(APP.TEAM_MODULE.INVITE_MEMBER.EVENTS._SAVE,$scope.inviteMember.list)},$scope.sendInvitesToWorkspace=function(){$scope.membersWorkspace.workspaceId=$scope.inviteMember.workspaceId,$scope.membersWorkspace.workspaceName=$scope.inviteMember.workspaceName,$scope.membersWorkspace.pageSize=$scope.inviteMember.pageSize,$scope.membersWorkspace.pageNumber=$scope.inviteMember.pageNumber,$scope.membersWorkspace.noteInvite=$scope.inviteMember.note;var actualEmailInvite={};angular.forEach($scope.inviteMember.email,function(email){email.access=$scope.selectedAccess.name,email.email==$data.$userProfile().email&&(actualEmailInvite=email)});var index=$scope.inviteMember.email.indexOf(actualEmailInvite);index>=0&&$scope.inviteMember.email.splice(index,1),$scope.membersWorkspace.list=$scope.inviteMember.email,$scope.membersWorkspace.list.length>0&&$rootScope.$emit(APP.WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._SAVE,$scope.membersWorkspace)},$scope.loadUsers=function(filter){var loginObj=$data.$login(),accessToken="Bearer "+loginObj.access_token,httpObj={};return httpObj.method="GET",httpObj.url=APP.APPLICATION_MODULE.API.PATH.collaborationService+"api/workspace/"+$scope.inviteMember.workspaceId+"/users/shared?pageSize=10&filterKeyword="+filter,httpObj.headers={},httpObj.headers={Authorization:accessToken,"Content-Type":"application/json"},$http(httpObj).then(function(response){return response.data.content})},$scope.showMemberList=function(){$rootScope.$emit(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CANCEL),$scope.showMemberInvite=!1},$scope.showAddCollaborators=function(){$scope.showMemberInvite=!0},$scope.hideMemberInvite=function(){$scope.showMemberInvite=!1,$scope.showCancelButton=!0},$scope.setDefaults(),$rootScope.$off(MEMBER_MODULE.INVITE_MEMBER.EVENTS._SAVE),$rootScope.$on(MEMBER_MODULE.INVITE_MEMBER.EVENTS._SAVE,$scope.save),$rootScope.$off(MEMBER_MODULE.INVITE_MEMBER.EVENTS._UPDATE),$rootScope.$on(MEMBER_MODULE.INVITE_MEMBER.EVENTS._UPDATE,$scope.update),$rootScope.$off(MEMBER_MODULE.LIST_MEMBER.EVENTS._CANCEL),$rootScope.$on(MEMBER_MODULE.LIST_MEMBER.EVENTS._CANCEL,$scope.showAddCollaborators),$rootScope.$off(MEMBER_MODULE.LIST_MEMBER.EVENTS._HIDE),$rootScope.$on(MEMBER_MODULE.LIST_MEMBER.EVENTS._HIDE,$scope.hideMemberInvite),$rootScope.$off(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CHANGE_TAB),$rootScope.$on(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CHANGE_TAB,$scope.activateTab),$rootScope.$emit(MEMBER_MODULE.INVITE_MEMBER.EVENTS._READY)}),angular.module("teamModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("teamModule").constant("TEAM_MODULE",{EVENTS:{_ERROR:"ERROR",_FAIL:"FAIL",_READY:"TEAM_MODULE._READY",_UPDATE:"TEAM_MODULE._UPDATE",_SAVE:"TEAM_MODULE._SAVE",_MEMBER_MODULE_INVITE:{_READY:"TEAM_MODULE._MEMBER_MODULE_INVITE._READY",_SAVE:"TEAM_MODULE._MEMBER_MODULE_INVITE._SAVE",_SUCCESS:"TEAM_MODULE._MEMBER_MODULE_INVITE._SUCCESS",_UPDATE:"TEAM_MODULE._MEMBER_MODULE_INVITE._UPDATE"}},NEW_TEAM:{TEMPLATES:{BASE:"views/team.new.module.view.html"},EVENTS:{_SAVE:"TEAM_MODULE.NEW_TEAM._SAVE",_UPDATE:"TEAM_MODULE.NEW_TEAM._UPDATE",_READY:"TEAM_MODULE.NEW_TEAM._READY"}},LIST_TEAM:{TEMPLATES:{BASE:"views/team.list.module.view.html"},EVENTS:{_SAVE:"TEAM_MODULE.LIST_TEAM._SAVE",_UPDATE:"TEAM_MODULE.LIST_TEAM._UPDATE",_READY:"TEAM_MODULE.LIST_TEAM._READY"}},INVITE_MEMBER:{EVENTS:{_SAVE:"TEAM_MODULE.INVITE_MEMBER._SAVE",_UPDATE:"TEAM_MODULE.INVITE_MEMBER._UPDATE",_READY:"TEAM_MODULE.INVITE_MEMBER._READY"}}}),angular.module("teamModule").controller("TeamController",function($scope,$rootScope,APP,TEAM_MODULE){$scope.setDefaults=function(){$scope.team={},$scope.team["new"]=TEAM_MODULE.NEW_TEAM.TEMPLATES.BASE,$scope.team.list=TEAM_MODULE.LIST_TEAM.TEMPLATES.BASE,$scope.member={},$scope.member.invite=APP.MEMBER_MODULE.INVITE_MEMBER.TEMPLATES.BASE,$scope.member.list=APP.MEMBER_MODULE.LIST_MEMBER.TEMPLATES.BASE,$scope.inviteUser={},$scope.showTeamList=!1},$scope.setTeam=function(event,data){$scope.team["new"]=data.teamNew,$scope.team.list=data.teamList,$scope.member.invite=data.memberInvite,$scope.member.list=data.memberList},$scope.setDefaults(),$rootScope.$off(TEAM_MODULE.EVENTS._UPDATE),$rootScope.$on(TEAM_MODULE.EVENTS._UPDATE,$scope.setTeam),$rootScope.$emit(TEAM_MODULE.EVENTS._READY)}),angular.module("teamModule").controller("TeamNewController",function($scope,$rootScope,TEAM_MODULE){$scope.setDefaults=function(){$scope.team={},$scope.showTeamNew=!0,$scope.errorForm=!1,$scope.label={newTeam:"New Team",newTeamDesc:"Create a new team and invite somebody by email"}},$scope.update=function(event,data){data&&data.hasOwnProperty("showTeamNew")?$scope.showTeamNew=data.showTeamNew:$scope.showTeamNew=!0},$scope.newTeam=function(){var valid=$scope.validateNewTeam();valid?$rootScope.$emit(TEAM_MODULE.NEW_TEAM.EVENTS._SAVE,$scope.team):($scope.errorForm=!0,$scope.message="Write the team name")},$scope.validateNewTeam=function(){var validInputFields=!1;return"string"==typeof $scope.team.name&&$scope.team.name.length&&(validInputFields=!0),validInputFields},$scope.setDefaults(),$rootScope.$on(TEAM_MODULE.NEW_TEAM.EVENTS._UPDATE,$scope.update),$rootScope.$emit(TEAM_MODULE.NEW_TEAM.EVENTS._READY)}),angular.module("teamModule").controller("TeamListController",function($scope,$rootScope,TEAM_MODULE){$scope.setDefaults=function(){$scope.team={},$scope.showTeamList=!1,$scope.label={team:"Team",designer:"Designer",viewer:"Viewer",designerDesc:"Can create Models shared with him as editor",viewerDesc:"Can only be invited to view an comment on a Model"}},$scope.update=function(event,data){data&&data.hasOwnProperty("showTeamList")?$scope.showTeamList=data.showTeamList:$scope.showTeamList=!0,$scope.team.name=data.name},$scope.setDefaults(),$rootScope.$off(TEAM_MODULE.LIST_TEAM.EVENTS._UPDATE),$rootScope.$on(TEAM_MODULE.LIST_TEAM.EVENTS._UPDATE,$scope.update),$rootScope.$emit(TEAM_MODULE.LIST_TEAM.EVENTS._READY)}),angular.module("headerModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("headerModule").constant("APP_HEADER_MODULE",{EVENTS:{_READY:"APP_HEADER_MODULE._READY",_UPDATE:"APP_HEADER_MODULE._UPDATE",_REFRESH:"APP_HEADER_MODULE._REFRESH",_ACTION:"APP_HEADER_MODULE._ACTION",_EXECUTE:"EXECUTE"},TEMPLATES:{HEADER:"views/app.header.module.view.html"}}),angular.module("headerModule").controller("HeaderController",function($scope,$rootScope,APP_HEADER_MODULE){$scope.setDefaults=function(){$scope.template=APP_HEADER_MODULE.TEMPLATES.HEADER},$scope.setDefaults()}),angular.module("appBreadcrumbModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("appBreadcrumbModule").constant("APP_BREADCRUMB_MODULE",{EVENTS:{_READY:"APP_BREADCRUMB_MODULE._READY",_UPDATE:"APP_BREADCRUMB_MODULE._UPDATE",_REFRESH:"APP_BREADCRUMB_MODULE._REFRESH",_ACTION:"APP_BREADCRUMB_MODULE._ACTION",_EXECUTE:"EXECUTE"},TEMPLATES:{BREADCRUMB:"views/app.breadcrumb.module.view.html"}}),angular.module("appBreadcrumbModule").controller("AppBreadcrumbController",function($scope,$rootScope,$data,$state,$timeout,APP_BREADCRUMB_MODULE,APP){$scope.setDefaults=function(){$scope.template=APP_BREADCRUMB_MODULE.TEMPLATES.BREADCRUMB,$scope.text={workspace:null,diagram:null},$rootScope.$emit("$stateChangeStart",$state.current)},$scope.update=function(event,data){$scope.text.workspace=data.workspace,$scope.workspaceId=data.workspaceId,$scope.text.diagram=data.diagram},$scope.refreshWorkspaces=function(){$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._READY,!0)},$scope.goToWorkspace=function(){$scope.workspaceId&&$state.go("CloudIn.workspaces.diagrams",{workspaceId:$scope.workspaceId})},$rootScope.$off(APP_BREADCRUMB_MODULE.EVENTS._UPDATE),$rootScope.$on(APP_BREADCRUMB_MODULE.EVENTS._UPDATE,$scope.update),$scope.setDefaults()}),angular.module("appMenuModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("appMenuModule").constant("APP_MENU_MODULE",{EVENTS:{_READY:"APP_MENU_MODULE._READY",_UPDATE:"APP_MENU_MODULE._UPDATE",_REFRESH:"APP_MENU_MODULE._REFRESH",_ACTION:"APP_MENU_MODULE._ACTION",_EXECUTE:"EXECUTE"},TEMPLATES:{MENU:"views/app.menu.module.view.html"},CSS:{STATES:{ACTIVE:"bz-cd-active",HOVER:"bz-cd-hover",HIDE:"bz-cd-hide",SHOW:"bz-cd-show"}},ACTION_MENU:{ACTIONS:[],OPTIONS:[{name:gettext("Grid View"),url:"GRID",img:"grid",css:"bz-grid-option",state:"enabled",type:"icon",responsive:"hidden-xs hidden-sm",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]},{name:gettext("List View"),url:"LIST",img:"list",css:"bz-list-option",state:"enabled",type:"icon",responsive:"hidden-xs hidden-sm",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]},{name:gettext("Show Comments"),url:"SHOW.COMMENTS",img:"comment",css:"bz-comments-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]},{name:gettext("Show Model Activity"),url:"SHOW.NOTIFICATIONS",img:"bell",css:"bz-notifications-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]}]}}),angular.module("appMenuModule").controller("AppMenuController",function($scope,$rootScope,$data,$timeout,APP_MENU_MODULE){$scope.setDefaults=function(){$scope.template=APP_MENU_MODULE.TEMPLATES.MENU,$scope.options=APP_MENU_MODULE.ACTION_MENU.OPTIONS,$scope.actions=APP_MENU_MODULE.ACTION_MENU.ACTIONS},$scope.update=function(event,data){$scope.options=$data.$validateAccessMenu(data.options),$scope.actions=$data.$validateAccessMenu(data.actions),data.hasOwnProperty("refresh")&&$rootScope.$emit(APP_MENU_MODULE.EVENTS._REFRESH)},$scope.layout=$data.$layout(),$scope.execute=function(event,obj){$rootScope.$emit(APP_MENU_MODULE.EVENTS._EXECUTE,obj)},$scope.activeIcon=function(event){$(event.currentTarget).toggleClass(APP_MENU_MODULE.CSS.STATES.ACTIVE)},$scope.setDefaults(),$rootScope.$off(APP_MENU_MODULE.EVENTS._UPDATE),$rootScope.$on(APP_MENU_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(APP_MENU_MODULE.EVENTS._READY)}),angular.module("dashboardModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("dashboardModule").constant("DASHBOARD_MODULE",{EVENTS:{_READY:"DASHBOARD_MODULE._READY",_ERROR:"ERROR"}}),angular.module("dashboardModule").controller("DashboardController",function($scope,$rootScope,$state,$stateParams,DASHBOARD_MODULE){$scope.userName=$stateParams.userName,$scope.state=$state.current.name}),angular.module("dashboardModule").directive("changeLayout",function($rootScope){return{restrict:"A",link:function(scope,element){$rootScope.$on("changeLayout",function(e,attributes){var sectionMiddle=(element.find(".section-left"),element.find(".section-middle")),sectionRight=element.find(".section-right");attributes&&attributes.open?(sectionMiddle.removeClass("col-sm-12").addClass("col-sm-7 col-md-8 col-lg-9"),sectionRight.removeClass("col-sm-0").addClass("col-sm-5 col-md-4 col-lg-3")):(sectionMiddle.removeClass("col-sm-7 col-md-8 col-lg-9").addClass("col-sm-12"),sectionRight.removeClass("col-sm-5 col-md-4 col-lg-3").addClass("col-sm-0"))})}}}),angular.module("userProfileModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("userProfileModule").constant("USER_PROFILE_MODULE",{TEMPLATES:{BASE:"",CHANGE_PASSWORD:"views/change.password.module.view.html"},RESOURCES:{IMAGES:{AVATAR:{A24:"app/img/pmcloud-avatar-24.png",A32:"app/img/pmcloud-avatar-32.png",A128:"app/img/bizagi-placeholder-avatar.png"}}},EVENTS:{_READY:"USER_PROFILE_MODULE._READY",_UPDATE:"USER_PROFILE_MODULE._UPDATE",_UPDATE_COUNTRIES:"USER_PROFILE_MODULE._UPDATE_COUNTRIES",_SAVE:"USER_PROFILE_MODULE._SAVE",_CANCEL:"USER_PROFILE_MODULE._CANCEL",_ERROR:"ERROR",_FAIL:"FAIL",_OPEN_MODULE:"OPEN_MODULE"}}),angular.module("userProfileModule").controller("UserProfileController",function($rootScope,$scope,$data,USER_PROFILE_MODULE,APP,gettextCatalog){$scope.setDefaults=function(){$scope.userName="userName",$scope.label={firstName:"First Name",lastName:"Last Name",userName:"Display Name",enterEmail:"Email",phone:"Phone",languages:"Language",invitePeople:"Invite your team to join BizagiCloud and work collaboratively.",changePlan:"Change Plan",changePassword:"Change Password",cancel:"Close",updateSettings:"Update Profile",closeAccount:"Close account",country:"Country"},$scope.avatarPlaceholder=USER_PROFILE_MODULE.RESOURCES.IMAGES.AVATAR.A128,$scope.userProfile={},$scope.userProfileBackup={},$scope.container="",$scope.changePasswordTemplate=USER_PROFILE_MODULE.TEMPLATES.CHANGE_PASSWORD},$scope.openModule=function(module){$rootScope.$emit(USER_PROFILE_MODULE.EVENTS._OPEN_MODULE,module)},$scope.update=function(event,data){data.fullName=(data.firstName||"")+" "+(data.lastName||""),angular.extend($scope.userProfileBackup,data),$scope.userProfile=data},$scope.cancel=function(){for(var prop in $scope.userProfile)$scope.userProfile[prop]=$scope.userProfileBackup[prop];$rootScope.$emit(USER_PROFILE_MODULE.EVENTS._CANCEL,$scope.userProfileBackup)},$scope.save=function(){$rootScope.$emit(USER_PROFILE_MODULE.EVENTS._SAVE,$scope.userProfile),$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._UPDATE,$scope.userProfile)},$scope.close=function(){$rootScope.$emit(USER_PROFILE_MODULE.EVENTS._CLOSE,$scope.userProfile)},$scope.css=function(event,data){$scope.container=data},$scope.userAvatarImage=function(){var img=$scope.avatarPlaceholder;return $scope.userProfile.hasOwnProperty("avatar")&&(img=null!=$scope.userProfile.avatar?$scope.userProfile.avatar:$scope.avatarPlaceholder),img},$scope.updateCountries=function(event,countries){$scope.countries=countries},$scope.changeLanguage=function(selectLang){gettextCatalog.setCurrentLanguage(selectLang.value)},$scope.setDefaults(),$rootScope.$on(USER_PROFILE_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(USER_PROFILE_MODULE.EVENTS._UPDATE_COUNTRIES,$scope.updateCountries),$rootScope.$emit(USER_PROFILE_MODULE.EVENTS._READY)}),angular.module("workspaceModule",["ui.router","ui.bootstrap","applicationModule","angularMoment"]),angular.module("workspaceModule").constant("WORKSPACE_MODULE",{NAME:"Workspace Module",EVENTS:{_READY:"WORKSPACE_MODULE._READY",_UPDATE:"WORKSPACE_MODULE._UPDATE",_SELECTED:"WORKSPACE_MODULE._SELECTED",_NEW:"WORKSPACE_MODULE._NEW",_EDIT:"WORKSPACE_MODULE._EDIT",_NEXTPAGE:"WORKSPACE_MODULE._NEXTPAGE",_DELETE:"WORKSPACE_MODULE._DELETE",_ERROR:"ERROR",_EXECUTE:"EXECUTE",_LOGOUT:"LOGOUT",_EXTERNALURI:"WORKSPACE_MODULE._TRIAL"},ACTIONS:{OPEN_APPLICATION:"OPEN.MODELER",NEW_WORKSPACE:"NEW.WORKSPACE",SAVE_WORKSPACE:"SAVE.WORKSPACE",EDIT_WORKSPACE:"EDIT.WORKSPACE",SHARE_WORKSPACE:"SHARE.WORKSPACE",DELETE_WORKSPACE:"DELETE.WORKSPACE"},RESOURCES:{IMAGES:{PLACEHOLDER:"app/img/bizagi-workspace-placeholder.png",PLACEHOLDER_MODELER:"app/img/bizagi-workspace-placeholder-modeler.png",PLACEHOLDER_EMPTY:"app/img/bizagi-placeholder-empty.png"}},ACTION_MENU:{ACTIONS:[{name:gettext("Edit in Bizagi Modeler"),action:"OPEN.MODELER",url:"",img:"modeler-edit",state:"enabled",type:"icon",roles:["Admin",gettext("Designer")],access:["Editor","Personal","Owner"],plan:["personal","trial","full"]}],OPTIONS:[{name:gettext("Properties"),url:"EDIT.WORKSPACE",img:"pencil",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Editor","Personal","Owner"],plan:["personal","trial","full"]},{name:gettext("Invite People to Model"),url:"SHARE.WORKSPACE",img:"share",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Personal","Owner"],plan:["trial","full"]},{name:gettext("Delete"),url:"DELETE.WORKSPACE",img:"trash",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Personal","Owner"],plan:["personal","trial","full"]}],BUTTONS:[]},NEW_WORKSPACE:{TEMPLATES:{BASE:"views/workspace.new.module.view.html"},EVENTS:{_SAVE:"WORKSPACE_MODULE.NEW_WORKSPACE._SAVE",_UPDATE:"WORKSPACE_MODULE.NEW_WORKSPACE._UPDATE",_READY:"WORKSPACE_MODULE.NEW_WORKSPACE._READY",_EXECUTE:"EXECUTE"},ACTIONS:[{name:gettext("Save"),action:"WORKSPACE_MODULE.NEW_WORKSPACE._SAVE",actionName:"new",state:"primary",type:"button"}],ACTIONS_UPLOAD:[{name:"Upload Model",action:"WORKSPACE_MODULE.NEW_WORKSPACE._SAVE",actionName:"new",state:"primary",type:"button"}]},EDIT_WORKSPACE:{TEMPLATES:{BASE:"views/workspace.edit.module.view.html"},EVENTS:{_SAVE:"WORKSPACE_MODULE.EDIT_WORKSPACE._SAVE",_UPDATE:"WORKSPACE_MODULE.EDIT_WORKSPACE._UPDATE",_READY:"WORKSPACE_MODULE.EDIT_WORKSPACE._READY"},ACTIONS:[{name:"Save",action:"WORKSPACE_MODULE.EDIT_WORKSPACE._SAVE",actionName:"save",state:"primary",type:"button"}]},SHARE_WORKSPACE:{TEMPLATES:{BASE:"views/workspace.share.module.view.html"},EVENTS:{_SAVE:"WORKSPACE_MODULE.SHARE_WORKSPACE._SAVE",_ACCEPT:"WORKSPACE_MODULE.SHARE_WORKSPACE._ACCEPT",_UPDATE:"WORKSPACE_MODULE.SHARE_WORKSPACE._UPDATE",_READY:"WORKSPACE_MODULE.SHARE_WORKSPACE._READY",_LIST:"WORKSPACE_MODULE.SHARE_WORKSPACE._LIST",_MEMBER_ACCESS:"WORKSPACE_MODULE.SHARE_WORKSPACE._MEMBER_ACCESS"},ACTIONS:[]},DELETE_WORKSPACE:{TEMPLATES:{BASE:"views/workspace.delete.module.view.html"},EVENTS:{_SAVE:"WORKSPACE_MODULE.DELETE_WORKSPACE._SAVE",_DELETE:"WORKSPACE_MODULE.DELETE_WORKSPACE._DELETE",_UPDATE:"WORKSPACE_MODULE.DELETE_WORKSPACE._UPDATE",_READY:"WORKSPACE_MODULE.DELETE_WORKSPACE._READY",_LIST:"WORKSPACE_MODULE.DELETE_WORKSPACE._LIST"},ACTIONS:[{name:gettext("Delete Model"),action:"WORKSPACE_MODULE.DELETE_WORKSPACE._DELETE",actionName:"delete",state:"primary",type:"button"}]},ROUTE_EXTERNAL_URL:{CONSTANTS:{WORKSPACE_TRIAL:"trial",WORKSPACE_UPGRADE:"upgrade",PERSONAL_PLAN:"personal"}}}),angular.module("workspaceModule").controller("WorkspaceController",function($scope,$rootScope,$cookies,$state,$window,$data,WORKSPACE_MODULE){$scope.setDefaults=function(){$scope.visiblePanel=0,$scope.workspaceId=0,$scope.noWorkspaces=!1,$scope.noWorkspacesModeler=!1,$scope.workspacePlaceholder=WORKSPACE_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.workspacePlaceholderModeler=WORKSPACE_MODULE.RESOURCES.IMAGES.PLACEHOLDER_MODELER,$scope.workspacePlaceholderEmpty=WORKSPACE_MODULE.RESOURCES.IMAGES.PLACEHOLDER_EMPTY,$scope.createNewWorkspace=WORKSPACE_MODULE.ACTIONS.NEW_WORKSPACE,$scope.pageTitle="",$scope.workspaces=[],$scope.options=WORKSPACE_MODULE.ACTION_MENU.OPTIONS,$scope.actions=WORKSPACE_MODULE.ACTION_MENU.ACTIONS,$scope.buttons=WORKSPACE_MODULE.ACTION_MENU.BUTTONS,$scope.visibility={newWorkspace:!1,deleteWorkspace:!1},$scope.text={workspacePlaceholder:"Bizagi Modeler Workspace",workspacePlaceholderEmpty:"Bizagi Cloud Empty"},$scope.layout="list",$rootScope.layoutWorkspaces?$scope.layout=$rootScope.layoutWorkspaces:$scope.layout="list",$scope.isModeler=$data.$fromModeler(),$scope.isMobile=$data.$isMobile(),$scope.subscription=$data.$subscription()},$scope.changeLayout=function(data){"grid"===data.layout?$scope.layout="grid":$scope.layout="list",$rootScope.layoutWorkspaces=$scope.layout},$scope.workspaceImage=function(workspaceImage){return workspaceImage},$scope.getWokspaceById=function(id){for(var workspaces=$scope.workspaces,rValue=null,i=0;i<workspaces.length;i++)if(workspaces[i].id===id){rValue=workspaces[i];break}return rValue},$scope.execute=function(event,obj){$rootScope.$emit(WORKSPACE_MODULE.EVENTS._EXECUTE,obj)},$scope.activeIcon=function(event){$(event.currentTarget).toggleClass($app.$allCss().states.active)},$scope.goToWorkspace=function(id){var ws=$scope.getWokspaceById(id);$rootScope.$emit(WORKSPACE_MODULE.EVENTS._SELECTED,ws)},$scope.showPanel=function(panel){$scope.visiblePanel=panel},$scope.newWorkspace=function(event,data){$scope.workspaces.unshift(data)},$scope.updateWorkspaceById=function(data){for(var i=0;i<$scope.workspaces.length;i++)$scope.workspaces[i].id===data.id&&angular.extend($scope.workspaces[i],data)},$scope.deleteWorkspaceById=function(data){var workspaces=$scope.workspaces,workspaceDeleted=data.workspaceDeleted,workspaceIndex=workspaces.indexOf(workspaceDeleted);workspaces.splice(workspaceIndex,1)},$scope.validateAccess=function(action,workspace){var aValueAccess=!1,aValuePlan=!0;if(action&&!_.isEmpty($scope.workspaces)&&action.hasOwnProperty("access"))for(var i=0;i<action.access.length;i++)if(action.access[i].toLowerCase()===workspace.accessType.toLowerCase()){aValueAccess=!0;break}return aValuePlan&&aValueAccess},$scope.update=function(event,data){if(data.hasOwnProperty("visibility")&&($scope.visibility=data.visibility),data.hasOwnProperty("refreshFromBreadCrumb")&&data.refreshFromBreadCrumb)$scope.workspaces=[],$scope.workspaces=data.dataSource.content,$rootScope.$emit(WORKSPACE_MODULE.EVENTS._NEXTPAGE);else if(data.hasOwnProperty("dataSource"))if(data.hasOwnProperty("newPage")){var result=_.uniq(_.union(data.dataSource.content,$scope.workspaces),!1,function(item){return item.id}),resultSorted=result.sort(function(a,b){var a2=new Date(a.creationDate).getTime(),b2=new Date(b.creationDate).getTime();return b2-a2});$scope.workspaces=resultSorted}else data.dataSource.hasOwnProperty("new")?(data.dataSource["new"].modifiedTime=moment().toDate(),data.dataSource["new"].userAccess={access:"Editor"},$scope.workspaces.unshift(data.dataSource["new"])):($scope.workspaces=[],$scope.workspaces=data.dataSource.content);data.hasOwnProperty("actions")&&($scope.actions=data.actions),data.hasOwnProperty("options")&&($scope.options=data.options),data.hasOwnProperty("title")&&($scope.pageTitle=data.title),data.hasOwnProperty("id")&&$scope.updateWorkspaceById(data),data.hasOwnProperty("workspaceDeleted")&&$scope.deleteWorkspaceById(data),data.hasOwnProperty("layout")&&$scope.changeLayout(data),data.hasOwnProperty("subscriptionInfo")&&($scope.subscriptionInfo={editors:_.where(data.subscriptionInfo.licenses,{licenseType:"Editor"}),contributors:_.where(data.subscriptionInfo.licenses,{licenseType:"Contributor"})}),$scope.noWorkspaces=!1,$scope.noWorkspacesModeler=!1,0===$scope.workspaces.length&&$data.$fromModeler()===!1&&($scope.noWorkspaces=!0),0===$scope.workspaces.length&&$data.$fromModeler()===!0&&($scope.noWorkspacesModeler=!0)},$scope.getNextPage=function(){$rootScope.$emit(WORKSPACE_MODULE.EVENTS._NEXTPAGE)},$scope.setDefaults(),$rootScope.$off(WORKSPACE_MODULE.EVENTS._UPDATE),$rootScope.$off(WORKSPACE_MODULE.EVENTS._EDIT),$rootScope.$off(WORKSPACE_MODULE.EVENTS._NEW),$rootScope.$on(WORKSPACE_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(WORKSPACE_MODULE.EVENTS._EDIT,$scope.edit),$rootScope.$on(WORKSPACE_MODULE.EVENTS._NEW,$scope["new"])}),angular.module("workspaceModule").controller("WorkspaceShareController",function($scope,$rootScope,WORKSPACE_MODULE){$scope.workspaceShareId=$scope.data?$scope.data.workspace.id:"",$scope.workspaceShareName=$scope.data?$scope.data.workspace.name:"",$scope.workspaceOwnerId=$scope.data?$scope.data.workspace.creatorId:"",$scope.member={},$scope.actions={},$scope.update=function(event,data){data&&data.hasOwnProperty("workspaceId")&&data.workspaceId&&($scope.workspaceShareId=data.workspaceId),data.hasOwnProperty("member")&&($scope.member.invite=data.member.invite,$scope.member.list=data.member.list)},$rootScope.$off(WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._UPDATE),$rootScope.$on(WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._READY)}),angular.module("workspaceModule").controller("WorkspaceDeleteController",function($scope,$rootScope,APP,WORKSPACE_MODULE){$scope.setDefaults=function(){$scope.workspace=$scope.data.workspace,$scope.text={deleteWarningMessage:"This action cannot be undone"}},$scope.update=function(event,data){data.hasOwnProperty("actions")&&($scope.actions=data.actions,delete data.actions),angular.extend($scope,{workspace:data})},$scope["delete"]=function(event,data){var dataForDelete={action:data.action,workspace:$scope.workspace};$rootScope.$emit(WORKSPACE_MODULE.EVENTS._EXECUTE,dataForDelete)},$scope.setDefaults(),$rootScope.$off(WORKSPACE_MODULE.DELETE_WORKSPACE.EVENTS._UPDATE),$rootScope.$off(WORKSPACE_MODULE.DELETE_WORKSPACE.EVENTS._DELETE),$rootScope.$on(WORKSPACE_MODULE.DELETE_WORKSPACE.EVENTS._DELETE,$scope["delete"]),$rootScope.$on(WORKSPACE_MODULE.DELETE_WORKSPACE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(WORKSPACE_MODULE.SHARE_WORKSPACE.EVENTS._READY)}),angular.module("workspaceModule").controller("WorkspaceNewController",function($scope,$rootScope,$state,$window,$data,WORKSPACE_MODULE){$scope.setDefaults=function(){$scope.workspace={},$scope.actions=WORKSPACE_MODULE.NEW_WORKSPACE.ACTIONS,$scope.WORKSPCAE_MODULE=WORKSPACE_MODULE,$scope.text={workspaceName:"Name your model",workspaceDescription:"What is the purpose of your model?",workspaceLength:"characters left",errorWorkspaceName:"Please enter the model name"},$scope.focusInput=!0},$scope.setDefaults(),$scope.showWorkspaceLength=function(event){var srcElement=event.srcElement||event.currentTarget,element=".bz-cd-form-counter";angular.element(srcElement).siblings(element).css("visibility","visible")},$scope.hideWorkspaceLength=function(event){var srcElement=event.srcElement||event.currentTarget,element=".bz-cd-form-counter";angular.element(srcElement).siblings(element).css("visibility","hidden")},$scope.save=function(event,data){if($scope.submitted=!0,$scope.workspaceNewForm.$valid){var dataForSave={action:data.action,workspace:$scope.workspace};$rootScope.$emit(WORKSPACE_MODULE.EVENTS._EXECUTE,dataForSave)}else $scope.focusInput=!0},$scope.update=function(event,data){data.hasOwnProperty("text")?angular.extend($scope,{text:data.text}):(angular.extend($scope,{workspace:data}),$scope.workspace=JSON.parse(data.workspace)),data.hasOwnProperty("actions")&&angular.extend($scope,{actions:data.actions})},$scope.options=function(event,data){$scope.actions=data.actions},$scope.execute=function(event,obj){$rootScope.$emit(obj.action,obj)},$scope.IsFromModeler=function(){return $data.$fromModeler()},$rootScope.$off(WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._SAVE),$rootScope.$off(WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._UPDATE),$rootScope.$on(WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._SAVE,$scope.save),$rootScope.$on(WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(WORKSPACE_MODULE.NEW_WORKSPACE.EVENTS._READY)}),angular.module("workspaceModule").controller("WorkspaceUpdateController",function($scope,$rootScope,$cookies,$state,$data,$window,WORKSPACE_MODULE){if($scope.setDefaults=function(){$scope.workspace={},$scope.actions={},$scope.WORKSPACE_MODULE=WORKSPACE_MODULE,$scope.focusInput=!0},$scope.setDefaults(),$scope.showWorkspaceLength=function(event){var srcElement=event.srcElement||event.currentTarget,element=".bz-cd-form-counter";angular.element(srcElement).siblings(element).css("visibility","visible")},$scope.hideWorkspaceLength=function(event){var srcElement=event.srcElement||event.currentTarget,element=".bz-cd-form-counter";angular.element(srcElement).siblings(element).css("visibility","hidden")},$scope.update=function(event,data){data.hasOwnProperty("actions")&&($scope.actions=data.actions,delete data.actions),angular.extend($scope,{workspace:data})},$scope.save=function(event,data){if($scope.submitted=!0,$scope.workspaceUpdateForm.$valid){var dataForSave={action:data.action,workspace:$scope.workspace};$scope.workspace.id=data.workspace?data.workspace.id:$data.$selectedWorkspace().id,$scope.workspace.lastModificationDate=moment().toDate(),$rootScope.$emit(WORKSPACE_MODULE.EVENTS._EXECUTE,dataForSave)}else $scope.focusInput=!0},$scope.IsFromModeler=function(){return $data.$fromModeler()},$scope.options=function(event,data){$scope.actions=data.actions},$scope.execute=function(event,obj){$rootScope.$emit(obj.action,obj)},$scope.data){var updateData=angular.copy($scope.data);angular.extend($scope,updateData)}$rootScope.$off(WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._UPDATE),$rootScope.$off(WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._SAVE),$rootScope.$on(WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._UPDATE,$scope.update),$rootScope.$on(WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._SAVE,$scope.save),$rootScope.$emit(WORKSPACE_MODULE.EDIT_WORKSPACE.EVENTS._READY,$scope.workspace)}),angular.module("workspaceModule").directive("heightWorkspaceDirective",function($rootScope,$data,APP){
return{restrict:"A",link:function(){var setScrollableSection=function(el,elementScroller){var outerHeight=el?el.outerHeight():0,availableH=window.innerHeight-outerHeight;elementScroller.css({height:availableH-40,overflowY:"auto",overflowX:"hidden",marginTop:20})};$data.$fromModeler()?$data.$elementDOMExist(".bz-cd-window-title").then(function(el){el=angular.element(".bz-cd-window-title");var elementScroller=angular.element(".bz-cd-content-scroller");if(setScrollableSection(el,elementScroller),elementScroller.length){var result=elementScroller.hasScrollBar();result||$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._NEXTPAGE)}},function(key){}):$data.$elementDOMExist(".bz-cd-app-header, .bz-cloud-plan-view").then(function(el){el=angular.element(".bz-cd-inner-header");var elementScroller=angular.element(".bz-cd-content-scroller");if(setScrollableSection(el,elementScroller),elementScroller.length){var result=elementScroller.hasScrollBar();result||$rootScope.$emit(APP.WORKSPACE_MODULE.EVENTS._NEXTPAGE)}},function(key){}),angular.element(window).resize(function(){var el=angular.element(".bz-cd-inner-header"),elementScroller=angular.element(".bz-cd-content-scroller");setScrollableSection(el,elementScroller)})}}}),angular.module("diagramsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("diagramsModule").constant("DIAGRAMS_MODULE",{EVENTS:{_READY:"DIAGRAMS_MODULE._READY",_UPDATE:"DIAGRAMS_MODULE._UPDATE",_USERS_DIAGRAMS:"DIAGRAMS_MODULE._USERS_DIAGRAMS",_ERROR:"ERROR",_EXECUTE:"EXECUTE"},ACTIONS:{UNLOCK_DIAGRAM:"UNLOCK.DIAGRAM"},TEMPLATES:{LIST:"views/diagrams.list.module.view.html"},RESOURCES:{IMAGES:{PLACEHOLDER:"app/img/bizagi-process-placeholder.png"}},ACTION_MENU:{OPTIONS:[{name:"Lock",url:"EDIT.WORKSPACE",img:"lock",state:"enabled",type:"icon",roles:["Admin","Designer"],access:["Editor"]}]},UNLOCK_DIAGRAM:{TEMPLATES:{BASE:"views/diagrams.unlock.module.view.html"},EVENTS:{_UNLOCK:"DIAGRAMS_MODULE.UNLOCK_DIAGRAM._UNLOCK"},ACTIONS:[{name:"Unlock",action:"DIAGRAMS_MODULE.UNLOCK_DIAGRAM._UNLOCK",actionName:"unlock",state:"primary",type:"button"}]}}),angular.module("diagramsModule").controller("DiagramsController",function($scope,$rootScope,$state,applicationServices,$data,DIAGRAMS_MODULE,gettextCatalog){var translateOptions=function(list){return _.each(list,function(item,i){list[i].name=gettextCatalog.getString(item.name)}),list};$scope.setDefaults=function(){$scope.visiblePanel=0,$scope.diagramId=0,$scope.dataUser={},$scope.noDiagrams=!1,$scope.diagramOptions=!0,$scope.options=translateOptions(DIAGRAMS_MODULE.ACTION_MENU.OPTIONS),$scope.diagramPlaceholder=DIAGRAMS_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.selectedWorkspace=$data.$selectedWorkspace(),$scope.userProfile=$data.$userProfile(),$scope.selectedWorkspace&&($scope.workspaceId=$scope.selectedWorkspace.id),$rootScope.layoutDiagrams?$scope.layout=$rootScope.layoutDiagrams:$scope.layout="grid"},$scope.changeLayout=function(data){"grid"===data.layout?$scope.layout="grid":$scope.layout="list",$rootScope.layoutDiagrams=$scope.layout},$scope.update=function(event,data){if(data.hasOwnProperty("diagramUnlocked")){var index=$scope.diagrams.indexOf(data.diagramUnlocked);-1!==index&&(data.diagramUnlocked.lockingInfo=void 0,$scope.diagrams[index]=data.diagramUnlocked)}data.hasOwnProperty("dataSource")&&(data.dataSource.length?$scope.diagrams=data.dataSource:($scope.noDiagrams=!0,$scope.message="There are no diagrams here")),data.hasOwnProperty("options")&&($scope.diagramOptions=data.options),data.hasOwnProperty("layout")&&$scope.changeLayout(data)},$scope.diagramImage=function(img){return img?img:$scope.diagramPlaceholder},$scope.showPanel=function(panel){$scope.visiblePanel=panel},$scope.getDiagramById=function(id){for(var diagrams=$scope.diagrams,rValue=null,i=0;i<diagrams.length;i++)if(diagrams[i].id===id){rValue=diagrams[i];break}return rValue},$scope.gotoProcessViewer=function(obj){$scope.diagramId=obj.diagramId},$scope.$watch("diagramId",function(){0!==$scope.diagramId&&($scope.selectedDiagram=$scope.getDiagramById($scope.diagramId),$data.$selectedDiagram($scope.selectedDiagram),$state.go("CloudIn.workspaces.processviewer",{workspaceId:$scope.workspaceId,diagramId:$scope.diagramId,selectedProcess:$scope.selectedDiagram}))}),$scope.userLockedDiagram=function(userId){if(userId){var user=_.find($scope.usersDiagrams,function(e){return e.id===userId});return user.email}return""},$scope.execute=function(event,data){var workspace=$data.$selectedWorkspace();"Editor"===workspace.userAccess.access&&$rootScope.$emit(DIAGRAMS_MODULE.EVENTS._EXECUTE,data)},$scope.setUsers=function(event,data){$scope.usersDiagrams=data},$scope.setDefaults(),$rootScope.$off(DIAGRAMS_MODULE.EVENTS._UPDATE),$rootScope.$off(DIAGRAMS_MODULE.EVENTS._USERS_DIAGRAMS),$rootScope.$on(DIAGRAMS_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(DIAGRAMS_MODULE.EVENTS._USERS_DIAGRAMS,$scope.setUsers),$rootScope.$emit(DIAGRAMS_MODULE.EVENTS._READY)}),angular.module("diagramsModule").directive("noImage",["$data",function($data){var setDefaultImage=function(scope,el){el.attr("src",scope.diagramPlaceholder),el.addClass("bz-cd-img-placeholder")};return{restrict:"A",link:function(scope,el,attr){var src=attr.ngSrc;src||setDefaultImage(scope,el)}}}]),angular.module("diagramsModule").controller("DiagramsUnlockController",function($scope,$rootScope,DIAGRAMS_MODULE){$scope.setDefaults=function(){$scope.workspace=$scope.data.workspace,$scope.text={deleteWarningMessage:"Would you like to force the diagram unlock?  All unsaved changes will be lost."}},$scope.unlock=function(event,data){$rootScope.$emit(DIAGRAMS_MODULE.EVENTS._EXECUTE,data)},$scope.setDefaults(),$rootScope.$off(DIAGRAMS_MODULE.EVENTS._UNLOCK),$rootScope.$on("DIAGRAMS_MODULE.UNLOCK_DIAGRAM._UNLOCK",$scope.unlock)}),angular.module("processViewerModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("processViewerModule").constant("BPM",{POOL:{svg:"rect",css:"svg-pool",elementTypes:[{elementType:"ProcessPool",css:"ng-processpool"}]},ARTIFACTS:{svg:"circle",css:"svg-artifacts",elementTypes:[{elementType:"ImageArtifact",css:"ng-imageartifact"},{elementType:"FormattedTextArtifact",css:"ng-formattedtextartifact"},{elementType:"CustomArtifact",css:"ng-customartifact"},{elementType:"TextAnnotation",css:"ng-textannotation"},{elementType:"HeaderArtifact",css:"ng-headerartifact"},{elementType:"Group",css:"ng-group"}]},EVENTS:{svg:"circle",css:"svg-events",size:{w:16,h:16},elementTypes:[{elementType:"NoneStart",css:"ng-nonestart"},{elementType:"NoneEnd",css:"ng-noneend"},{elementType:"EscalationEnd",fontIcon:65312,css:"ng-escalationend"},{elementType:"CancelEnd",fontIcon:65300,css:"ng-cancelend"},{elementType:"CompensationEnd",fontIcon:65302,css:"ng-compensationend"},{elementType:"SignalEnd",fontIcon:65321,css:"ng-signalend"},{elementType:"MultipleEnd",fontIcon:65318,css:"ng-multipleend"},{elementType:"TerminateEnd",fontIcon:65328,css:"ng-terminateend"},{elementType:"MessageEnd",fontIcon:65316,css:"ng-messageend"},{elementType:"ErrorEnd",fontIcon:65304,css:"ng-errorend"},{elementType:"NoneIntermediate",icon:"noneintermediate",css:"ng-noneintermediate"},{elementType:"ErrorIntermediate",fontIcon:{isThrow:65304,isCatch:65303},css:"ng-errorintermediate"},{elementType:"MessageStart",fontIcon:65315,css:"ng-messagestart"},{elementType:"TimerStart",fontIcon:65329,css:"ng-timerstart"},{elementType:"ConditionalStart",fontIcon:61697,css:"ng-conditionalstart"},{elementType:"SignalStart",fontIcon:65320,css:"ng-signalstart"},{elementType:"MultipleStart",fontIcon:65317,css:"ng-multiplestart"},{elementType:"MessageIntermediate",fontIcon:{isThrow:65316,isCatch:65315},size:{w:9,h:9},css:"ng-messageintermediate"},{elementType:"ParallelMultipleStart",fontIcon:65319,css:"ng-parallelmultiplestart"},{elementType:"ConditionalIntermediate",fontIcon:61697,css:"ng-conditionalintermediate"},{elementType:"LinkIntermediate",fontIcon:{isThrow:65314,isCatch:65313},css:"ng-linkintermediate"},{elementType:"TimerIntermediate",fontIcon:65329,css:"ng-timerintermediate"},{elementType:"MultipleIntermediate",fontIcon:{isThrow:65318,isCatch:65317},css:"ng-multipleintermediate"},{elementType:"ParallelMultipleIntermediate",fontIcon:65319,css:"ng-parallelmultipleintermediate"},{elementType:"CompensationIntermediate",fontIcon:{isThrow:65302,isCatch:65301},css:"ng-compensationintermediate"},{elementType:"EscalationIntermediate",fontIcon:{isThrow:65312,isCatch:65305},css:"ng-escalationintermediate"},{elementType:"SignalIntermediate",fontIcon:{isThrow:65321,isCatch:65320},css:"ng-signalintermediate"}]},GATEWAYS:{svg:"polygon",css:"svg-gateways",size:{w:16,h:16},elementTypes:[{elementType:"ExclusiveGateway",markers:{markerVisible:65300},css:"ng-exclusivegateway"},{elementType:"InclusiveGateway",fontIcon:65331,css:"ng-inclusivegateway"},{elementType:"ParallelGateway",fontIcon:65332,css:"ng-parallelgateway"},{elementType:"EventBasedGateway",fontIcon:65333,css:"ng-eventbasedgateway"},{elementType:"ComplexGateway",fontIcon:65336,css:"ng-complexgateway"},{elementType:"EventBasedGatewayExclusive",fontIcon:65334,css:"ng-eventBasedgatewayexclusive"},{elementType:"EventBasedGatewayParallel",fontIcon:65335,css:"ng-eventbasedgatewayparallel"}]},DATA:{svg:"rect",css:"svg-data",elementTypes:[{elementType:"DataObject",css:"ng-dataobject"},{elementType:"DataStoreReference",css:"ng-datastorereference"}]},CONNECTOR:{svg:"path",css:"svg-connector",elementTypes:[{elementType:"SequenceFlow",css:"ng-sequenceflow"},{elementType:"MessageFlow",css:"ng-messageflow"},{elementType:"Association",css:"ng-association"}]},SWIMLANES:{svg:"rect",css:"svg-swimlane",elementTypes:[{elementType:"Lane",css:"ng-lane"},{elementType:"Milestone",css:"ng-milestone"}]},ACTIVITIES:{svg:"rect",css:"svg-activities",size:{w:13,h:13},elementTypes:[{elementType:"AbstractTask",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282},isForCompensation:65301},css:"ng-abstracttask"},{elementType:"SubProcess",icons:{triggeredByEvent:65288},markers:{icon:65285,loopType:{MultiInstance:{parallel:65283,sequential:65284,parallelSubProcessType:{AdHoc:65280}},Standard:65282},SubProcessType:{AdHoc:65280}},cssFont:"bz-cd-svg",css:"ng-subprocess"},{elementType:"UserTask",fontIcon:65298,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-usertask"},{elementType:"ServiceTask",fontIcon:65296,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-servicetask"},{elementType:"ReceiveTask",fontIcon:65288,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-receivetask"},{elementType:"SendTask",fontIcon:65297,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-sendtask"},{elementType:"ScriptTask",fontIcon:65289,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-scripttask"},{elementType:"ManualTask",fontIcon:65287,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-manualtask"},{elementType:"BusinessRuleTask",fontIcon:65286,cssFont:"bz-cd-svg",markers:{loopType:{MultiInstance:{parallel:65283,sequential:65284},Standard:65282}},css:"ng-businessruletask"},{elementType:"CallActivity",markers:{icon:65285,loopType:{MultiInstance:{parallel:65283,sequential:65284,parallelSubProcessType:{AdHoc:65280}},Standard:65282},SubProcessType:{AdHoc:65280}},cssFont:"bz-cd-svg",css:"ng-callactivity"}]}}).constant("PROCESS_VIEWER_MODULE",{EVENTS:{_FULL_SCREEN:"PROCESS_VIEWER_MODULE._FULL_SCREEN",_SET_SIZE:"PROCESS_VIEWER_MODULE._SET_SIZE",_READY:"PROCESS_VIEWER_MODULE._READY",_UPDATE:"PROCESS_VIEWER_MODULE._UPDATE",_CREATE:"PROCESS_VIEWER_MODULE._CREATE",_SHAPE_CLICK:"PROCESS_VIEWER_MODULE._SHAPE_CLICK",_SHAPE_COMMENT_CLICKED:"PROCESS_VIEWER_MODULE._SHAPE_COMMENT_CLICKED",_DRAWING:"PROCESS_VIEWER_MODULE._DRAWING",_END_DRAWING:"PROCESS_VIEWER_MODULE._END_DRAWING",_REFRESH:"PROCESS_VIEWER_MODULE._REFRESH"},ACTIONS:{FULLSCREEN:"SHOW.FULLSCREEN"},RESOURCES:{BROKE_IMAGE:"iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAAErdZjwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAG2pJREFUeNrsV7tthEAQ3bVOIgMHNHAEJCQIKMB04BLsDuxO3IGvBHdAjkBCIkMENIBOgozkPHM6zitY8C5wkPCkESysZh7zXSi5IYqiC1kX757nnehGxu942tI44sAuTNNcxWiWZX8eIBtjJ7ATeAiBMAyvsjiBoiiEjPPuFyFQliWJ43ibEDRNc78fI6Hr+vROOIY0TXvdjNc5DcO4irAHYCLhQDrJuq6u60VCQNlFVVXPcDl3N4253HVdkuc5URSFWJZFQcc3PH4TnQV0aBMouogQQGiaRhzHof/pkRpGqqpSFIGsPw4ZZ/WgwNJn32H4qWisgiDofYnv+3R2EuCBROZQgkR4ZCYnIWscy+rmqknoEDuChwppAmzsZhjnVcsX6PwU7oQyrhbZB8n8gRXRSvvh3E6YJElPOS/h4F0Al5c5+cclYNv2YD23oeHV9+xTsQiWMrwfyXYCbBL+gLx2p9Ra2Pzv+FcAwRygAKTu09NiaEsMtS6gNwA5YkATIUZRPDo+MOqAEVsUU31sAAbMzMyoGwKkds0fPXpEPQeAxgbQ24vo4MWLF3j5FDkANjry9+9fnGokJCRQ+MREAVlpABQVoF4xNkCMpdjGB0iOe2oN1bAgV42ktnhfvXrF8OXLF4Z///4xqKiogHs+pJpBsE9P4dhAAZDqJ7kyQurPHyDkAwJjAxPQxgcYyBofAPbAsLaYqDY+QM1eMEXjA8TkCDwOQxngIjZ0WPB1QCkJFWQxUJmBy0wWfAYS4wsixwZQchY0FygCQ/wBEyXjQaSkByzZ+T7O8QH0YhZb1AzI+AC1xwZGm2SjDsBIhAMxPgAKgQsDGACCAAHYNXfcBoEgDC+GCokiJVSJBAUlR+AmyRFyE98guUGOwBGSjoIibulSUWcG2RHa7C7s02svv2RZCHvFfOzzn4lUF6U70APMxD+4GGq5rbeuQ8jBC1ciV16NK/EmuAMJXDuAHcAOIGwlNhufpomkaarVhqgESdYHc9oD8Aja972WhzYMgzKcqwKgg8Zrka3KU1VVwvsmekBiO/iLLsY2z9YVBYnwlu3WdU2yLDM2B5zg82gzePo3shDiODbytln653vB4egZvt5kt8IqY30JAkvgUGVZOt0Kb3Ig19wonYkOQY/j+Hctcru3PIsVAIyHQA8YveC5tHNZX6qoU9u2T7qNwHN984YzB0ATmeheXdfNw0b2f0bSCxsFQ/uDnEtjlkmAOTugkxUQQOF11VcI/OjLTpBZsWIDiCLET4DVOAdAGyI6NaUKQa8WQVN6AUjvVgHQM76NsWsq88fYY3zBC2yMAOAtd6pAeLlXXRVFQfI837QSJJp0mWvz2pCxkeXy6jjMA+JT4E78AB/fuDM/4Fa0AwgdQCJ7erq7HuDLtveqQ+AM4RhY7Jgej34FYO+KchMEgigm9b/coP3xy0TrDXqDcgO9QXsC8ATtDeQIHMEb1BPYJib6YyLxAu0MWcyCgCzOsqvM+4GYGJm3s8MwvBl7ZY+Md4oVGP1yVhABw7/hMO7S8qdbH+crLLpmvFj0vzQGTJ0Oo9N5AG79ridC44e6tYBbB0tkOAYwAUwAE8AEMAFMABPABDABGTzYfoGHw+FML4jiy+FwaLcHUFSVUR5XJJZEBeolEaVxAnAKW1XTex1Uia/QM6wlYLfbnVaQQEB1e0Fwu92ezvMDAu+egKIBhNTzIa0moCz4oXJcFVXyWCrpLCkBVYpwjNxNgIbiFEkdxpPnAZeifhOhNGI0Gt1PJmhbPEjeDlO8IVYxbLPZnH223+/NBkEqIuoAp8DIwGkwcRwnR+N3ASRBqLpinW4tf2e9XmeO0vAX19htEC7AFRcR6owHaaOE9Ls96TzOTcMh1zDUdvnj8Th1CiTxGPmbNETJT3b9fh9PvclkEql8V0V+R9YwAT/65EjyVoqoTqE9LlugKgKU5i0XAd+xXzt7W1fTBBCSEX3kCIjBeLeRBxShodI7AuO9NiI9ei0QkHqtB8ZHjbcABRFttspcvAuIGSIkQMOEcctbMD7xAKlfYAmu8UrsEQEc/HTfgfGuYxmKGibIiWhIHgaxOZAWtU1AgsFgEELyMTNkfFks+QJCPtoiID1tlQjFO8rq2q4ylZ4h7URc2zglag3PcJ2/OuoBUzHjb6HB8DeKrjFRjf6R/9xAZIgkHpBPe0NwvxmB8ac+ZAqUVZykTDCEID9TJqAi58dIHZhweRUSdMrkfLE1AhuMV31AU+4crYE5BKGA6jGWCm0KJX0RfIICw99ta6HTWRXOECGGLnzalgq3URb3xao/OhaCJTJMABPABDABTAAT0F1w9zhvgW7DM/73dyaReTnaNRJSNcy/AOydQW7aQBSG3apihQQRFoINShESbJAo4gBwg/QGyQ3aE5TeoDlBe4TcoBwAiT0SChsEGwQbxJLOc+zGGNvYnmHG9vyfhIwCBDPv95sZj/0/P0fJIdv8NUDe8F3wch8BQk/OglRjFdf43wna6Q/B14edc1HEB10HAMDi6SPaQGt+QwCaE+tekTz6yuSNuKewkAE0BwKAAAAEACAAAAEACABAAAACABAA0IRPaAJxkOWJn/kN1Yjt9XrWFgLIGRRwx+smCHeVZBJBEu8sdAEuqDHT4L9Fhc6vBd9PDCIKpGsrAHfg6bmfB5kMNpsNt3ggAI7gO5AHm4psQD5vmAUoDr73da8h3y3pdDpcnzdNEwIQFXwH6g5kZoOkpqZklddsNiGAKCTxIScRyEjRZOtLVr61Wi3S+2kGQO8X5YCf+2kg2Y8nNaVcLBbWVsaUq9FoWA+MAQRC17aJMOCnbJDUvFsH3PbRk7Ts1HK5NHgNSd2QfT1vSYu8EmhhOZ1Ox8a746OFjKuCyfTMXYVCNN1u1ygUCoGvHw4Hax9olF4uZ+9mqbhXBUf2MGWCuGcCeL3lzm+3W+vovzXOuXkvXidvotVqnU3/2YNMK8nzqayVAPzw+jPzQClfti2Ds0CzWq2M4/EY+D4mgkg+lKw9Hmxx3GshAJ8GuOg2okCDPVUFh0gAxWLR76VJv98fCWwbOlBuXshdqQB8fvTQuOI1QNO8NAzQSqWS8/SOBV7qeV67JAFljgfJAvgu3cec/dhXd4pMSVWdxL6vEtqrbGfVb6IE4K6Vo9zI3rZhflTw1an0suftdkMEcOaWnBoB+AjiarfBCYv7aGJoAJu50YH14riBSB8DCBIEpcAZ58ia22I/r3gdQlJROUNgt3HHAr9HmKML4GIqlBFBPBrvBbSEVDSAAGIMJHQipNTF3p5N/MqzALzrAcpqDEkOes8eh/BCxaCe0zQI5RXARYbIkyDsKl49iV+5twUyzqoAzliv13/a7fZTxoJO6X2nej+CFqyMt2V7Kk8zSbUAAlb2UjtAU3hCKpQEdxTt5/P5MxurjZUJIMbKnvJTsLesYiUhG/gSoe2tLMJEMhEuAM6VPSmC8EwbM0PUbBBnQUi4AOwyhkKoVCo/TdMUJgjWMLvT6ZRpT2QSQLVaFSYA4VcF1+t1kf+OCo+5ry+4WpvPi70OPzOAL1m7N/CHp0DqOCTwM7tqHYIvMwMoEMRZhjASXJGEDJAfEHzNBQAgAAABAAgAQAAAAgAQAAgl9okgXcoqIwMAbQTwGc2gsQAGg8GSbUdoCv04K59OoIC0NnxhwbduyQ6ziKH784Zoq9zwlQX9xfvHfwKwd3YrrStRHE9lo1e7WBDx40YFvdWqeL37Bts3sE9w9AnUJ7DnCewb7L5Bey2VHVHwAz8RBb3QUERQ0Z616rTEnrROmkkySf5/yG7ZbWoy65c1a62ZZLoBwLcj/2OE+LQLyLOKxufcv8tOX0g5GP4CRo+lcjwJtCMAZHhMnYq/TIIg+z8AYPxEySIIMvY6gAHjJ0qDdMFvtQAQfT6ULK3aPQACvgSKLvw/9i4ASp5+AwAIAAAACABAyZWrGUFBrBcAeZPbGVvwAOgCIAAAAQAIAEAAAAIAEACAAAAEACAAAAEACABAAAACABAAgAAABAAgAAABAAgAQAAAirp+oAnUiJfKOzw8dPxsfHy8sQGAmGp3d9d4f3/v+PnNzU1jm52dNQYGBtAFxEk7OztdjW/X3t6e8fz8DABUXHFRPY6DgwMA4EXNW5/Ozs5CPY6XlxfpK79dR0dHAMBLsMWyLCtUd+rFiLVaDQD0ovbVyDtF3UF5AC/q1XskGgBekr5dpmlGMnjUJRiMDAD39/cdrySVC1YnTZEB4Pr6uuNnt7e32rhUWfX39wMAWXHA952C7gp4GXcv0qUgFAkAZFO+/f39wI7Jy9NSdKoGag/A6+urq+86BYp+6OfPnz3vyyVhACApt1c1p4pBxQNLS0uu95mamkIQ6HeuHGQ84AaC6elpY2hoCAD4dfXbFWSRiCHoNtybTqcb38lkMtq18Y84egAWF1q4bOylr3Yjncf8I+kBVET0WOU0wgC4if67SZehYwAQ4pUb9tCx1gDw6pH0uqzTQTWHfFUp7KFj7T0ALygoQAh9HeH2IV9VcpMVfHx8JLML4AUGBQicr1hhHJCflTyZ+sDp6alxfn6e7BiAIGgsLSZgqAR1MJ2GfFWmld2Gju0jjldXVwgCBQw5AULR74PpNuSrSp2Gjh8eHr7M8nl7e3OKRThWKiUyCyAI8ul0mkHY9ONAZIZ8/eoK2PAMQLvu7u5a7/ncaSvRtizec1vkw+oqQ0sD6cQ3bCcf2VTNXmjq5nkoJjDF+Tq1RZG2jPg8E4SX1KYOIE6eTzzn9SBUFX3c/k0OODno66L8/Px8VrI9LNryNu/A7aL9hMWUqh+q1WqD9MKrkA663TfMah0P1KRSjs2QIeNbCttng17W/T4fN0U0ju36FDakZXOH0sl82HP5HOboW2T4lErj27tO0T5ZXYLJPp+uqklxot+eZJDTuDrp6emp+bZIhs8E4HVMXYLJPp9PdFmcYEFXD9A8Bkr7smT8fBh/P4Rg0hSpvboYQNLdrtDLtv3qDyMAbFcul0sZmorajNf45eXeJxTFAAUy/logHuC7zEED45s6G1+0WanZpX7nTSWUtRs/cABsJ1URJzMZYiElT8bPGhETtdtaWzBZkdyVS/umb2mgF5XLZU4d/8q6OQXKkPEjXcHr0F2sUhew1Z7V8LiO73UAhTCU6eWXTz9vkeEzRgJUrVb5YlrnEn6372nb/xEHHCyuKPzJAhl/zYCiAYANhA3DewUtS8Y3YW4HAMhV1DkqJ1dR0RwETof+xCnF0wmAVntFAATu2y4kU7wsTOwOgCiB0G3wiVO8IszbOwCRAcEhc4hlihcWAK0gyqmIkEQJz/NofFbkNqMOmywADc3MzHBJ8jLBxue0dLvDxzzy+S8BUYkzAM23iQOBjM8ZyG8Xu5jCQ5TiCECiQCDjPxo9zHRqkyWAKMQJgNiDQMav+/jzBdFtXEYdgNiBQIafMz4HqIJU4HGE6uHgi1qtVqdtIuLGXw3B+IaIMcrHx8d10Y5/xSSayADwBQRRtYua8dnwW2Eeg+3uJfZC2wIG3h7F7GJtu4CWeM697U7fyTD7uYCDPWVaWFiQ+VqRg8teu17fAOgw119LEGzFHa3ETyOdm5tztc/JyQnHD5uyFVxfAOCbKr+ZnKgNCCEFe9IaGxszRkdH3QDQ/l+XAohiYABI3uljCRCsEI3P/em6obnYC8g+m1jyziAGYsMXAHimr8ubPUIBQQR7c0ZEJBkPuH6+kvIsoIc7fRr9Lwdgoi8Owvj1KBmf5dfTT5U+KNLjXT5NEHzzCLoGe7Jty083cRMPBA4Ap34ctHhUw0jkyqyRkRGuLCoBgfLnX9SAZQPyD4Dh4WGVP9cAgQzX8AheQKDfaMwwVn31AIBg5AkE2o+njU3A1AEFgQGA8CgeRiFj/DqMHx8ApEHg/xfGh2IIQFcQxOjZI0wbnxjATYzA4+krMGsyPIATCDB+ggGAAAAEACAAAAEACABAAAACABAAgAAABAAgAAABAAgAQAAAAgDQp1zNCFK9rDsEDwABAAgAQGGpBACSrTUGYBntkEwtLi5e9tE/JTRFIpWzxwAZtEeiZDYfItVaTqVarWr9sCRImb4sI9dn6w9MeILYq9C+hqDjgkrkDXpaoAnSVhUyfM7pg/8EaO9cV6NIwjBcE0XFQxghiAeUUUFUFKLk/06uwHgFTq7AzRWoV2C8ArNXsLtXkOz/CTuLoj9EGRSPeBgiCirq1tupDpMxkzn2qep5oB1yMJNU9/fU91VXdfW9o5a9KGr25ZpJblNHABghyO1xZ9CirrRNwGuxrZ6ZXKNtAYqX7pn154G2BhKAKwb1MLUybQhQ/KLfrG/+2NhWAK7HV+BP02YA3tFwImj9IgAb/FUX/ADgN5u2gp5wg3sEP0AYLLsOf10Apvs2yADgrwTKsQAAIDxuIwCAcKkhAIDAQQAAAZPYPjGD7C8PAFuT9JNYyAAAKAEAAAEAAAIAAAQAAAgAABAAACAAAEAAAIAAAAABAAACAAAEAAAIAAAQAAAgAABAAACAAAAAAQAAAgAABAAACAAA0mInTQB55fv372Ztbc18/PjRfP78OfqcPt69e3d0iAMHDpjJycnoFRAAFJgvX76Yp0+fmg8fPvT8Ph2xEJ4/f77xtR07dpjDhw+bY8eO0aAIAIrA27dvzZMnT8aWNUgIOiSDc+fOmb1799LICCBbWq2W+fr1qzl06BCN4VBq//Dhw0RLiPv370flwoULFyIhwGYYBEzpQn/8+LF59uyZuXfvXnRhho56/CSDv7NkWF1djc4DIIBUUa/fvr+bPm40Gubdu3fBtonqfKX9aSPhxIOJgABSCX71+FvRbDajCzK0bEAB+OrVq8ze/9GjR1yYCCB5FNgPHjzoGQzKBjQ+EAq9RvjTKAcoBRBA4sE/SK2v8YG06uGsIfgQgPeo5x80tVc2EMJAFRN2EIDXqOdX7T8sGjBsHzT0Dc3ayxLdCkRCCCARFLijBH97mqxswMcRawXf1NRUZu9/6tQpLlQEkEzwjzt917iAxgd8Q0GYRSag9z148CAXKwIYL7qll1TtrjsEulPgWzZw9uxZc+LEidTSfs0EzDLzyCtMBR5D8Cc9qUcDisoGNI34+PHj3rSdFu3o0KzApCYGqdcn8BFAIrx8+TLVGX1v3ryJ3u/8+fNm165dXpUEOjRHQLME45V+w6Ly4uTJkxtLhgEBJBKML168SP194zkGR48eNUeOHPGqTVWft9foEoJKKy353aoEUmq/b98+Uy6Xo/9HwCOAVFAvrIU9WSL5vH792ly8eNHbVW6dQoDxwyDggGhQTnV/HlA2oAFCZSMACCBh4mW9eYNlxjC0AGZmZkr2dd4eTZqjO53LevP4+4W+zBgGp7TVJ+v1etW+XLfH3LA/+MyZM14Ff7dlvXlEj8BS+/MEnOKTZKejzr/UzzdaIVTsS81JoRySAAZd2ZcnTp8+HY2Qj8r79++jQyPuvt15QABDYqUgIdywR8VXARQ5+NuzAT0Ycxh0P14P1/zx48emz2syErfcAhdAl7JBQqj6IoBRV/blCZ2PQVbBaZLTp0+fun5dk214wCkC6Mra2lrFCWGu37KB4E8WCaCXmBX0Cv5+mJiYiObz79z5y3SSFXtctZJodVwT6hyuuE5imvD2WABbCKHsZNC1bMhTo/v8YI6tnpWvNF+3E799+zbwz9M4w9TUlIJ93gb9X0NeH9NODLEgwCcBdDnpm8oGgj89FLQaJBRaiDPCcwmX7LFw+fLlVoLXScV1Hr+ZEe5MIYCcCWCbsqGWxfunsbIvT8Rz6UuDXwZNpfg26Bs5uWaqbXIoI4CCCqBL2SAZXE+6bAgt+NvRiP6ePXv6+dZbNuhvFuXvctdPe1lRQQAFEkCXkzrnhDC2skGDXlms7MsTygL2798fDex10HC9fdO3v9ldS3HmUEEAxTyJI5UNWkiT9cq+PKFMwN3jn7dBvxRqO7jxqTh7mPZIANFgrQ3+aLC25OGJU9r3u+lj1qJS/rys7MsJuijmZ2dnWzTFttdYancsxiiAFWVyNvA3ndtSICdM2cG19pOlUW8fH7g5ZI9w1Qb9Ck0xtow0Li2qZsRByTEIQL1910yuFOhJml5dXb1uMrrbkBOWbNDPE7KpZ6ft4w7lhASgcZvZzt4eAXRheXm577Kh4DRdb9/grOdSDu1lRWUIASzYoF8c5D8ggO5SUHaQ+1mLfXLLBv1Nzmpxqdfr7WXFdEdvrzR/KKkjgP6FUHXjCEUpG6I0kAE9QADhlA0K9gUb9EucIehLADa1WFaKaFOIFZqjsGUDt+9gaAH87PjcCkIYa9kw0qPVevT23L6DsQvAIITEhFBxQqiNUDYs2qBfoDUhLQEghOzLhoZL8bl9B5kLACEkXzbEz0jQgN4irQJ5FkAnS04ITZoXrNB0z3p5m5Kn6TqRf/Rqhcd1U3ABbOCePxcJYXJykhMbVuDfNuu3ScfBhiBUDnG3o1gC2DJDQAheBn3Fvvxp0l8+255FNBgrybcAEIJ/gV+zL3dz/muSReRUAAihmEFfdr191ZM/Kc4i/nNjEQ0EkI0AEEK+A7/qAr8c0t/t9lTYKDMkic59DxBAMgJACPkIfKX4tdDboccOS5uyCHuNNhBAAnTs2RcJgdtHiQT9tOvtK7TGL9nAKGMRjXg8IussopAC6LFtF0IYPfB1++42LTFSNjDKWES7IBoIoP/gRwjDB71qek3YYc++9LKBvtjiqUCbsoh+Hv3lhQDGtG2XhLDAbaCNwK+53r5Ma+QuG+gmgF60TNttz+2eFlQYAegJviPsX7ddQ90x6yvsWgEFvYJdg3pzhG7+s4GENgeRFP4ohABS3LbLayH0MS8fcpgNJLk7UO4FoF17tHtPRnghhDHPy4eUs4FgBZDDPfsKIwTX2yvNZ1Cv4NlA0BlAztkQQl5mhbldkO4Sev6QpAAmaN6RUC2th3d8sIH30x56vek2eUgz6Mv2WNbvQPADAghECNreWu+h9zP+LMoBBIAQegT+XdfbB7coBxBAkELQhqbu+xX4NZoSEEAAQnAfK+j/pbeHcbOTJsilEG7YoKc1gAwAABAAACAAAEAAAIAAAAABAAACAAAEAAAIAAAQAAAgAABAAACAAAAAAQAgAJoAAAEAQIAk+kCQJB9nDABkAACAAABgWAE0aAaAIGlIAHdoB4AguVPSv/V6XVtGV2kPgGBYmZmZmS3FH1kJ6Lnz7CQLEEDqb4P/UjwGEOE+sUjbAHjNYhz8otT5VZsJVAy70AD4hravv2SDv9n+yVK373Yi+JOyAKDY6b49rnYGfk8BdMigal9uIwOAwgT9gg36lV7fWBrmp7vsQFK4Yo8KYgDILNDVs/9t1kf1m4P+gP8BFeSD6LW3Ya0AAAAASUVORK5CYII="},ACTION_MENU:{OPTIONS:[{name:gettext("Show Comments"),url:"SHOW.COMMENTS",img:"comments",css:"bz-cd-comments-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]},{name:gettext("Show Model Activity"),url:"SHOW.NOTIFICATIONS",img:"notifications",css:"bz-cd-notification-option",state:"enabled",type:"icon",roles:["Admin","Designer","Viewer"],access:["Editor","Contributor"]}],ACTIONS:[{name:"Open in Modeler",action:"OPEN.MODELER",url:"",css:"bz-cd-open-workspace-option",img:"comments",type:"button",roles:["Admin","Designer"],access:["Editor"]}]}}),angular.module("processViewerModule").controller("ProcessViewerController",function($scope,$rootScope,$state,$stateParams,$timeout,applicationServices,$data,APP,PROCESS_VIEWER_MODULE){$scope.setDefaults=function(){$scope.selectedWorkspace=$data.$selectedWorkspace(),$scope.userProfile=$data.$userProfile(),$scope.endDrawProcessViewer=!1,$scope.workspaceId=$stateParams.workspaceId||$scope.selectedWorkspace.id,$scope.diagramId=$stateParams.diagramId||$scope.selectedDiagram.id,$scope.processJSON={},$scope.shapeListWithComments=[],$scope.attributes="Show Attributes",$scope.unavailableImage="",$scope.zoom=1,$scope.tryouts=0,$scope.createWatchers()},$scope.createWatchers=function(){$scope.$watch("shapeListWithComments",function(newValue,oldValue){var newValueJoin=newValue.join(),oldValueJoin=oldValue.join();newValueJoin!==oldValueJoin&&$scope.endDrawProcessViewer&&$scope.createIconsCommentsOnShapes()})},$scope.setDiagramId=function(id){$scope.diagramId=id},$scope.setupProcessViewerObject=function(){var dataUser={diagram:{},workspace:{}};return $scope.userProfile&&(dataUser.token=$data.$login().access_token,dataUser.user=$scope.userProfile.userName64,dataUser.diagram.id=$scope.diagramId,dataUser.workspace.id=$scope.workspaceId),dataUser},$scope.update=function(e,data){data.hasOwnProperty("comments")&&($scope.shapeListWithComments=data.comments)},$scope.createProcessViewer=function(event,data){data&&($scope.processJSON=data)},$scope.endDrawing=function(){$scope.endDrawProcessViewer=!0,$scope.createIconsCommentsOnShapes()},$scope.utf16Encode=function(input){var value,output="";if(value=input,55296===(63488&value))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");return value>65535&&(value-=65536,output.push(String.fromCharCode(value>>>10&1023|55296)),value=56320|1023&value),output=String.fromCharCode(value)},$scope.extendSVGElement=function(svg){var itemRaphael=$.extend(svg,Raphael._engine);return itemRaphael[0]=svg,itemRaphael.node=svg,itemRaphael},$scope.createIconsCommentsOnShapes=function(){if($scope.shapeListWithComments.length){var parentSVG,parentPaper,idParent,createdCommentsIcons=angular.element(".bz-cd-icon-comment-shape");_.each(createdCommentsIcons,function(item){var elItem=angular.element(item),parentRemove=elItem.closest("svg");parentRemove.remove()}),_.each($scope.shapeListWithComments,function(item){var iconComment,elItem=angular.element("#"+item),positionsElItem={},sizeParent={},elItemCords={};if(elItem.length){try{elItemCords={x:elItem[0].getBBox().x,y:elItem[0].getBBox().y}}catch(e){elItemCords=elItem.attr("x")?{x:elItem.attr("x"),y:elItem.attr("y")}:{x:elItem.attr("cx"),y:elItem.attr("cy")}}if(elItemCords.hasOwnProperty("x")){if(positionsElItem.x=parseFloat(elItemCords.x)+8,positionsElItem.y=parseFloat(elItemCords.y)-10,positionsElItem.y=positionsElItem.y<=0?10:positionsElItem.y,positionsElItem.x=positionsElItem.x<=0?8:positionsElItem.x,parentTmp=elItem.closest("svg"),sizeParent.w=parentTmp.attr("width"),sizeParent.h=parentTmp.attr("height"),!parentSVG||parentTmp.attr("id")!==idParent){parentSVG=parentTmp,idParent=parentSVG.attr("id");var canvasTmp=parentSVG.find("#"+idParent+"_addOns");parentPaper=new Raphael(canvasTmp[0],sizeParent.w,sizeParent.h)}iconComment=parentPaper.text(positionsElItem.x,positionsElItem.y,$scope.utf16Encode(61701)),iconComment.attr({"font-family":"bz-modeler-font","font-size":16,fill:"rgb(231, 132, 26)"}),iconComment.node.setAttribute("data-parent-id",item),iconComment.node.setAttribute("class","bz-cd-icon-comment-shape"),iconComment.click(function(){var _self=this;$scope.showCommentsOfShapes({target:_self})})}}})}},$scope.showCommentsOfShapes=function(event){var parentId,nameShape,nameTemp,ui={};if("text"===event.target.tagName)var target=event.target.previousSibling;else var target=event.target;parentId=target.parentNode.attributes["data-parent-id"]?target.parentNode.attributes["data-parent-id"].value:target.attributes["data-parent-id"]?target.attributes["data-parent-id"].value:target.attributes.id.value,""===angular.element("#"+parentId).data("display-name")||"undefined"===angular.element("#"+parentId).data("display-name")?(nameTemp=angular.element("#"+parentId).data("type")||ngular.element("#"+parentId).data("name"),nameShape=nameTemp.replace(/_/g," ")):nameShape=angular.element("#"+parentId).data("display-name");var descriptionShape=angular.element("#"+parentId).data("description")||"",dataType=angular.element("#"+parentId).data("type")||"";ui={id:parentId.replace("clone_",""),name:nameShape,description:descriptionShape,type:dataType},$rootScope.$emit(PROCESS_VIEWER_MODULE.EVENTS._SHAPE_COMMENT_CLICKED,ui)},$scope.setDefaults();var dataUser=$scope.setupProcessViewerObject();$rootScope.$on(PROCESS_VIEWER_MODULE.EVENTS._CREATE,$scope.createProcessViewer),$rootScope.$on(PROCESS_VIEWER_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(PROCESS_VIEWER_MODULE.EVENTS._END_DRAWING,$scope.endDrawing),$rootScope.$off("shapeClicked"),$rootScope.$on("shapeClicked",function(event,data){data.svg&&data.svg[0]?$scope.showCommentsOfShapes({target:data.svg[0]}):$scope.showCommentsOfShapes({target:data.svg})}),$rootScope.$emit(PROCESS_VIEWER_MODULE.EVENTS._READY,dataUser)}),angular.module("processViewerModule").directive("viewerSvg",function(){return{restrict:"A",require:"^ngModel",scope:{ngModel:"="},templateUrl:"views/viewer.view.html",controller:"ViewerController",link:function(scope,element){var svgContainer=angular.element(element).find(".viewer-svg")[0];scope.paper=new Raphael(svgContainer,100,100)}}}),angular.module("processViewerModule").directive("heightProcessViewerDirective",function(){return{restrict:"A",controller:function($scope,$rootScope,PROCESS_VIEWER_MODULE){$scope.getDimentions=function(){var header=angular.element("header").outerHeight(),pageHeight=angular.element(window).height(),hfTotal=pageHeight-header-44;angular.element(".processviewer-container").height(hfTotal)};setTimeout(function(){$scope.getDimentions()},1e3);angular.element(window).resize($scope.getDimentions),$rootScope.$on(PROCESS_VIEWER_MODULE.EVENTS._SET_SIZE,$scope.getDimentions)},link:function($rootScope,$element){}}}),angular.module("processViewerModule").directive("htmlRenderProcessViewer",function(){return{restrict:"A",require:"^ngModel",scope:{ngModel:"="},link:function(scope,element){scope.cleanHTML=function(){var formattedHtml="";return scope.ngModel&&(formattedHtml=scope.ngModel.toString().replace(/[\\]*["]/g,'"').replace(/([\\]+t)/g,"").replace(/([\\]+r)/g,"").replace(/([\\]+n)/g,"<br>")),formattedHtml},element.html(scope.cleanHTML()),element.find("a").attr("target","_blank")}}}),angular.module("processViewerModule").factory("ProcessViewerObject",function(){function drawElement(){var _type="drawElement";this.bpm=null,this.elementType=null,this.inMainProcess=!1,this.getType=function(eType){return eType?_type===eType:_type}}function drawObject(elType,canvas,attrs,data,svgType){var _type="drawObject";this.elType=elType||null,this.canvas=canvas||null,this.attrs=attrs||null,this.data=data||null,this.svgType=svgType||null,this.getType=function(eType){return eType?_type===eType:_type}}return{drawElement:drawElement,drawObject:drawObject}}).controller("ViewerController",function($scope,$rootScope,$timeout,gettextCatalog,$http,$element,BPM,APP,PROCESS_VIEWER_MODULE,ProcessViewerObject){$scope.isDraggable=!0,$scope.scale=1,$scope.indScale=.2,$scope.loadSVGIcons=[],$scope.paddingPool=0,$scope.isDrawed=!1,$scope.renderingLabel=gettext("Rendering"),$scope.authorLabel=gettext("Author"),$scope.descriptionLabel=gettext("Description"),$scope.versionLabel=gettext("Version"),$scope.textBoxSVG=!1,$scope.constant={lane:{width:30}},$scope.totalHeight=$scope.initialHeight=200,$scope.totalWidth=$scope.initialWidth=200,$scope.isFirefox=-1!=navigator.userAgent.indexOf("Firefox"),$scope.isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,$scope.pwEvents={SHAPE_CLICKED:"shapeClicked",SELECTED_SHAPE:"selectedShape"},$scope.artifacts=[],$scope.messageflow=[],$scope.setElementsArrays=function(){$scope.connector=[],$scope.sequenceflow=[],$scope.activities=[],$scope.swimlanes=[],$scope.artifacts=[],$scope.events=[],$scope.gateways=[],$scope.data=[],$scope.association=[],$scope.hasMilestone=!1},$scope.createViewer=function(){$scope.paper.clear(),$scope.createViewerCanvas(),$scope.addHandlers()},$scope.addHandlers=function(){$rootScope.$on($scope.pwEvents.SELECTED_SHAPE,$scope.selectedShape)},$scope.selectedShape=function(e,data){var canvasElements=angular.element(".shape_active",$scope.paper.canvas);if(_.each(canvasElements,function(item){$scope.extendSVGElement(item).removeClass("shape_active")}),data.svg)data.svg.addClass("shape_active");else if(data.id){var id=data.id,canvasElementById=angular.element("#"+id,$scope.paper.canvas)[0];$scope.extendSVGElement(canvasElementById).addClass("shape_active")}},$scope.updateSizeViewer=function(w,h){$scope.paper.canvas.setAttribute("width",w),$scope.paper.canvas.setAttribute("height",h)},$scope.$watch("scale",function(){$scope.refreshHTMLObjects()}),$scope.findProcess=function(value){var findedProcess=_.find($scope.processes,function(process){var baref=value.processRef.baref.ref.indexOf("-")>-1?value.processRef.baref.ref.replace(/-/g,""):value.processRef.baref.ref,id=process.children[0].id.indexOf("-")>-1?process.children[0].id.replace(/-/g,""):process.children[0].id;return id===baref?process:void 0});return findedProcess},$scope.createViewerCanvas=function(){var findedPools,paralellArtifacts;if($scope.headerArtifacts=[],$scope.diagramId=$scope.ngModel.diagram.id,$scope.diagramData={
name:$scope.ngModel.diagram.content.hasOwnProperty("displayName")?$scope.ngModel.diagram.content.displayName:"",author:$scope.ngModel.diagram.children[0].content.hasOwnProperty("author")?$scope.ngModel.diagram.children[0].content.author:"",version:$scope.ngModel.diagram.children[0].content.hasOwnProperty("version")?$scope.ngModel.diagram.children[0].content.version:"",description:$scope.ngModel.diagram.children[0].content.hasOwnProperty("description")?$scope.ngModel.diagram.children[0].content.description:""},$scope.participants=$scope.ngModel.diagram.children[0].content.participants,$scope.diagramChildren=$scope.ngModel.diagram.children[0].children,paralellArtifacts=_.findWhere($scope.diagramChildren,{type:"Artifact"}))if(paralellArtifacts.hasOwnProperty("content"))$scope.createShape(paralellArtifacts,$scope.paper);else for(var pA=0,pAl=paralellArtifacts.length;pAl>pA;pA++)$scope.drawShapeByType(paralellArtifacts[0],$scope.paper);$scope.wrapper=$scope.paper.group(),$scope.parallelWrapper=$scope.paper.group(),angular.element($scope.parallelWrapper[0]).attr("id",$scope.diagramId+"_addOns"),findedPools=_.findWhere($scope.diagramChildren,{type:"DiagramGraphicsInfo"}),$scope.pools=findedPools.content.pools,$scope.messageflow=findedPools.content.messageFlows;for(var i=0;i<$scope.messageflow.length;i++)$scope.messageflow[i].elType="MessageFlow";$scope.processes=$scope.ngModel.processes,$scope.paper.canvas.setAttribute("id",$scope.diagramId),$scope.isDraggable&&angular.element(".viewer-svg").draggable({start:function(){$scope.isDragging=!0},drag:function(){$scope.isDragging=!0},stop:function(){$timeout(function(){$scope.isDragging=!1},200)}});for(var i=0,participantLength=$scope.participants.length;participantLength>i;i++){var value,finded,findedProcess,pool,poolGroup;value=$scope.participants[i],finded=_.findWhere($scope.pools,{id:value.id}),pool=new Raphael($scope.wrapper.canvas,200,200),pool.canvas.setAttribute("class","bz-cd-processviewer-container"),finded&&!finded.isMainPool&&finded.location?(pool.canvas.setAttribute("x",finded.location.x),pool.canvas.setAttribute("y",finded.location.y),pool.canvas.setAttribute("id",value.id),poolGroup=pool.group(),findedProcess=$scope.findProcess(value),findedProcess&&$scope.drawProcessElements(findedProcess,poolGroup,pool,!1)):(findedProcess=$scope.findProcess(value),$scope.paddingPool=30,findedProcess&&$scope.drawProcessElements(findedProcess,$scope.parallelWrapper,pool,!0))}$scope.totalHeight<$scope.paper.canvas.getBBox().height&&($scope.totalHeight=$scope.paper.canvas.getBBox().height+2*$scope.paper.canvas.getBBox().y),$scope.totalWidth<$scope.paper.canvas.getBBox().width&&($scope.totalWidth=$scope.paper.canvas.getBBox().width+$scope.paper.canvas.getBBox().x),$scope.initialHeight=$scope.totalHeight,$scope.initialWidth=$scope.totalWidth,$scope.updateSizeViewer($scope.totalWidth,$scope.totalHeight),$scope.isDrawed=!0,$rootScope.$emit(PROCESS_VIEWER_MODULE.EVENTS._END_DRAWING)},$scope.drawProcessElements=function(process,poolGroup,pool,outOfPool){var processElements=outOfPool?process.children[0].children.concat($scope.diagramChildren):process.children[0].children;$scope.setElementsArrays();for(var i=0,elLength=processElements.length;elLength>i;i++)if("Milestone"===processElements[i].type){$scope.hasMilestone=!0;break}for(var i=0,elLength=processElements.length;elLength>i;i++)if("ElementGraphicsInfo"===processElements[i].type){var pointsPoolRect=[],anchoPR=processElements[i].content.size.width,altoPR=processElements[i].content.size.height;if(0!==anchoPR&&0!==altoPR){$scope.hasMilestone>0?(pointsPoolRect.push({x:0,y:0}),pointsPoolRect.push({x:anchoPR,y:0}),pointsPoolRect.push({x:anchoPR+8,y:10}),pointsPoolRect.push({x:anchoPR,y:20}),pointsPoolRect.push({x:anchoPR,y:altoPR}),pointsPoolRect.push({x:0,y:altoPR}),pointsPoolRect.push({x:0,y:0})):(pointsPoolRect.push({x:0,y:0}),pointsPoolRect.push({x:anchoPR,y:0}),pointsPoolRect.push({x:anchoPR,y:altoPR}),pointsPoolRect.push({x:0,y:altoPR}),pointsPoolRect.push({x:0,y:0}));var poolRect=poolGroup.path($scope.getPathString(pointsPoolRect)),poolRectTitle=poolGroup.path($scope.getPathString([{x:50,y:0},{x:50,y:altoPR}]));poolRect.addClass("ng-process-pool"),poolRectTitle.addClass("ng-process-pool"),poolRect.setDisplayName($scope.getDefinitionAttribute(process,"displayName")),poolRect.setName($scope.getDefinitionAttribute(process,"displayName")),pool.canvas.setAttribute("data-type","processpool"),pool.canvas.setAttribute("data-display-name",$scope.getDefinitionAttribute(process,"displayName")),poolRect.setId(pool.canvas.id),$scope.addCommonHandlers(poolRect);var poolY=pool.canvas.getAttribute("y")||800,totalHeight=processElements[i].content.size.height+parseFloat(poolY);totalHeight>$scope.totalHeight&&($scope.totalHeight=totalHeight+80);var totalWidth=processElements[i].content.size.width+parseFloat(pool.canvas.getAttribute("x"));if(totalWidth>$scope.totalWidth&&($scope.totalWidth=totalWidth+80),processElements[i].content.borderVisible&&poolRect.attr("stroke",processElements[i].content.borderColor),pool.canvas.setAttribute("width",processElements[i].content.size.width),pool.canvas.setAttribute("height",processElements[i].content.size.height),!outOfPool){var titleProcess=$scope.createText(process.content.displayName,{position:{x:25,y:processElements[i].content.size.height/2}},poolGroup,pool);titleProcess.rotate(-90)}var visualAttrs;visualAttrs={svgStyle:{backgroundColor:$scope.getDefinitionAttribute(processElements[i],"backgroundColor"),borderVisible:$scope.getDefinitionAttribute(processElements[i],"borderVisible"),borderColor:$scope.getDefinitionAttribute(processElements[i],"borderColor")}},$scope.setBPMVisualAttrs("POOL",{attrs:visualAttrs,elType:"ProcessPool"},{canvasShape:poolRect})}}else processElements[i].content.elementType&&$scope.createShape(processElements[i],poolGroup);if(outOfPool){var swimlanesOOP=new ProcessViewerObject.drawElement;swimlanesOOP.bpm="SWIMLANES",swimlanesOOP.inMainProcess=!0;var dataOOP=new ProcessViewerObject.drawElement;dataOOP.bpm="DATA",dataOOP.inMainProcess=!0;var activitiesOOP=new ProcessViewerObject.drawElement;activitiesOOP.bpm="ACTIVITIES",activitiesOOP.inMainProcess=!0;var gatewaysOOP=new ProcessViewerObject.drawElement;gatewaysOOP.bpm="GATEWAYS",gatewaysOOP.inMainProcess=!0;var artifactsOOP=new ProcessViewerObject.drawElement;artifactsOOP.bpm="ARTIFACTS",artifactsOOP.inMainProcess=!0;var connectorSFOOP=new ProcessViewerObject.drawElement;connectorSFOOP.bpm="CONNECTOR",connectorSFOOP.elementType="SequenceFlow",connectorSFOOP.inMainProcess=!0;var connectorAOOP=new ProcessViewerObject.drawElement;connectorAOOP.bpm="CONNECTOR",connectorAOOP.elementType="Association",connectorAOOP.inMainProcess=!0;var connectorMFOOP=new ProcessViewerObject.drawElement;connectorMFOOP.bpm="CONNECTOR",connectorMFOOP.elementType="MessageFlow",connectorMFOOP.inMainProcess=!0;var eventsOOP=new ProcessViewerObject.drawElement;eventsOOP.bpm="EVENTS",eventsOOP.inMainProcess=!0,$scope.drawElements(swimlanesOOP),$scope.drawElements(dataOOP),$scope.drawElements(activitiesOOP),$scope.drawElements(gatewaysOOP),$scope.drawElements(artifactsOOP),$scope.drawElements(connectorSFOOP),$scope.drawElements(connectorAOOP),$scope.drawElements(connectorMFOOP),$scope.drawElements(eventsOOP)}else{var swimlanes=new ProcessViewerObject.drawElement;swimlanes.bpm="SWIMLANES";var data=new ProcessViewerObject.drawElement;data.bpm="DATA";var activities=new ProcessViewerObject.drawElement;activities.bpm="ACTIVITIES";var gateways=new ProcessViewerObject.drawElement;gateways.bpm="GATEWAYS";var artifacts=new ProcessViewerObject.drawElement;artifacts.bpm="ARTIFACTS";var connectorSF=new ProcessViewerObject.drawElement;connectorSF.bpm="CONNECTOR",connectorSF.elementType="SequenceFlow";var connectorA=new ProcessViewerObject.drawElement;connectorA.bpm="CONNECTOR",connectorA.elementType="Association";var connectorMF=new ProcessViewerObject.drawElement;connectorMF.bpm="CONNECTOR",connectorMF.elementType="MessageFlow";var events=new ProcessViewerObject.drawElement;events.bpm="EVENTS",$scope.drawElements(swimlanes),$scope.drawElements(data),$scope.drawElements(activities),$scope.drawElements(gateways),$scope.drawElements(artifacts),$scope.drawElements(connectorSF),$scope.drawElements(connectorA),$scope.drawElements(connectorMF),$scope.drawElements(events)}var poolGroupAddOns=pool.group()[0];angular.element(poolGroupAddOns).attr("id",pool.canvas.getAttribute("id")+"_addOns")},$scope.drawShapeByType=function(data,canvas,attrs){attrs.id=data.id,attrs.name=data.name;var drawObject=new ProcessViewerObject.drawObject($scope.getDefinitionAttribute(data,"elementType"),canvas,attrs,data);$scope.validateElementType("ACTIVITIES",drawObject.elType).validType?(drawObject.svgType=BPM.ACTIVITIES.svg,$scope.activities.push(drawObject)):$scope.validateElementType("SWIMLANES",drawObject.elType).validType?(drawObject.svgType=BPM.SWIMLANES.svg,$scope.swimlanes.push(drawObject)):$scope.validateElementType("DATA",drawObject.elType).validType?(drawObject.svgType=BPM.DATA.svg,$scope.data.push(drawObject)):$scope.validateElementType("EVENTS",drawObject.elType).validType?(drawObject.svgType=BPM.EVENTS.svg,$scope.events.push(drawObject)):$scope.validateElementType("GATEWAYS",drawObject.elType).validType?(drawObject.svgType=BPM.GATEWAYS.svg,$scope.gateways.push(drawObject)):$scope.validateElementType("ARTIFACTS",drawObject.elType).validType?(drawObject.svgType=BPM.EVENTS.svg,$scope.artifacts.push(drawObject)):$scope.validateElementType("CONNECTOR",drawObject.elType).validType&&(drawObject.svgType=BPM.EVENTS.svg,"Association"===drawObject.elType?$scope.association.push(drawObject):"SequenceFlow"===drawObject.elType&&$scope.sequenceflow.push(drawObject))},$scope.drawElements=function(drawElementObject){if(drawElementObject.getType("drawElement")){var bpmnDef,elements,bgColor,bgVisible,bdrColor,el,displayName,drawedObject,isValidString=drawElementObject.bpm&&"string"==typeof drawElementObject.bpm;if(bpmnDef=null!==drawElementObject.elementType?drawElementObject.elementType.toLowerCase():drawElementObject.bpm.toLowerCase(),isValidString&&$scope.hasOwnProperty(bpmnDef)){elements=$scope[bpmnDef];for(var i=0,l=elements.length;l>i;i++){el=elements[i];var visualAttrs;el&&el.data&&(bgColor=$scope.getGraphicAttribute(el.data,"backgroundColor"),bgVisible=$scope.getGraphicAttribute(el.data,"borderVisible"),bdrColor=$scope.getGraphicAttribute(el.data,"borderColor"),visualAttrs={svgStyle:{backgroundColor:bgColor,borderVisible:bgVisible,borderColor:bdrColor}},angular.extend(el.attrs,visualAttrs));var methodNameByType=el.elType?"draw"+el.elType.replace(/^[a-z]/,$scope.capitalizeString):"drawUnknown",methodNameByBPMNDef="draw"+bpmnDef.replace(/^[a-z]/,$scope.capitalizeString);if(drawedObject=$scope.hasOwnProperty(methodNameByBPMNDef)?$scope[methodNameByBPMNDef](el,drawElementObject.inMainProcess):$scope[methodNameByType](el,drawElementObject.inMainProcess),drawedObject&&drawedObject.hasOwnProperty("canvasShape")&&drawedObject.canvasShape){var id=el&&el.data&&el.data.id?el.data.id:el.id,name=el&&el.data&&el.data.name?el.data.name:bpmnDef,displayName=el&&el.data&&el.data.content&&el.data.content.displayName?el.data.content.displayName:bpmnDef;drawedObject.canvasShape.setId(id),drawedObject.canvasShape.setName(name),drawedObject.canvasShape.setDisplayName(displayName),drawedObject.canvasShape.setParentId(id),$scope.addCommonHandlers(drawedObject.canvasShape),drawedObject.hasOwnProperty("clone")&&(drawedObject.clone.setId("clone_"+id),drawedObject.clone.setName("clone_"+name),drawedObject.clone.setDisplayName(displayName),drawedObject.clone.setParentId(id),$scope.addCommonHandlers(drawedObject.clone)),el&&el.data&&$scope.setBPMVisualAttrs(drawElementObject.bpm,el,drawedObject),$scope.createDisplayName(el,drawedObject)}}}}},$scope.createDisplayName=function(el,drawedObject){var dName,displayName=el&&el.data?$scope.getDefinitionAttribute(el.data,"displayName"):void 0,displayTextContent=$scope.getDefinitionAttribute(el.data,"text");if(displayName){var canvasParent=drawedObject.canvasShape.getBBox();el&&el.data&&el.data.content&&el.data.content.flowNodeType&&("Gateway"===el.data.content.flowNodeType||"Event"===el.data.content.flowNodeType)?(el.attrs.posY=el.attrs.position.y+1.2*canvasParent.height,el.attrs.width=2.5*el.attrs.size.width,el.attrs["vertical-align"]="bottom",dName=$scope.createText(displayName,el.attrs,el.canvas,drawedObject.canvasShape)):el&&el.elType&&("SubProcess"===el.elType||"CallActivity"===el.elType)?(el.attrs.posY=el.attrs.position.y+1.4*canvasParent.height,el.attrs.width=2.5*el.attrs.size.width,dName=$scope.createText(displayName,el.attrs,el.canvas,drawedObject.canvasShape)):el&&el.elType&&"CustomArtifact"===el.elType?(el.attrs.posY=el.attrs.position.y+canvasParent.height,el.attrs.width=2.5*el.attrs.size.width,dName=$scope.createText(displayName,el.attrs,el.canvas,drawedObject.canvasShape)):dName=$scope.createText(displayName,el.attrs,el.canvas,drawedObject.canvasShape),el&&el.data&&el.data.content&&el.data.content.elementType&&("Lane"===el.data.content.elementType?(el.attrs.svgStyle.backgroundColor="none",dName.attr("x",65),dName.rotate(-90),el.canvas.path("M"+(el.attrs.position.x+$scope.constant.lane.width)+","+el.attrs.position.y+" L"+(el.attrs.position.x+$scope.constant.lane.width)+","+(el.attrs.position.y+el.attrs.size.height)).addClass("ng-path-lane")):"Milestone"===el.data.content.elementType&&dName.attr("y",15))}displayTextContent&&displayTextContent.hasOwnProperty("content")&&(dName=$scope.createText(displayTextContent.content,el.attrs,el.canvas,drawedObject.canvasShape)),dName&&(dName.addClass("svg-displayname"),$scope.addCommonHandlers(dName))},$scope.capitalizeString=function(m){return m.toUpperCase()},$scope.drawConnector=function(oData){return $scope["draw_"+oData.elType.toLowerCase()](oData)},$scope.drawAssociation=function(oData,outOfPool){var canvasShape;outOfPool&&(oData.canvas=$scope.parallelWrapper);var pY=angular.element(oData.canvas.canvas).closest("svg").attr("y")||$scope.paddingPool,pX=angular.element(oData.canvas.canvas).closest("svg").attr("x")||$scope.paddingPool,points=oData.data.children[0].content.points;if(points.length)for(var po=0,lpo=points.length;lpo>po;po++)points[po].y=parseFloat(points[po].y)+parseFloat(pY),points[po].x=parseFloat(points[po].x)+parseFloat(pX);var css="ng-association";if(oData.data.content.hasOwnProperty("sourceRef")){var parentDataId=angular.element("#"+oData.data.content.sourceRef.baref.ref);if(parentDataId.length>0){var type=angular.element(parentDataId).data("type");"TextAnnotation"===type&&(css+=" from-text-annotation")}else oData.data.children[0].content.points[0].y=oData.data.children[0].content.points[0].y+11}return canvasShape=$scope.createSequenceFlow(oData.data,$scope.parallelWrapper),$scope.isFirefox&&canvasShape.node.setAttribute("style","marker-end: url(#markerArrowLine);"),canvasShape.addClass(css),{canvasShape:canvasShape}},$scope.getDefaultMarker=function(oData){var pointsLine=$scope.getGraphicAttribute(oData.data,"points"),points=[];if(pointsLine.length){pointsLine[0].y===pointsLine[1].y?pointsLine[0].x>pointsLine[1].x?(points.push({x:pointsLine[0].x-7,y:pointsLine[0].y+7}),points.push({x:pointsLine[0].x-14,y:pointsLine[0].y-7})):(points.push({x:pointsLine[0].x+7,y:pointsLine[0].y-7}),points.push({x:pointsLine[0].x+14,y:pointsLine[0].y+7})):pointsLine[0].y>pointsLine[1].y?(points.push({x:pointsLine[0].x-7,y:pointsLine[0].y-7}),points.push({x:pointsLine[0].x+7,y:pointsLine[0].y-14})):(points.push({x:pointsLine[0].x+7,y:pointsLine[0].y+7}),points.push({x:pointsLine[0].x-7,y:pointsLine[0].y+14}));var pathPoints=$scope.getPathString(points);oData.canvas.path(pathPoints).addClass("ng-sequenceflow-default-marker")}},$scope.drawSequenceflow=function(oData){var pointsLine=$scope.getGraphicAttribute(oData.data,"points");if(pointsLine.length){var pathPoints=$scope.getPathString(pointsLine),canvasShape=oData.canvas.path(pathPoints);canvasShape.attr("x",pointsLine[0].x),canvasShape.attr("y",pointsLine[0].y);var canvasShapeClone=canvasShape.clone();return canvasShape.node.setAttribute("class","ng-sequenceflow"),$scope.isFirefox&&canvasShape.node.setAttribute("style","marker-end: url(#markerArrow);"),canvasShapeClone.node.setAttribute("class","ng-sequenceflow ng-clone"),oData.data.content.hasOwnProperty("conditionType")&&"Default"===oData.data.content.conditionType&&$scope.getDefaultMarker(oData),{canvasShape:canvasShape,clone:canvasShapeClone}}},$scope.drawMessageflow=function(oData,outOfPool){outOfPool&&(oData.canvas=$scope.parallelWrapper);var pointsLine=oData.info.points;if(pointsLine.length){var pathPoints=$scope.getPathString(pointsLine),canvasShape=oData.canvas.path(pathPoints),canvasShapeClone=canvasShape.clone();return canvasShape.node.setAttribute("class","ng-messageflow"),$scope.isFirefox&&canvasShape.node.setAttribute("style","marker-end: url(#markerArrowNoFill); marker-start: url(#markerCircle);"),canvasShapeClone.node.setAttribute("class","ng-messageflow ng-clone"),canvasShape.node.setAttribute("data-type",oData.elType),canvasShapeClone.node.setAttribute("data-type",oData.elType),canvasShape.attr("x",pointsLine[0].x),canvasShape.attr("y",pointsLine[0].y),{canvasShape:canvasShape,clone:canvasShapeClone}}},$scope.drawArtifacts=function(oData,outOfPool){var canvasShape,pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height;if(outOfPool&&(oData.canvas=$scope.parallelWrapper),"ImageArtifact"===oData.elType){oData.data.content.picture||(oData.data.content.picture=PROCESS_VIEWER_MODULE.RESOURCES.BROKE_IMAGE);var sourceImage="data:image/png;base64,"+oData.data.content.picture,posY=pY,posX=pX;oData.attrs.position.y=posY,oData.attrs.position.X=posX,canvasShape=oData.canvas.image(sourceImage,pX,pY,wS,hS)}else if("FormattedTextArtifact"===oData.elType){oData.attrs.position.y=pY+=hS/2;var _canvasShape=oData.canvas.rect(pX,pY,wS+4,hS+4),dText=oData.data.content.text.replace(/(\\\\\\")/gi,'"').replace(/(\\\\")/gi,'"').replace(/(\\")/gi,'"');if($scope.textBoxSVG)canvasShape=$scope.createBoxText(oData.canvas,_canvasShape,oData.elType,dText);else{canvasShape=_canvasShape;var viewerSVG=angular.element(".viewer-svg");if(0===viewerSVG.find("#clone_"+oData.data.id).length){var dTextFont=dText.replace(/([0-9]*)(pt)/gi,function(match,contents){var vEm=.0836458341698,valueFont=parseFloat(contents);return valueFont*vEm+"em"}),htmlReference=$scope.createHTMObject(oData,canvasShape,oData.elType,dTextFont);$scope.addCommonHandlers(htmlReference)}}}else if("TextAnnotation"===oData.elType){oData.attrs.position.y=pY,canvasShape=oData.canvas.rect(pX,pY,wS,hS);var pointsTA=[];pointsTA.push({x:pX+wS/3,y:pY}),pointsTA.push({x:pX,y:pY}),pointsTA.push({x:pX,y:pY+hS}),pointsTA.push({x:pX+wS/3,y:pY+hS}),oData.canvas.path($scope.getPathString(pointsTA)).addClass("ng-text-annotation-decorate")}else if("HeaderArtifact"===oData.elType)oData.attrs.position.y=pY+=25,canvasShape=oData.canvas.rect(pX,pY,wS,hS),$scope.headerArtifacts.push({oData:oData,canvasShape:canvasShape});else if("CustomArtifact"===oData.elType){var content,caSourceImage,customArtifactRef;customArtifactRef=oData.data.content.customArtifactTypeRef.replace("CA_",""),content=$scope.findCustomArtifact(customArtifactRef),content&&content.hasOwnProperty("serializableImage")&&(caSourceImage="data:image/png;base64,"+content.serializableImage,canvasShape=oData.canvas.image(caSourceImage,pX,pY,hS,wS)),content&&caSourceImage||(canvasShape=oData.canvas.rect(pX-2,pY-2,wS+4,hS+4,3))}else canvasShape=oData.canvas.rect(pX-2,pY-2,wS+4,hS+4,3);return{canvasShape:canvasShape}},$scope.drawGateways=function(oData){var canvasShape,markers,pX,pY,wS,hS;return pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height,markers=[],canvasShape=oData.canvas.path($scope.polygon(oData.canvas,pX+wS/2,pY+hS/2,4,wS/2)),oData.data.content.hasOwnProperty("markerVisible")&&oData.data.content.markerVisible&&markers.push("markers.markerVisible"),{canvasShape:canvasShape,markers:markers}},$scope.drawEvents=function(oData){var canvasShape,canvasShapeCopy,pX,pY,wS,hS,thereClone=!1;return pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height,canvasShape=oData.canvas.circle(pX+wS/2,pY+hS/2,wS/2),oData.elType&&-1!==oData.elType.toLowerCase().indexOf("intermediate")&&(canvasShapeCopy=oData.canvas.circle(pX+(wS-4)/2+2,pY+(hS-4)/2+2,(wS-4)/2),canvasShapeCopy.addClass("ng-clone svg-events ng-"+oData.elType.toLowerCase()),thereClone=!0),thereClone?{canvasShape:canvasShape,clone:canvasShapeCopy}:{canvasShape:canvasShape}},$scope.drawData=function(oData){var canvasShape,pointsPage,points,pX,pY,wS,hS;return pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height,"DataObject"===oData.elType?(points=[],points.push({x:pX,y:pY}),points.push({x:pX+wS/3*2,y:pY}),points.push({x:pX+wS,y:pY+hS/3}),points.push({x:pX+wS,y:pY+hS}),points.push({x:pX,y:pY+hS}),points.push({x:pX,y:pY}),canvasShape=oData.canvas.path($scope.getPathString(points)),pointsPage=[],pointsPage.push({x:pX+wS/3*2,y:pY}),pointsPage.push({x:pX+wS/3*2,y:pY+hS/3}),pointsPage.push({x:pX+wS,y:pY+hS/3}),oData.canvas.path($scope.getPathString(pointsPage))):"DataStoreReference"===oData.elType&&(canvasShape=oData.canvas.path("M"+(pX+wS)+","+(pY+hS)+"c0,"+hS/4+"  -"+wS+","+hS/4+"-"+wS+",0v-"+hS+"c0-"+hS/4+","+wS+"-"+hS/4+","+wS+",0V"+pY+"z").addClass("ng-dataStorereference-bd"),oData.canvas.path("M"+pX+","+pY+"c0,"+hS/4+","+wS+","+hS/4+","+wS+",0").addClass("ng-dataStorereference-bd"),oData.canvas.path("M"+pX+","+(pY+5)+"c0,"+hS/4+","+wS+","+hS/4+","+wS+",0").addClass("ng-dataStorereference-bd"),oData.canvas.path("M"+pX+","+(pY+10)+"c0,"+hS/4+","+wS+","+hS/4+","+wS+",0").addClass("ng-dataStorereference-bd"),canvasShape.attr("x",pX),canvasShape.attr("y",pY)),{canvasShape:canvasShape}},$scope.drawSwimlanes=function(oData){var canvasShape,pX,pY,wS,hS;if(pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height,"Lane"===oData.elType&&(!$scope.hasMilestone||$scope.hasMilestone&&0!==pY))canvasShape=oData.canvas.rect(pX,pY,wS,hS);else{var points=[],ancho=pX+wS,alto=pY+hS;points.push({x:pX,y:pY}),points.push({x:ancho,y:pY}),points.push({x:ancho+8,y:pY+10}),points.push({x:ancho,y:pY+20}),points.push({x:ancho,y:alto}),points.push({x:pX,y:alto}),canvasShape=oData.canvas.path($scope.getPathString(points)),canvasShape.attr("x",pX),canvasShape.attr("y",pY)}return{canvasShape:canvasShape}},$scope.drawActivities=function(oData){var canvasShape,elType,aType,canvasShapeObject={},icons=[],markers=[],pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height,hS=oData.attrs.size.height;if(canvasShape=oData.canvas.rect(pX,pY,wS,hS,3),"CallActivity"===oData.elType||"SubProcess"===oData.elType||"Activity"===oData.data.content.flowNodeType||"AbstractTask"===elType){if(oData.data.content.hasOwnProperty("isForCompensation")&&oData.data.content.isForCompensation&&markers.push("markers.isForCompensation"),oData.data.content.hasOwnProperty("loopType")&&"None"!==oData.data.content.loopType&&(aType=oData.data.content.loopType,"MultiInstance"===aType?aType=oData.data.content.hasOwnProperty("multiInstanceLoopCharacteristics")&&oData.data.content.multiInstanceLoopCharacteristics.isSequential?"markers.loopType.MultiInstance.sequential":"markers.loopType.MultiInstance.parallel":"Standard"===aType&&oData.data.content.hasOwnProperty("standardLoopCharacteristics")&&(aType="markers.loopType.Standard"),markers.push(aType)),("SubProcess"===oData.elType||"CallActivity"===oData.elType)&&(aType="markers.icon",markers.push(aType)),"SubProcess"===oData.elType&&"SubProcess"!==oData.data.content.subProcessType&&(aType="markers.SubProcessType."+oData.data.content.subProcessType,markers.push(aType),"Transaction"===oData.data.content.subProcessType)){var transactionRect=oData.canvas.rect(pX-2,pY-2,wS+4,hS+4,3);transactionRect.addClass("ng-transaction")}oData.data.content.hasOwnProperty("triggeredByEvent")&&oData.data.content.triggeredByEvent&&(aType=" icons.triggeredByEvent",icons.push(aType),canvasShape.addClass("ng-triggered-by-event"))}return canvasShapeObject={canvasShape:canvasShape},icons.length>0&&(canvasShapeObject.icons=icons),markers.length>0&&(canvasShapeObject.markers=markers),canvasShapeObject},$scope.findCustomArtifact=function(ref){var content;if($scope.ngModel.customArtifactsDefinitions&&$scope.ngModel.customArtifactsDefinitions.length)for(var i=0,l=$scope.ngModel.customArtifactsDefinitions.length;l>i;i++)ref===$scope.ngModel.customArtifactsDefinitions[i].content.id&&(content=$scope.ngModel.customArtifactsDefinitions[i].content);return content},$scope.createBoxText=function(canvas,canvasShape,elType,content){for(var __canvasShape=canvasShape,HTMLTextForSVG=angular.element(content),lines=HTMLTextForSVG.find("span"),nText="",t=0,lt=lines.length;lt>t;t++)nText+="\n"+angular.element(lines[t]).text();var contentBox=canvasShape.getBBox();return __canvasShape=canvas.text(contentBox.x,contentBox.y,nText)},$scope.getHTMLPosition=function(headerObj){var contentBox=headerObj.canvasShape.getBBox(),pX=parseFloat(angular.element(headerObj.oData.canvas[0]).closest("svg").attr("x"))||0,pY=parseFloat(angular.element(headerObj.oData.canvas[0]).closest("svg").attr("y"))||0,wAttributes={width:contentBox.width-4,height:contentBox.height-4,position:"absolute",left:contentBox.x+2+pX,top:contentBox.y+2+pY};return angular.element("#helper-"+headerObj.oData.attrs.id).data("initAttributes",wAttributes),wAttributes},$scope.createHTMObject=function(oData,canvasShape,elType,content){var contentBox=canvasShape.getBBox(),renderHTML=content,HTMLId="clone_"+oData.data.id,HTMLParentId=oData.data.id,HTMLName="clone_"+oData.data.name,wrapperHTML=angular.element('<div data-parent-id="'+HTMLParentId+'" id="'+HTMLId+'" data-name="'+HTMLName+'">'+renderHTML+"</div>"),viewerSVG=angular.element(".viewer-svg");viewerSVG.append(wrapperHTML),wrapperHTML.addClass(elType+"-html svg-html-helper");var pX=parseFloat(angular.element(oData.canvas[0]).closest("svg").attr("x"))||0,pY=parseFloat(angular.element(oData.canvas[0]).closest("svg").attr("y"))||0,wAttributes={width:contentBox.width-4,height:contentBox.height-4,position:"absolute",left:contentBox.x+2+pX,top:contentBox.y+2+pY};return wrapperHTML.css(wAttributes),wrapperHTML.data("initAttributes",wAttributes),wrapperHTML},$scope.refreshHTMLObjects=function(){for(var htmlObjects=angular.element(".svg-html-helper"),i=0,l=htmlObjects.length;l>i;i++){var htmlObject=angular.element(htmlObjects[i]),refBox=htmlObject.data().parentRef;angular.element("#"+refBox);try{var oTop=htmlObject.data().initAttributes.top,oLeft=htmlObject.data().initAttributes.left;$scope.isChrome&&htmlObject.css("zoom",$scope.scale),htmlObject.css("-moz-transform","scale("+$scope.scale+")"),htmlObject.css("-moz-transform-origin","-"+oLeft+"px -"+oTop+"px"),htmlObject.css("-ms-transform","scale("+$scope.scale+")"),htmlObject.css("-ms-transform-origin","-"+oLeft+"px -"+oTop+"px")}catch(e){}}},$scope.getImagePosition=function(type,pX,pY,wS,hS,isMarker){var x=0,y=0,paddingIcon=4;return isMarker?(x="circle"===BPM[type].svg||"polygon"===BPM[type].svg?pX+wS/2:pX+wS,y="circle"===BPM[type].svg||"polygon"===BPM[type].svg?pY+hS/2:pY+hS+.5):(x="circle"===BPM[type].svg||"polygon"===BPM[type].svg?pX+wS/2:pX+paddingIcon,y="circle"===BPM[type].svg||"polygon"===BPM[type].svg?pY+hS/2:pY+paddingIcon),{x:x,y:y}},$scope.setBPMVisualAttrs=function(type,oData,drawedObject){var pX,pY,wS,hS,iconPercent,bpmDef=_.findWhere(BPM[type].elementTypes,{elementType:oData.elType});if(oData.attrs.hasOwnProperty("position")&&oData.attrs.position&&(pX=oData.attrs.position.x,pY=oData.attrs.position.y,wS=oData.attrs.size.width,hS=oData.attrs.size.height),iconPercent=.45,drawedObject.canvasShape.node.setAttribute("data-type",oData.elType),oData.hasOwnProperty("data")&&oData.data.content.description?drawedObject.canvasShape.node.setAttribute("data-description",oData.data.content.description):drawedObject.canvasShape.node.setAttribute("data-description",""),oData.attrs.hasOwnProperty("svgStyle")&&oData.attrs.svgStyle&&oData.attrs.svgStyle.hasOwnProperty("backgroundColor")&&oData.attrs.svgStyle.backgroundColor&&drawedObject.canvasShape.node.setAttribute("fill",oData.attrs.svgStyle.backgroundColor),bpmDef){var imageWidth=BPM[type].size?BPM[type].size.w:30,imageHeight=BPM[type].size?BPM[type].size.h:30;bpmDef.hasOwnProperty("size")&&(imageWidth=bpmDef.size.w,imageHeight=bpmDef.size.h),("circle"===BPM[type].svg||"polygon"===BPM[type].svg)&&(imageWidth=wS*iconPercent,imageHeight=hS*iconPercent);var imagePositionX=$scope.getImagePosition(type,pX,pY,wS,hS).x,imagePositionY=$scope.getImagePosition(type,pX,pY,wS,hS).y,txtIconAttrs={position:{x:imagePositionX,y:imagePositionY},text:{formatting:{fontName:"bz-bpmn-font",fontSize:imageWidth}}};if(bpmDef.hasOwnProperty("fontIcon")||bpmDef.hasOwnProperty("icons")){var imageIcon="",fontIcon="",classIcon=(bpmDef.cssFont||"svg-"+type.toLowerCase()+"-icon")+" svg-"+bpmDef.elementType.toLowerCase();bpmDef.hasOwnProperty("fontIcon")?(fontIcon=$scope.validateIsThrowCatch(oData,bpmDef.fontIcon),imageIcon=$scope.utf16Encode(fontIcon),$scope.createIconByFont(imageIcon,classIcon,txtIconAttrs,oData,drawedObject)):bpmDef.hasOwnProperty("icons")&&(imageIcon="",drawedObject.icons&&drawedObject.icons.length>0&&(imageIcon+=$scope.getIcon(drawedObject,bpmDef)),$scope.createIconByFont(imageIcon,classIcon,txtIconAttrs,oData,drawedObject))}if(bpmDef.hasOwnProperty("markers")){var markerIcon="";"rect"===BPM[type].svg&&(txtIconAttrs.position.x=$scope.getImagePosition(type,pX,pY,wS/2,hS,!0).x,txtIconAttrs.position.y=$scope.getImagePosition(type,pX,pY,wS,hS,!0).y,txtIconAttrs.text.formatting.textAnchor="middle");var classMarker=(bpmDef.cssFont||"")+" svg-"+bpmDef.elementType.toLowerCase();classMarker+=" svg-"+type.toLowerCase()+"-marker",classMarker+=" markers",drawedObject.markers&&drawedObject.markers.length>0&&(markerIcon=$scope.getMarkerIcon(drawedObject,bpmDef)),$scope.createIconByFont(markerIcon,classMarker,txtIconAttrs,oData,drawedObject)}bpmDef.hasOwnProperty("css")?drawedObject.canvasShape.addClass(bpmDef.css):drawedObject.canvasShape.addClass("ng-"+type.toLowerCase()+"-"+oData.data.content.elementType.toLowerCase()),drawedObject.canvasShape.addClass(BPM[type].css)}},$scope.validateIsThrowCatch=function(oData,icon){var validatedIcon=icon,isThrow=!1;return"object"==typeof validatedIcon&&(isThrow=$scope.getDefinitionAttribute(oData.data,"isThrow")||!1,icon=isThrow?validatedIcon.isThrow:validatedIcon.isCatch),icon},$scope.createIconByFont=function(imageIcon,classIcon,txtIconAttrs,oData,drawedObject){var imageIcon=imageIcon.replace(/\s/g,""),icon=$scope.createText(imageIcon,txtIconAttrs,oData.canvas,drawedObject.canvasShape);icon.attr({"text-anchor":"start"}),"circle"===oData.svgType||"polygon"===oData.svgType?icon.attr("x",txtIconAttrs.position.x-icon.getBBox().width/2):icon.attr("y",txtIconAttrs.position.y+icon.getBBox().height/2),txtIconAttrs.text.formatting.hasOwnProperty("textAnchor")&&(icon.attr({"text-anchor":txtIconAttrs.text.formatting.textAnchor}),icon.attr("y",txtIconAttrs.position.y-icon.getBBox().height/2)),icon.node.setAttribute("class",classIcon),icon.node.setAttribute("data-type",oData.elType),icon.setParentId(oData.attrs.id),icon.setParentName(oData.attrs.name),icon.hover(function(event){drawedObject.canvasShape.addClass("shape_hover")},function(event){drawedObject.canvasShape.removeClass("shape_hover")}),icon.click($scope.clickShape)},$scope.clickShape=function(event){if(!$scope.isDragging){var targetClicked;if(targetClicked=event.currentTarget,targetClicked.attributes["data-parent-id"]){var ui={id:targetClicked.attributes["data-parent-id"].value,name:targetClicked.attributes["data-parent-name"].value,
type:targetClicked.attributes["data-type"].value,svg:targetClicked};event.currentTarget=targetClicked,$rootScope.$emit($scope.pwEvents.SHAPE_CLICKED,ui),$scope.selectedShape(event,ui.id)}}},$scope.getMarkerIcon=function(drawedObject,bpmDef){var CharCode,iconDef,markerIcon="";if(drawedObject.markers.length)for(var prop in drawedObject.markers)if(""!==drawedObject.markers[prop]){iconDef="bpmDef."+drawedObject.markers[prop].replace(/\s/g,"");try{CharCode=eval(iconDef),markerIcon=markerIcon+" "+$scope.utf16Encode(CharCode)}catch(e){}}return markerIcon},$scope.getIcon=function(drawedObject,bpmDef){var CharCode,iconDef,markerIcon="";if(drawedObject.icons.length)for(var prop in drawedObject.icons){iconDef="bpmDef."+drawedObject.icons[prop].replace(/\s/g,"");try{CharCode=eval(iconDef),markerIcon=-1!==iconDef.indexOf("SubProcessType")?markerIcon+" "+$scope.utf16Encode(CharCode):$scope.utf16Encode(CharCode)+" "+markerIcon}catch(e){}}return markerIcon},$scope.utf16Encode=function(input){var value,output="";if(value=input,55296===(63488&value))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");return value>65535&&(value-=65536,output.push(String.fromCharCode(value>>>10&1023|55296)),value=56320|1023&value),output=String.fromCharCode(value)},$scope.validateElementType=function(node,elType){var rValue={validType:!1};if(BPM[node]){var def=_.where(BPM[node].elementTypes,{elementType:elType});rValue={validType:def.length,path:def.path}}return rValue},$scope.createSequenceFlow=function(data,canvas){var pointsLine=$scope.getGraphicAttribute(data,"points");if(pointsLine.length){var pathPoints=$scope.getPathString(pointsLine),sequenceFlow=canvas.path(pathPoints);return sequenceFlow.node.setAttribute("id",data.id),sequenceFlow.node.setAttribute("class","ng-sequenceflow"),$scope.isFirefox&&sequenceFlow.node.setAttribute("style","marker-end: url(#markerArrow);"),sequenceFlow.attr("x",pointsLine[0].x),sequenceFlow.attr("y",pointsLine[0].y),sequenceFlow}},$scope.getPathString=function(points){for(var pathString="",i=0;i<points.length;i++)0===i&&(pathString+="M"),i>0&&(pathString+="L"),pathString+=points[i].x+",",pathString+=points[i].y+",";return pathString},$scope.createShape=function(data,canvas){var visualAttrs;visualAttrs={position:$scope.validateLocationAttribute($scope.getGraphicAttribute(data,"location"),data),size:$scope.validateSizeAttribute($scope.getGraphicAttribute(data,"size"),data),text:$scope.getGraphicAttribute(data,"text"),svgStyle:{backgroundColor:$scope.getDefinitionAttribute(data,"backgroundColor"),borderVisible:$scope.getDefinitionAttribute(data,"borderVisible"),borderColor:$scope.getDefinitionAttribute(data,"borderColor")}};var expanded=$scope.getGraphicAttribute(data,"expanded");if($scope.getGraphicAttribute(data,"expanded")){var isExpanded=$scope.getGraphicAttribute(data,"expanded").isExpanded;isExpanded&&(visualAttrs.size=expanded.size)}var padding=80;"undefined"!=typeof $scope.getGraphicAttribute(data,"location")&&"undefined"!=typeof $scope.getGraphicAttribute(data,"size")&&($scope.getGraphicAttribute(data,"location").x>$scope.totalWidth&&($scope.totalWidth=$scope.getGraphicAttribute(data,"location").x+($scope.getGraphicAttribute(data,"size").width+padding)),$scope.getGraphicAttribute(data,"location").y>$scope.totalHeight&&($scope.totalHeight=$scope.getGraphicAttribute(data,"location").y+($scope.getGraphicAttribute(data,"size").height+padding))),$scope.drawShapeByType(data,canvas,visualAttrs)},$scope.validateLocationAttribute=function(location){var position={x:0,y:0};return location||(location=position),location},$scope.validateSizeAttribute=function(size){var dimentions={width:0,height:0};return size||(size=dimentions),size},$scope.createText=function(text,attr,poolGroup,parentObject){var textObject,posX,posY,middlePoint,middlePosition,textDefaultAttr={"text-anchor":"middle","alignment-baseline":"middle"};attr.hasOwnProperty("vertical-align")&&(textDefaultAttr["vertical-align"]=attr["vertical-align"]),posX=attr.hasOwnProperty("posX")?0!==posX?attr.posX:middlePosition.x+12:attr.hasOwnProperty("size")&&attr.hasOwnProperty("position")&&attr.size&&attr.position?(attr.position.x||0)+attr.size.width/2:attr.position&&attr.position.x?attr.position.x:$scope.getDefaultLocation(parentObject).x,posY=attr.hasOwnProperty("posY")?0!==posY?attr.posY:middlePosition.y+12:attr.hasOwnProperty("size")&&attr.hasOwnProperty("position")&&attr.size&&attr.position?(attr.position.y||0)+attr.size.height/2:attr.position&&attr.position.y?attr.position.y:$scope.getDefaultLocation(parentObject).y,attr.text&&attr.text.location&&(posX=attr.text.location.x+10,posY=attr.text.location.y+10,textDefaultAttr["text-anchor"]="start");var idValue=(new Date).getTime();attr.text&&attr.text.formatting&&$scope.addStyleToPV(attr,idValue);var wPO=100;if(attr.hasOwnProperty("width")&&attr.width&&wPO<attr.width)wPO=attr.width;else{var wPOTmp=parentObject.width?parentObject.width:parentObject.getBBox().width;wPOTmp>wPO&&(wPO=wPOTmp)}if(attr.text&&attr.text.size&&(wPO=attr.text.size.width+20),0===posX&&0===posY){var middlePoint=parentObject.getTotalLength()/2,middlePosition=parentObject.getPointAtLength(middlePoint);posX=middlePosition.x,posY=middlePosition.y}return textObject=poolGroup.multiline(posX,posY,text,wPO,textDefaultAttr),textObject.setId("txt_"+idValue),textObject},$scope.addStyleToPV=function(attr,idValue){var my_style=".processviewer-container #txt_"+idValue+"{";for(var prop in attr.text.formatting)"fontName"===prop?my_style+="   font-family:"+attr.text.formatting[prop]+";":"fontColor"===prop?my_style+="   color:"+attr.text.formatting[prop]+";":"fontSize"===prop&&(my_style+="  font-size:"+parseFloat(attr.text.formatting[prop])+"pt;");my_style+="}";var style=angular.element("#pv");0===style.length&&(style=angular.element('<style id="pv"></style>'),$element.append(style)),style.append(my_style)},$scope.getGraphicAttribute=function(data,attr){var graphicAttributes={content:{}};return data.hasOwnProperty("children")&&(graphicAttributes=_.findWhere(data.children,{type:"ElementGraphicsInfo"})),graphicAttributes.content[attr]||void 0},$scope.getDefinitionAttribute=function(data,attr){return data&&data.content&&data.content[attr]?data.content[attr]:void 0},$scope.getDefaultLocation=function(parentObject){var l,location={x:0,y:0};return"path"===parentObject.type&&(l=parentObject.getTotalLength()/2,location=parentObject.getPointAtLength(l)),location},$scope.getDefaultSize=function(){return{width:20,height:20}},$scope.addCommonHandlers=function(shape){shape.click(function(event){if(!$scope.isDragging){if("text"===event.currentTarget.tagName)var target=event.currentTarget.previousSibling;else var target=event.currentTarget;if(target.attributes.id){var isCloned=!1;-1!==target.attributes.id.value.indexOf("clone_")&&(isCloned=!0);var idTarget=target.attributes.id.value.replace("clone_",""),dataName=target.attributes["data-name"]?target.attributes["data-name"].value.replace("clone_",""):"",dataType=target.attributes["data-type"]?target.attributes["data-type"].value.replace("clone_",""):"",ui={id:idTarget,name:dataName,svg:shape,type:dataType};isCloned&&(ui.svg=$scope.extendSVGElement(angular.element("#"+idTarget)[0])),$rootScope.$emit($scope.pwEvents.SHAPE_CLICKED,ui),$scope.selectedShape(event,ui)}}}),shape.hover(function(event){if("text"===event.currentTarget.tagName)var target=event.currentTarget.previousSibling;else var target=event.currentTarget;var shapeId=target.attributes.id.value;if(shapeId.indexOf("clone_")>=0){var shapeParent=target.attributes["data-parent-id"].value,shapeElement=angular.element("#"+shapeParent)[0];$scope.extendSVGElement(shapeElement).addClass("shape_hover")}else shape.addClass("shape_hover")},function(event){if("text"===event.currentTarget.tagName)var target=event.currentTarget.previousSibling;else var target=event.currentTarget;var shapeId=target.attributes.id.value;if(shapeId.indexOf("clone_")>=0){var shapeParent=target.attributes["data-parent-id"].value,shapeElement=angular.element("#"+shapeParent)[0];$scope.extendSVGElement(shapeElement).removeClass("shape_hover")}else shape.removeClass("shape_hover")})},$scope.polygon=function(canvas,x,y,N,side){var n,tempX,tempY,angle,path="";for(n=0;N>=n;n+=1)angle=n/N*2*Math.PI,tempX=x+Math.cos(angle)*side,tempY=y+Math.sin(angle)*side,path+=(0===n?"M":"L")+tempX+","+tempY;return path},$scope.zoom=function(key){if("in"===key)$scope.scale=Math.round(100*($scope.scale+$scope.indScale))/100,$scope.totalHeight=Math.round($scope.totalHeight+$scope.initialHeight*$scope.indScale),$scope.totalWidth=Math.round($scope.totalWidth+$scope.initialWidth*$scope.indScale),$scope.updateSizeViewer($scope.totalWidth,$scope.totalHeight);else if("out"===key)Math.round(100*($scope.scale-$scope.indScale))/100>0&&($scope.scale=Math.round(100*($scope.scale-$scope.indScale))/100,$scope.totalHeight=Math.round($scope.totalHeight-$scope.initialHeight*$scope.indScale),$scope.totalWidth=Math.round($scope.totalWidth-$scope.initialWidth*$scope.indScale),$scope.updateSizeViewer($scope.totalWidth,$scope.totalHeight));else{var canvasElement=angular.element($scope.paper.canvas).parent();$scope.scale=1,canvasElement.css({left:0,top:0}),$scope.totalHeight=$scope.initialHeight,$scope.totalWidth=$scope.initialWidth,$scope.updateSizeViewer($scope.initialWidth,$scope.initialHeight)}$scope.wrapper.setScale($scope.scale),$scope.parallelWrapper.setScale($scope.scale)},$scope.extendSVGElement=function(svg){var itemRaphael=$.extend(svg,Raphael.el);return itemRaphael[0]=svg,itemRaphael.node=svg,itemRaphael},$scope.$watch("ngModel",function(newValue,oldValue){$scope.ngModel.diagram&&$scope.ngModel.diagram.id&&!oldValue.hasOwnProperty("diagram")&&$scope.createViewer()}),$scope.$watch("totalHeight",function(){$scope.totalHeight&&$scope.updateSizeViewer($scope.totalWidth,$scope.totalHeight)}),$scope.$watch("totalWidth",function(){$scope.totalWidth&&$scope.updateSizeViewer($scope.totalWidth,$scope.totalHeight)}),$scope.setElementsArrays()}),angular.module("commentsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("commentsModule").constant("COMMENTS_MODULE",{EVENTS:{_ERROR:"ERROR",_WARNING:"WARNING",_READY:"COMMENTS_MODULE._READY",_DELETE:"COMMENTS_MODULE._DELETE",_UPDATE:"COMMENTS_MODULE._UPDATE",_SEND:"COMMENTS_MODULE._SEND",_GET_REPLIES:"COMMENTS_MODULE._GET_REPLIES",_GET_PAGE:"COMMENTS_MODULE._GET_PAGE",_NEW_SHAPE:"COMMENTS_MODULE._NEW_SHAPE",_EXECUTE:"EXECUTE",_SET_DEFAULT:"COMMENTS_MODULE._SET_DEFAULT"},RESOURCES:{IMAGES:{PLACEHOLDER:"app/img/bizagi-placeholder-avatar.png"}},TEMPLATES:{BASE:"views/comments.module.view.html"},FILTERS:{COMMENTS:[{name:"All",value:""}]},ACTIONS:{SHOW_COMMENTS:"SHOW.COMMENTS",DELETE_COMMENT:"DELETE.COMMENT",REPLY_COMMENT:"REPLY.COMMENT"},ACTION_MENU:{ACTIONS:[{name:gettext("Reply"),action:"REPLY.COMMENT",img:"reply",state:"enabled",type:"icon"},{name:"Delete",action:"DELETE.COMMENT",img:"trash",state:"enabled",type:"icon"}],OPTIONS:[]}}),angular.module("commentsModule").controller("CommentsController",function($scope,$state,$rootScope,$filter,$data,COMMENTS_MODULE){$scope.setDefaults=function(){$scope.selectedWorkspace=$data.$selectedWorkspace(),$scope.filterOptions=COMMENTS_MODULE.FILTERS,$scope.filterItem=$scope.filterOptions[0],$scope.commentIndex=!1,$scope.comments=[],$scope.numComments=$scope.comments.length,$scope.replies={},$scope.workspaceId=$scope.selectedWorkspace.id,$scope.commentPlaceholder=COMMENTS_MODULE.RESOURCES.IMAGES.PLACEHOLDER,$scope.addComment="",$scope.activeFilter="",$scope.options=[],$scope.actions=[],$scope.targetID=0,$scope.activeCommentIndex="",$scope.userId=$data.$userProfile().id,moment.locale($data.$getLanguage())},$scope.getTimeAgo=function(timeAgo){return moment(timeAgo).fromNow()},$scope.validateIcon=function(comment){var css="bz-cd-comment-shape",id=comment.relatedElementId;if(id){var el=angular.element("#"+id),data=el.data(),source=el.attr("href");source?(comment.image=source,css+=" bz-comment-without-icon"):css=data.type?"bz-cd-comment-shape bz-cd-comment-shape-"+data.type.toLowerCase():"bz-cd-comment-shape",comment.css=css}},$scope.selectedShape=function($event){var element=$event.target,elementId="#"+element.dataset.id;angular.element(elementId).addClassSVG("processviewer-shape-selected")},$scope.sendComments=function(){var sndData=$scope.addComment;$rootScope.$emit(COMMENTS_MODULE.EVENTS._SEND,{text:sndData}),$scope.addComment=""},$scope.replyToComment=function(comment){var sndData=angular.element(event.currentTarget).val();$rootScope.$emit(COMMENTS_MODULE.EVENTS._SEND,{text:sndData,id:comment.id,userId:$scope.userId,workspaceId:$scope.workspaceId}),$scope.replies[comment.id]="",comment.reply=!1},$scope.checkKeyup=function(event,replyComment){var textArea=angular.element(event.currentTarget).val();13===event.keyCode&&($scope.addComment.length>0||textArea.length>0)&&(replyComment?$scope.replyToComment(replyComment):$scope.sendComments())},$scope.execute=function(event,obj){$rootScope.$emit(COMMENTS_MODULE.EVENTS._EXECUTE,obj)},$scope.activeIcon=function(event){$(event.currentTarget).toggleClass($app.$allCss().states.active)},$scope.deleteComment=function(event,idComment,idRepliedTo){for(var isReply=void 0!==idRepliedTo,i=0;i<$scope.comments.length;i++)if(isReply)$scope.validateCommentIdReplyId(i,idComment,idRepliedTo);else if($scope.comments[i].id===idComment){$scope.comments.splice(i,1);break}},$scope.validateCommentIdReplyId=function(index,idComment,idRepliedTo){if($scope.comments[index].id===idRepliedTo)for(var comment=$scope.comments[index],r=0;r<comment.replies.length;r++)if(comment.replies[r].id===idComment){comment.replies.splice(r,1);break}},$scope.addReplyTo=function(commentRef,reply){for(var prop in $scope.comments)$scope.comments[prop].id===commentRef.id&&($scope.comments[prop].hasOwnProperty("replies")||($scope.comments[prop].replies=[]),$scope.comments[prop].replies.push(reply))},$scope.update=function(event,data){data.hasOwnProperty("resetComments")&&($scope.comments=[]),moment.locale($data.$getLanguage()),data.hasOwnProperty("actions")&&($scope.actions=data.actions),data.hasOwnProperty("options")&&($scope.options=data.options),data.hasOwnProperty("reply")&&(data.comment.reply=!0),data.hasOwnProperty("dataSource")&&(data.hasOwnProperty("add")?data.dataSource.hasOwnProperty("text")?$scope.comments.unshift(data.dataSource):$rootScope.$emit(COMMENTS_MODULE.EVENTS._WARNING,"There are no comments"):data.hasOwnProperty("addReply")?$scope.addReplyTo(data.addReply,data.dataSource):$scope.comments=_.union($scope.comments,data.dataSource.content),data.dataSource.content&&$scope.evaluateDataForReplyComments(data))},$scope.evaluateDataForReplyComments=function(data){for(var i=0;i<data.dataSource.content.length;i++)if(data.dataSource.content[i].hasReplies===!0)for(var ie=0;ie<data.dataSource.content[i].responses.content.length;ie++)$scope.addReplyTo(data.dataSource.content[i],data.dataSource.content[i].responses.content[ie])},$scope.getNextPage=function(){$rootScope.$emit(COMMENTS_MODULE.EVENTS._GET_PAGE,{data:"nextPage"})},$scope.setDefaults(),$rootScope.$off(COMMENTS_MODULE.EVENTS._UPDATE),$rootScope.$off(COMMENTS_MODULE.EVENTS._DELETE),$rootScope.$off(COMMENTS_MODULE.EVENTS._SET_DEFAULT),$rootScope.$on(COMMENTS_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(COMMENTS_MODULE.EVENTS._DELETE,$scope.deleteComment),$rootScope.$on(COMMENTS_MODULE.EVENTS._SET_DEFAULT,$scope.setDefaults)}),angular.module("commentsModule").directive("noAvatar",["$data",function($data){var setDefaultImage=function(scope,el){el.attr("src",scope.commentPlaceholder)};return{restrict:"A",link:function(scope,el,attr){var src=attr.ngSrc;src||setDefaultImage(scope,el)}}}]),angular.module("notificationsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("notificationsModule").constant("NOTIFICATIONS_MODULE",{EVENTS:{_READY:"NOTIFICATIONS_MODULE._READY",_UPDATE:"NOTIFICATIONS_MODULE._UPDATE",_MARK_AS_READ:"NOTIFICATIONS_MODULE._MARK_AS_READ",_GET_PAGE:"NOTIFICATIONS_MODULE.EVENTS._GET_PAGE",_CHANGE:"NOTIFICATIONS_MODULE.EVENTS._CHANGE"},ACTIONS:{SHOW_NOTIFICATIONS:"SHOW.NOTIFICATIONS"},TEMPLATES:{BASE:"views/notification.module.view.html",PART:"views/notification.module.part.view.html"},FILTERS:[{name:"All",value:""},{name:"Diagrams",value:"diagram"},{name:"Comments",value:"comment"}]}),angular.module("notificationsModule").controller("NotificationsController",function($scope,$state,$rootScope,$data,$filter,applicationServices,NOTIFICATIONS_MODULE,gettextCatalog){$scope.setDefaults=function(){$scope.filterOptions=NOTIFICATIONS_MODULE.FILTERS,$scope.filterItem=$scope.filterOptions[0],$scope.filterItem=$scope.filterOptions[0],$scope.filterDate=new Date,$scope.notifications=[],$scope.showReference=!1,$scope.numNotifications=$scope.notifications.length,$scope.initDate=new Date("2016-15-20"),$scope.format="fullDate",$scope.notification=NOTIFICATIONS_MODULE.TEMPLATES.BASE,$scope.notificationList=NOTIFICATIONS_MODULE.TEMPLATES.PART,$scope.senders=[],$scope.totalRecords=0,$scope.maxSizes=3,$scope.actualPage=1,$scope.text={recentEvents:gettextCatalog.getString(gettext("Recent Events")),comments:gettextCatalog.getString(gettext("a Comment")),commentCategories:gettextCatalog.getString(gettext("the Comment Categories")),diagramLock:gettextCatalog.getString(gettext("a Diagram in the model")),extendedAttribute:gettextCatalog.getString(gettext("an Extended Attribute")),extendedAttributesOrder:gettextCatalog.getString(gettext("the Extended Attributes Order")),customArtifactType:gettextCatalog.getString(gettext("a Custom Artifact Type")),modelProperties:gettextCatalog.getString(gettext("the Model Properties")),diagram:gettextCatalog.getString(gettext("Diagram")),inTheModel:gettextCatalog.getString(gettext("in the model")),attachment:gettextCatalog.getString(gettext("Attachment"))},moment.locale($data.$getLanguage())},$scope.orderDate=function(a,b){var dateA=new Date(a),dateB=new Date(b);return dateA>dateB?1:-1},$scope.update=function(event,data){$scope.markasRead="?";for(var reference,i=0;i<data.content.length;i++)switch(data.content[i].reference?(reference=JSON.parse(data.content[i].reference),data.content[i].reference=gettextCatalog.getString(gettext("on "))+(reference.displayName||reference.key)):data.content[i].reference="",data.content[i].isNew&&($scope.markasRead=$scope.markasRead.concat("id="+data.content[i].id+"&"),data.content[i].isNew=!1),data.content[i].objectType){case"CommentCategories":data.content[i].objectType=$scope.text.commentCategories;break;case"DiagramLock":"Deleted"===data.content[i].eventType?data.content[i].eventType=gettextCatalog.getString(gettext("has released")):data.content[i].eventType=gettextCatalog.getString(gettext("has locked for edition")),data.content[i].type=data.content[i].objectType,data.content[i].objectType=reference.displayName,data.content[i].referenceId=reference.key;break;case"ExtendedAttribute":data.content[i].objectType=$scope.text.extendedAttribute,data.content[i].eventType=$scope.setEventType(data.content[i].eventType);break;case"ExtendedAttributesOrder":data.content[i].objectType=$scope.text.extendedAttributesOrder,data.content[i].eventType=$scope.setEventType(data.content[i].eventType);break;case"CustomArtifactType":data.content[i].objectType=$scope.text.customArtifactType,data.content[i].eventType=$scope.setEventType(data.content[i].eventType);break;case"ModelProperties":data.content[i].objectType=$scope.text.modelProperties,data.content[i].eventType=$scope.setEventType(data.content[i].eventType);break;case"Comments":data.content[i].objectType=$scope.text.comments,data.content[i].eventType=$scope.setEventType(data.content[i].eventType);break;case"Diagram":data.content[i].type=data.content[i].objectType,data.content[i].objectType=reference.displayName,data.content[i].referenceId=reference.key,data.content[i].eventType=gettextCatalog.getString(gettext("has modified"));break;case"Attachment":data.content[i].objectType=$scope.text.attachment,data.content[i].eventType=$scope.setEventType(data.content[i].eventType)}$scope.notifications=_.union($scope.notifications,data.content.sort($scope.orderDate)),$scope.numNotifications=data.content.length,$scope.addFilterByUser(),"?"!==$scope.markasRead&&$rootScope.$emit(NOTIFICATIONS_MODULE.EVENTS._MARK_AS_READ,$scope.markasRead),$scope.totalRecords=data.totalRecords},$scope.setEventType=function(eventType){switch(eventType){case"Added":eventType=gettextCatalog.getString(gettext("has added"));break;case"Created":eventType=gettextCatalog.getString(gettext("has added"));break;case"Deleted":eventType=gettextCatalog.getString(gettext("has removed"));break;case"Modified":eventType=gettextCatalog.getString(gettext("has modified"))}return eventType},$scope.getTimeAgo=function(timeAgo){return moment(timeAgo).fromNow()},$scope.change=function(event,data){$scope.diagrams=data},$scope.getDiagramById=function(id){var rValue=null;if($scope.diagrams)for(var diagrams=$scope.diagrams,i=0;i<diagrams.length;i++)if(diagrams[i].id===id){rValue=diagrams[i];break}return rValue},$scope.goToProcessViewer=function(diagram,workspace){$scope.diagramId=diagram,$scope.workspaceId=workspace},$scope.$watch("diagramId",function(){$scope.diagramId&&0!==$scope.diagramId&&($scope.selectedDiagram=$scope.getDiagramById($scope.diagramId),$data.$selectedDiagram($scope.selectedDiagram))}),$scope.getNextPage=function(){$rootScope.$emit(NOTIFICATIONS_MODULE.EVENTS._GET_PAGE,{data:"nextPage"})},$scope.addFilterByUser=function(){for(var i=0;i<$scope.notifications.length;i++){var filter={name:"",value:""};$scope.validateUserAlreadyExist($scope.notifications[i].sender.userName)||(filter.name=$scope.notifications[i].sender.userName,filter.value=$scope.notifications[i].sender.id,$scope.filterOptions.push(filter))}},$scope.timeStampToDate=function(timeStamp){var dateTimeStamp=new Date(parseFloat(timeStamp));return dateTimeStamp},$scope.validateUserAlreadyExist=function(name){for(var rValue=!1,i=0;i<$scope.filterOptions.length;i++)$scope.filterOptions[i].name===name&&(rValue=!0);return rValue},$scope.$watch("dt",function(newValue){$scope.filterDate=$filter("date")(newValue,"fullDate")}),$scope.setDefaults(),$rootScope.$off(NOTIFICATIONS_MODULE.EVENTS._UPDATE),$rootScope.$off(NOTIFICATIONS_MODULE.EVENTS._CHANGE),$rootScope.$on(NOTIFICATIONS_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(NOTIFICATIONS_MODULE.EVENTS._CHANGE,$scope.change),$rootScope.$emit(NOTIFICATIONS_MODULE.EVENTS._READY)}),angular.module("signalRModule",["ui.router","ui.bootstrap","ngAnimate","applicationModule"]),angular.module("signalRModule").constant("SIGNAL_R_MODULE",{EVENTS:{_READY:"SIGNAL_R_MODULE._READY",_START:"SIGNAL_R_MODULE._START",_STOP:"SIGNAL_R_MODULE._STOP",_STOP_READY:"SIGNAL_R_MODULE._STOP_READY",_NEW:"SIGNAL_R_MODULE._NEW",_SEND:"SIGNAL_R_MODULE._SEND",_SENDED:"SIGNAL_R_MODULE._SENDED",_RECEIVED:"SIGNAL_R_MODULE._RECEIVED",_ERROR:"ERROR",_SR_ERROR:"SIGNAL_R_MODULE.ERROR"},CONNECTIONS:{_HUB:"signalr",_JOIN:"connectToMyWorkspaces",_JOIN_WORKSPACE:"joinToWorkspace"},TEMPLATES:{BASE:"views/signal.r.module.view.html",OBJECT:"views/signal.r.module.object.view.html",STRING:"views/signal.r.module.string.view.html"}}),angular.module("signalRModule").controller("SignalRController",function($scope,$rootScope,$state,$stateParams,$http,$timeout,applicationServices,$data,SIGNAL_R_MODULE){$scope.constants={accessToken:"access_token"},$scope.setDefaults=function(){$scope.countRecieved=0,$scope.template=SIGNAL_R_MODULE.TEMPLATES.BASE,$scope.signalEventTemplate=SIGNAL_R_MODULE.TEMPLATES.OBJECT,$scope.visibleSignalR=!1,$scope.tryingToReconnect=!1,$scope.aError=!1,$scope.aSuccess=!0,$scope.aWarning=!1,$scope.text={objectType:"Object Type",comments:"a Comment",commentCategories:"the Comment Categories",diagramLock:"a Diagram in the model",extendedAttribute:"an Extended Attribute",extendedAttributesOrder:"the Extended Attributes Order",customArtifactType:"a Custom Artifact Type",modelProperties:"the Model Properties",userInfo:"User Profile",diagram:"the Diagram"},moment.locale($data.$getLanguage())},$scope.getTimeAgo=function(timeAgo){return moment(timeAgo).fromNow()},$scope.receiveEvent=function(event,rEvent){var validationEvent=$data.$parseEvent(rEvent);validationEvent.signalEvent.sender&&validationEvent.signalEvent.sender.id!==$data.$userProfile().id&&($scope.visibleSignalR=!0,$scope.receivedEvent=validationEvent.signalEvent,"CommentCategories"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.commentCategories:"DiagramLock"===$scope.receivedEvent.objectType?("Deleted"===$scope.receivedEvent.eventType?$scope.receivedEvent.eventType="Released ":$scope.receivedEvent.eventType="Locked for edition ",$scope.text.objectType=$scope.text.diagramLock,"CloudIn.workspaces.diagrams"===$state.current.name&&$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!0})):"ExtendedAttribute"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.extendedAttribute:"ExtendedAttributesOrder"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.extendedAttributesOrder:"CustomArtifactType"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.customArtifactType:"ModelProperties"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.modelProperties:"Comments"===$scope.receivedEvent.objectType?($scope.text.objectType=$scope.text.comments+" on "+$scope.receivedEvent.ref.displayName,"Created"===$scope.receivedEvent.eventType?$scope.receivedEvent.eventType="Added ":$scope.receivedEvent.eventType="Removed "):"UserInfo"===$scope.receivedEvent.objectType?$scope.text.objectType=$scope.text.userInfo:"Diagram"===$scope.receivedEvent.objectType&&($scope.text.objectType=$scope.text.diagram+": "+$scope.receivedEvent.ref.displayName,"CloudIn.workspaces.processviewer"===$state.current.name&&$stateParams.diagramId===$scope.receivedEvent.ref.key&&$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!0})),$scope.countRecieved++,$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._SENDED,$scope.receivedEvent.objectType),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._SENDED),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._RECEIVED,$scope.receivedEvent),$timeout(function(){$scope.visibleSignalR=!1},3e3))},$scope.sendEvent=function(event,sEvent){$scope.collaboration.hasOwnProperty("server")?4===$scope.collaboration.connection.state?$.connection.hub.start().done(function(){$scope.collaboration.server.sendNotification(sEvent.id,sEvent.data),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._SENDED)}):($scope.collaboration.server.sendNotification(sEvent.id,sEvent.data),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._SENDED)):$scope.start()},$scope.loadSignalRScript=function(){var signalRRequest=applicationServices.$getSignalRScript(SIGNAL_R_MODULE.CONNECTIONS._HUB);signalRRequest.then(function(){$scope.startHubConnection()},function(error){})},$scope.startHubConnection=function(){var loginData=$data.$login();$.connection.hub.url=SIGNAL_R_MODULE.CONNECTIONS._HUB,$scope.collaboration=$.connection.wSCollaborationHub,$scope.collaboration.client.HandleNotification=function(str){$scope.receiveEvent({},str)},$.connection.hub.qs={access_token:loginData[$scope.constants.accessToken]},$.connection.hub.stateChanged=function(state){state.newState>2&&$scope.starSignalRHub()},$scope.starSignalRHub()},$scope.starSignalRHub=function(){$.connection.hub.start().done(function(){$scope.listen=!0,$scope.listenSignalR()}).fail(function(e){})},$scope.stopSignalRHub=function(){$.connection().stop(),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._STOP_READY)},$scope.getClass=function(){var classSR="out ng-hide";return $scope.visibleSignalR&&(classSR="in isActive ng-show"),classSR},$scope.listenSignalR=function(){$scope.collaboration&&$scope.collaboration.server&&$scope.collaboration.server[SIGNAL_R_MODULE.CONNECTIONS._JOIN]().done(function(){}).fail(function(e){$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._SR_ERROR)})},$scope.start=function(){_.isEmpty($data.$login())||$scope.listen||$scope.loadSignalRScript()},$scope.setDefaults(),$rootScope.$on(SIGNAL_R_MODULE.EVENTS._NEW,$scope.receiveEvent),$rootScope.$on(SIGNAL_R_MODULE.EVENTS._SEND,$scope.sendEvent),$rootScope.$on(SIGNAL_R_MODULE.EVENTS._START,$scope.start),$rootScope.$on(SIGNAL_R_MODULE.EVENTS._STOP,$scope.stopSignalRHub),$rootScope.$emit(SIGNAL_R_MODULE.EVENTS._READY,SIGNAL_R_MODULE)}),angular.module("changePasswordModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("changePasswordModule").constant("CHANGE_PASSWORD_MODULE",{EVENTS:{_READY:"CHANGE_PASSWORD_MODULE._READY",_ACTIVE:"CHANGE_PASSWORD_MODULE._ACTIVE",_FAIL:"CHANGE_PASSWORD_MODULE._FAIL",_OPEN:"CHANGE_PASSWORD_MODULE._OPEN",_ERROR:"ERROR"}}),angular.module("changePasswordModule").directive("pwCheck",[function(){return{require:"ngModel",link:function(scope,elem,attrs,ctrl){var firstPassword="#"+attrs.pwCheck;elem.add(firstPassword).on("keyup",function(){scope.$apply(function(){var v=elem.val()===$(firstPassword).val()&&elem.val().length>=7;scope.passwordIsEqual=v,ctrl.$setValidity("passwordmatch",v)})})}}}]),angular.module("changePasswordModule").controller("ChangePasswordController",function($scope,$rootScope,CHANGE_PASSWORD_MODULE){$scope.isCollapsed=!0,$scope.setDefaults=function(){$scope.newPassword="",$scope.confirmPassword="",$scope.currentPassword="",$scope.passwordIsEqual=!1,$scope.active=!1,$scope.message={error:"",success:""},$scope.label={changePassword:"Change Password",currentPassword:"Current password",newPassword:"New Password",confirmPassword:"Confirm New Password",checkPassword:"",lengthError:"Please check your password length."}},$scope.validateFields=function(){$scope.validating=!0,$scope.currentPassword&&$scope.currentPassword.length>=7?($scope.label.checkPassword="",($scope.newPassword||$scope.confirmPassword)&&($scope.passwordIsEqual=$scope.newPassword===$scope.confirmPassword)):$scope.label.checkPassword="Please check your current password length."},$scope.success=function(event,message){$scope.message.success=message},$scope.fail=function(event,message){$scope.message.error=message},$scope.toggle=function(){$scope.isCollapsed=!$scope.isCollapsed,$scope.isCollapsed||$scope.setDefaults()},$scope.$watch("active",function(newValue){var data={active:newValue,currentPassword:$scope.currentPassword,newPassword:$scope.newPassword};$rootScope.$emit(CHANGE_PASSWORD_MODULE.EVENTS._ACTIVE,data)}),$scope.$watch("passwordIsEqual",function(newValue){newValue?$scope.active=!0:($scope.label.checkPassword="Please check your password match.",$scope.active=!1)}),$rootScope.$emit(CHANGE_PASSWORD_MODULE.EVENTS._READY),$rootScope.$on(CHANGE_PASSWORD_MODULE.EVENTS._FAIL,$scope.fail),$rootScope.$on(CHANGE_PASSWORD_MODULE.EVENTS._OPEN,$scope.toggle),$rootScope.$on(CHANGE_PASSWORD_MODULE.EVENTS._SUCCESS,$scope.success),$scope.setDefaults()}),angular.module("extendedAttributesModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("extendedAttributesModule").constant("EXTENDED_ATTRIBUTES_MODULE",{EXPANDED:{EVENTS:{_READY:"EXTENDED_ATTRIBUTES_MODULE.EXPANDED._READY",_UPDATE:"EXTENDED_ATTRIBUTES_MODULE.EXPANDED._UPDATE",_EXECUTE:"EXECUTE",_DOWNLOAD:"EXTENDED_ATTRIBUTES_MODULE.EXPANDED._DOWNLOAD"}},EVENTS:{_READY:"EXTENDED_ATTRIBUTES_MODULE._READY",_UPDATE:"EXTENDED_ATTRIBUTES_MODULE._UPDATE",_EXECUTE:"EXECUTE",_DOWNLOAD:"EXTENDED_ATTRIBUTES_MODULE.EVENTS._DOWNLOAD"},ACTIONS:{OPEN_ATTRIBUTES:"OPEN.ATTRIBUTES"},FILE:{LOADING:'<i class="fa fa-spinner fa-pulse fa-1x fa-fw margin-bottom"></i>',NOT_FOUND:'<i class="fa fa-exclamation-triangle"></i>'},TEMPLATE:{BASE:"views/extended.attributes.module.view.html",EXPANDED:"views/extended.attributes.expanded.module.view.html"
}}),angular.module("extendedAttributesModule").directive("htmlRender",function(){return{restrict:"A",require:"^ngModel",scope:{ngModel:"="},link:function(scope,element){scope.cleanHTML=function(){var formattedHtml="";return scope.ngModel&&(formattedHtml=scope.ngModel.toString().replace(/[\\]*["]/g,'"').replace(/([\\]+t)/g,"").replace(/([\\]+r)/g,"").replace(/([\\]+n)/g,"<br>")),formattedHtml},element.html(scope.cleanHTML()),element.find("a").attr("target","_blank")}}}),angular.module("extendedAttributesModule").controller("ExtendedAttributesController",function($scope,$rootScope,$sce,$timeout,EXTENDED_ATTRIBUTES_MODULE){$scope.$setDefaults=function(){$scope.attributes=[],$scope.properties=[],$scope.listFiles={},$scope.loading=!0},$scope.update=function(event,data){$scope.attributes=data.dataSource.definitions,_.each($scope.attributes,function(val,i){$scope.getPropertyValue(data.dataSource.properties,val.id,i)}),$scope.loading=!1},$scope.getPropertyValue=function(source,id,index){for(var i=0;i<source.length;i++)source[i].attributeId===id&&(source[i].hasOwnProperty("tableRows")&&source[i].tableRows.length>0?($scope.attributes[index].value=source[i].tableRows,$scope.attributes[index].displayText=source[i].displayText,$scope.attributes[index].visible=$scope.validateContent(source[i].tableRows),$scope.attributes[index].position=i):($scope.attributes[index].value=source[i].content,$scope.attributes[index].displayText=source[i].displayText,$scope.attributes[index].visible=$scope.validateContent(source[i].content),$scope.attributes[index].position=i))},$scope.download=function(idFile){$scope.listFiles[idFile]||($scope.listFiles[idFile]={}),$scope.listFiles[idFile].url="javascript:;",$scope.listFiles[idFile].name=EXTENDED_ATTRIBUTES_MODULE.FILE.LOADING+" "+gettext("Loading file information...."),$scope.listFiles[idFile].localRoute=idFile.replace(/(\\\\\\)/g,""),$rootScope.$emit(EXTENDED_ATTRIBUTES_MODULE.EVENTS._DOWNLOAD,{id:idFile,scope:$scope.listFiles[idFile]})},$scope.validateContent=function(content){var valid=!1;return"string"==typeof content||"object"==typeof content?content.length>0&&(valid=!0):"number"==typeof content&&(valid=!0),valid},$scope.execute=function(event,obj){$rootScope.$emit(EXTENDED_ATTRIBUTES_MODULE.EVENTS._EXECUTE,obj)},$scope.trustAsHtml=function(string){return $sce.trustAsHtml(string)},$scope.$setHandlers=function(){$rootScope.$off(EXTENDED_ATTRIBUTES_MODULE.EVENTS._UPDATE),$rootScope.$on(EXTENDED_ATTRIBUTES_MODULE.EVENTS._UPDATE,$scope.update)},$scope.$setDefaults(),$scope.$setHandlers()}),angular.module("extendedAttributesModule").controller("ExtendedAttributesExpandedController",function($scope,$rootScope,$sce,$data,$timeout,EXTENDED_ATTRIBUTES_MODULE){$scope.$setDefaults=function(){$scope.attributes=[],$scope.properties=[],$scope.shape=$data.$selectedShape(),$scope.data&&($scope.attributes=$scope.data.attributes,$scope.listFiles=$scope.data.listFiles)},$scope.trustAsHtml=function(string){return $sce.trustAsHtml(string)},$scope.navToPanel=function(element){var target=angular.element(element).data("panel-href"),positionTarget=angular.element("#"+target).position().top,scrollElement=angular.element(".bz-cd-content-properties.wrapper-expanded");scrollElement.animate({scrollTop:positionTarget},"500","swing",function(){angular.element(".extended-attributes-nav .list-group a").removeClass("active"),angular.element(element).addClass("active")})},$scope.download=function(idFile){$scope.listFiles[idFile]||($scope.listFiles[idFile]={}),$scope.listFiles[idFile].url="javascript:;",$scope.listFiles[idFile].name=EXTENDED_ATTRIBUTES_MODULE.FILE.LOADING+" "+gettext("Loading file information...."),$scope.listFiles[idFile].localRoute=idFile.replace(/(\\\\\\)/g,""),$rootScope.$emit(EXTENDED_ATTRIBUTES_MODULE.EVENTS._DOWNLOAD,{id:idFile,scope:$scope.listFiles[idFile]})};var elementExtended=".extended-attributes-nav .list-group a";angular.element(document).unbind("click").on("click",elementExtended,function(){var thisElement=this;$scope.navToPanel(thisElement)}),$scope.$setHandlers=function(){$rootScope.$off(EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._UPDATE),$rootScope.$emit(EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._READY),$rootScope.$on(EXTENDED_ATTRIBUTES_MODULE.EXPANDED.EVENTS._UPDATE,$scope.update)},$scope.$setDefaults(),$scope.$setHandlers()}),angular.module("upgradeModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("upgradeModule").constant("UPGRADE_MODULE",{EVENTS:{_READY:"UPGRADE_MODULE._READY",_UPDATE:"UPGRADE_MODULE._UPDATE",_GET_SUBSCRIPTION:"UPGRADE_MODULE._GET_SUBSCRIPTION",_BILLING_FORM:"UPGRADE_MODULE._BILLING_FORM",_UPGRADE:"UPGRADE_MODULE._UPGRADE",_UPGRADE_TRIAL:"UPGRADE_MODULE._UPGRADE_TRIAL",_VALIDATE_AMOUNT_LICENSES:"UPGRADE_MODULE._VALIDATE_AMOUNT_LICENSES",_DOWNGRADE:"UPGRADE_MODULE._DOWNGRADE",_DOWNGRADE_PLAN:"UPGRADE_MODULE._DOWNGRADE_PLAN",_DOWNGRADED:"UPGRADE_MODULE._DOWNGRADED",_UPDATE_LICENSES:"UPGRADE_MODULE._UPDATE_LICENSES",_ERROR:"ERROR",_FAIL:"FAIL"},TEMPLATES:{BASE:"views/upgrade.module.view.html"}}),angular.module("upgradeModule").controller("UpgradeController",function($scope,$timeout,$data,$rootScope,UPGRADE_MODULE,APP){$scope.setDefaults=function(){$scope.minEditors=1,$scope.minContributors=0,$scope.storage=0,$scope.numEditors=1,$scope.numContributors=0,$scope.numberEditors=angular.element("#numberEditors"),$scope.numberContributtors=angular.element("#numberContributors").val(),$scope.plans=[],$scope.pricePerEditor=50,$scope.pricePerContributor=10,$scope.plan=$data.$subscription().subscriptionType.toLowerCase()||"personal",$scope.planType=$scope.plan,$scope.linkCollaborationServices="es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES,$scope.wasTrial=$data.$subscription().wasTrialActivated,$scope.isDowngraded=!1,$scope.endDateTrial=moment($data.$subscription().endDate).format("DD/MM/YYYY");var selectFromWorkgroup=$data.$getSelectExternalWorkgroup();"true"===selectFromWorkgroup&&($scope.fromWorkGroup=!0,$scope.planType="full"),$rootScope.selectExternalWorkgroup(null)},$scope.onlyNumbers=function(){angular.element(".ui-spinner-input").keypress(function(e){return 8!=e.which&&0!=e.which&&(e.which<48||e.which>57)?!1:void 0}),angular.element(".ui-spinner-input").bind("paste",function(e){e.preventDefault()})},$scope.update=function(event,data){angular.extend($scope,data)},$scope.downgradePlan=function(){$rootScope.$emit(UPGRADE_MODULE.EVENTS._DOWNGRADE),$rootScope.$emit(UPGRADE_MODULE.EVENTS._DOWNGRADE_PLAN)},$scope.changeInput=function(){angular.element(".ui-spinner-input").keyup(function(e){"numEditors"==e.currentTarget.getAttribute("ng-model")&&($scope.numEditors=e.currentTarget.value,$scope.calculatePayment($scope.numEditors,$scope.numContributors)),"numContributors"==e.currentTarget.getAttribute("ng-model")&&($scope.numContributors=e.currentTarget.value,$scope.calculatePayment($scope.numEditors,$scope.numContributors))})},$scope.blurSpinner=function(){angular.element(".ui-spinner-button").click(function(){$scope.totalpayment=Math.round(100*($scope.editorPrice*$scope.numEditors+$scope.contributorPrice*$scope.numContributors))/100,$scope.storage=100*$scope.numEditors,angular.element("#total-storage").html($scope.storage),angular.element("#total-payment").html($scope.totalpayment)}),angular.element(".ui-spinner-input").blur(function(e){"numEditors"==e.currentTarget.getAttribute("ng-model")&&(""==e.currentTarget.value&&(e.currentTarget.value=$scope.minEditors,$scope.numEditors=$scope.minEditors),$scope.totalpayment=Math.round(100*($scope.editorPrice*$scope.numEditors+$scope.contributorPrice*$scope.numContributors))/100,$scope.storage=100*$scope.numEditors,angular.element("#total-storage").html($scope.storage),angular.element("#total-payment").html($scope.totalpayment)),"numContributors"==e.currentTarget.getAttribute("ng-model")&&(""==e.currentTarget.value&&(e.currentTarget.value=$scope.minContributors,$scope.numContributors=$scope.minContributors),$scope.totalpayment=Math.round(100*($scope.editorPrice*$scope.numEditors+$scope.contributorPrice*$scope.numContributors))/100,angular.element("#total-payment").html($scope.totalpayment))})},$scope.getSubscription=function(event,data){$scope.editorPrice=data.licensePrices.editor,$scope.contributorPrice=data.licensePrices.contributor,$scope.editors=_.where(data.licenses,{licenseType:"Editor"}),$scope.numEditors=$scope.editors.length,$scope.contributors=_.where(data.licenses,{licenseType:"Contributor"}),$scope.numContributors=$scope.contributors.length,$scope.editorsLenght=$scope.numEditors,$scope.contributorsLenght=$scope.numContributors,$scope.editorsUsed=0,$scope.contrubutorsUsed=0;var countEditors=0,countContributors=0;_.each($scope.editors,function(val,i){val.hasOwnProperty("userId")&&countEditors++,$scope.editorsUsed=countEditors}),_.each($scope.contributors,function(val,i){val.hasOwnProperty("userId")&&countContributors++,$scope.contrubutorsUsed=countContributors}),"full"===$scope.planType&&"full"===$scope.plan?($scope.minEditors=$scope.editorsLenght,$scope.minContributors=$scope.contributorsLenght):($scope.minEditors=1,$scope.minContributors=0,$scope.numEditors=0==$scope.editorsLenght?1:$scope.editorsLenght),$scope.editorNumericOptions={min:$scope.minEditors,start:$scope.minEditors,step:1},$scope.contributorNumericOptions={min:$scope.minContributors,start:$scope.minContributors},$scope.totalpayment=Math.round(100*($scope.editorPrice*$scope.numEditors+$scope.contributorPrice*$scope.numContributors))/100,$scope.storage=100*$scope.numEditors,$scope.blurSpinner(),$scope.onlyNumbers(),$scope.changeInput()},$scope.calculatePayment=function(editors,contributors){$scope.totalpayment=Math.round(100*($scope.editorPrice*editors+$scope.contributorPrice*contributors))/100,angular.element("#total-payment").html($scope.totalpayment),$scope.storage=100*editors},$scope.validateAndUpgradePlan=function(data,typePlan){var numberEditors=$scope.numEditors,numberContributors=$scope.numContributors,dataLincences={Contributor:parseInt(numberContributors),Editor:parseInt(numberEditors)},dataForm={planType:data.planType.$viewValue,numberContributors:numberContributors,numberEditors:numberEditors,paymentRecurrence:data.paymentRecurrence.$viewValue},params={typeUpgrade:data,typePlan:typePlan,dataLincences:dataLincences,dataForm:dataForm,wasTrial:$scope.wasTrial};$rootScope.$emit(UPGRADE_MODULE.EVENTS._VALIDATE_AMOUNT_LICENSES,params)},$scope.upgradePlan=function(data,typePlan){var numberEditors=$scope.numEditors,numberContributors=$scope.numContributors,dataLincences={Contributor:parseInt(numberContributors),Editor:parseInt(numberEditors)},dataForm={planType:data.planType.$viewValue,numberContributors:numberContributors,numberEditors:numberEditors,paymentRecurrence:data.paymentRecurrence.$viewValue};$data.$subscription().subscriptionType===typePlan||"trial"!==typePlan||$scope.wasTrial?"trial"===typePlan&&$rootScope.$emit(UPGRADE_MODULE.EVENTS._UPDATE_LICENSES,dataLincences):$rootScope.$emit("OPEN.TRIAL.MODAL",{action:"OPEN.TRIAL.MODAL"}),typePlan&&"full"===typePlan&&$rootScope.$emit(UPGRADE_MODULE.EVENTS._BILLING_FORM,dataForm)},$scope.downgraded=function(){$scope.isDowngraded=!0},$scope.setDefaults(),$rootScope.$off(UPGRADE_MODULE.EVENTS._UPDATE),$rootScope.$off(UPGRADE_MODULE.EVENTS._GET_SUBSCRIPTION),$rootScope.$on(UPGRADE_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(UPGRADE_MODULE.EVENTS._GET_SUBSCRIPTION,$scope.getSubscription),$rootScope.$on(UPGRADE_MODULE.EVENTS._DOWNGRADED,$scope.downgraded),$rootScope.$emit(UPGRADE_MODULE.EVENTS._READY)}),angular.module("collaboratorsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("collaboratorsModule").constant("COLLABORATORS_MODULE",{EVENTS:{_READY:"COLLABORATORS_MODULE._READY",_UPDATE:"COLLABORATORS_MODULE._UPDATE",_DELETE:"COLLABORATORS_MODULE._DELETE",_ERROR:"ERROR",_FAIL:"FAIL"},TEMPLATES:{BASE:"views/collaborators.module.view.html"},RESOURCES:{IMAGES:{PLACEHOLDER_AVATAR:"app/img/bizagi-placeholder-avatar.png",PLACEHOLDER_MODEL:"app/img/bizagi-placeholder-model.png"}}}),angular.module("collaboratorsModule").controller("CollaboratorsController",function($scope,$data,$rootScope,COLLABORATORS_MODULE,gettextCatalog){$scope.setDefaults=function(){$scope.collaborators=[],$scope.collaborators.filtered={},$scope.placeholderAvatar=COLLABORATORS_MODULE.RESOURCES.IMAGES.PLACEHOLDER_AVATAR,$scope.placeholderModel=COLLABORATORS_MODULE.RESOURCES.IMAGES.PLACEHOLDER_MODEL},$scope.update=function(event,data){var dataContent=data.dataSource.content;dataContent.collaborators=_.indexBy(dataContent,"userId"),$scope.collaborators=dataContent.collaborators,_.each($scope.collaborators,function(val,i){var models=_.where(dataContent,{userId:val.userId}),modelsEditor=_.where(models,{access:"Editor"}),modelsContributor=_.where(models,{access:"Contributor"});$scope.collaborators[i].types=[],$scope.collaborators[i].types[0]=[],$scope.collaborators[i].types[1]=[],$scope.collaborators[i].types[0].name=gettextCatalog.getString(gettext("Editor")),$scope.collaborators[i].types[1].name=gettextCatalog.getString(gettext("Contributor")),$scope.collaborators[i].types[0].models=modelsEditor,$scope.collaborators[i].types[1].models=modelsContributor,$scope.collaborators[i].open=!0}),Object.size=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size},$scope.sizeCollaborators=Object.size($scope.collaborators),$scope.collaboratorsList=$.map($scope.collaborators,function(value,index){return[value]})},$scope.collapseBody=function(){$scope.isCollapsed=!$scope.isCollapsed},$scope.deleteUserFromModel=function(model,collaborator){var dataDelete={workspaceId:model.workspaceId,userId:collaborator.userId};$rootScope.$emit(COLLABORATORS_MODULE.EVENTS._DELETE,dataDelete)},$scope.setDefaults(),$rootScope.$off(COLLABORATORS_MODULE.EVENTS._UPDATE),$rootScope.$on(COLLABORATORS_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$emit(COLLABORATORS_MODULE.EVENTS._READY)}),angular.module("billingModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("billingModule").constant("BILLING_MODULE",{EVENTS:{_READY:"BILLING_MODULE._READY",_READY_PAYMENTS:"BILLING_MODULE._READY_PAYMENTS",_UPDATE:"BILLING_MODULE._UPDATE",_INIT_PAYMENT:"BILLING_MODULE._INIT_PAYMENT",_ERROR:"ERROR",_FAIL:"FAIL"},TEMPLATES:{BASE:"views/billing.module.view.html",QUOTA:"views/billing.module.quota.view.html"},BILLING_FORM:{TEMPLATES:{BASE:"views/billing.module.form.view.html"},EVENTS:{_UPDATE:"BILLING_MODULE.BILLING_FORM._EVENTS._UPDATE"}},PAYMENTS:{TEMPLATES:{INVOICES:"views/billing.module.payments.view.html"},EVENTS:{_READY:"BILLING_MODULE.PAYMENTS._EVENTS._READY",_UPDATE:"BILLING_MODULE.PAYMENTS._EVENTS._UPDATE",_UPDATE_COMMIT:"BILLING_MODULE.PAYMENTS._EVENTS._UPDATE_COMMIT",_GET_TRANSACTION:"BILLING_MODULE.PAYMENTS._EVENTS._GET_TRANSACTION",_CANCEL_TRANSACTION:"BILLING_MODULE.PAYMENTS._EVENTS._CANCEL_TRANSACTION",_ERROR_TRANSACTION:"BILLING_MODULE.PAYMENTS._EVENTS._ERROR_TRANSACTION"}}}),angular.module("billingModule").controller("BillingController",function($scope,$data,$rootScope,BILLING_MODULE,TABS_MODULE,APP,gettextCatalog){$scope.setDefaults=function(){$scope.userNamePlan="",$scope.userProfilePlan=""===$data.$subscription().subscriptionType?"personal":$data.$subscription().subscriptionType,"personal"===$scope.userProfilePlan?$scope.userNamePlan=gettext("Personal"):"trial"===$scope.userProfilePlan?$scope.userNamePlan=gettext("Workgroup (Trial)"):"full"===$scope.userProfilePlan&&($scope.userNamePlan=gettext("Workgroup"));$data.$userProfile();$scope.submitted=!1,$scope.data&&$scope.updateBillingForm(),$scope.taxIdToolTip=gettextCatalog.getString(gettext("If you are in the European Union, a tax will be charged according to your country. You will be exempt from this tax by filling the VAT registration number of your company"))},$scope.goToPlanManagementInfo=function(){var data=APP.TABS.USER_OPTIONS[0];data.active=!0,$rootScope.$emit(TABS_MODULE.EVENTS._CHANGE,data)},$scope.update=function(event,data){$scope.editors=_.where(data.licenses,{licenseType:"Editor"}),$scope.contributors=_.where(data.licenses,{licenseType:"Contributor"}),$scope.editorsUsed=0,$scope.contrubutorsUsed=0,$scope.ownerUsed=1;var countEditors=0,countContributors=0;_.each($scope.editors,function(val,i){val.hasOwnProperty("userId")&&countEditors++,$scope.editorsUsed=countEditors}),_.each($scope.contributors,function(val,i){val.hasOwnProperty("userId")&&countContributors++,$scope.contrubutorsUsed=countContributors});var totalEditorPrice=data.licensePrices.editor*$scope.editors.length,totalContributorPrice=data.licensePrices.contributor*$scope.contributors.length;$scope.owned=data.modelsOwned,$scope.currency="USD",$scope.frequency=gettext("Monthly"),$scope.currencySymbol="$",$scope.planRate=totalEditorPrice+totalContributorPrice},$scope.updateBillingForm=function(event,data){data&&angular.extend($scope.data,data),$scope.numberEditors=$scope.data.numberEditors,$scope.numberContributors=$scope.data.numberContributors,$scope.totalPayment=$scope.data.paymentRecurrence,$scope.planType=$scope.data.planType,$scope.countries=$scope.data.countries,$scope.company=$scope.data.me.company,$scope.firstName=$scope.data.me.firstName,$scope.lastName=$scope.data.me.lastName,$scope.phone=$scope.data.me.phone,$scope.email=$scope.data.me.email,$scope.country=$scope.data.me.country,$scope.city=$scope.data.me.city},$scope.initPayment=function(){if($scope.submitted=!0,$scope.billingForm.$valid){var products=[];products="full"===$data.$subscription().subscriptionType?0===$scope.numberEditors?[{id:"6f1a4e3f-6fdb-4b3b-8390-8f18fd738545",quantity:$scope.numberContributors}]:0===$scope.numberContributors?[{id:"da19e431-e577-4d6c-870d-b96da2041c85",quantity:$scope.numberEditors}]:[{id:"da19e431-e577-4d6c-870d-b96da2041c85",quantity:$scope.numberEditors},{id:"6f1a4e3f-6fdb-4b3b-8390-8f18fd738545",quantity:$scope.numberContributors}]:0===$scope.numberEditors?[{id:"6f1a4e3f-6fdb-4b3b-8390-8f18fd738545",quantity:$scope.numberContributors}]:0===$scope.numberContributors?[{id:"da19e431-e577-4d6c-870d-b96da2041c85",quantity:$scope.numberEditors}]:[{id:"da19e431-e577-4d6c-870d-b96da2041c85",quantity:$scope.numberEditors},{id:"6f1a4e3f-6fdb-4b3b-8390-8f18fd738545",quantity:$scope.numberContributors}],$rootScope.$emit(BILLING_MODULE.EVENTS._INIT_PAYMENT,{billingInfo:{companyName:$scope.company,firstName:$scope.firstName,lastName:$scope.lastName,phone:$scope.phone,email:$scope.email,taxId:$scope.taxId,zipcode:"",country:$scope.country,city:$scope.city,address1:$scope.address,address2:$scope.address2},productPayments:products})}},$scope.viewInvoices=function(){$rootScope.$emit(BILLING_MODULE.EVENTS._READY_PAYMENTS)},$scope.setDefaults(),$rootScope.$emit(BILLING_MODULE.EVENTS._READY),$rootScope.$off(BILLING_MODULE.EVENTS._UPDATE),$rootScope.$off(BILLING_MODULE.BILLING_FORM.EVENTS._UPDATE),$rootScope.$on(BILLING_MODULE.EVENTS._UPDATE,$scope.update),$rootScope.$on(BILLING_MODULE.BILLING_FORM.EVENTS._UPDATE,$scope.updateBillingForm)}).filter("capitalize",function(){return function(input,scope){return null!=input&&(input=input.toLowerCase()),input.substring(0,1).toUpperCase()+input.substring(1)}}).directive("validNumber",function(){return{require:"?ngModel",link:function(scope,element,attrs,ngModelCtrl){ngModelCtrl&&(ngModelCtrl.$parsers.push(function(val){angular.isUndefined(val)&&(val="");var clean=val.replace(/[^0-9\.]/g,""),decimalCheck=clean.split(".");return angular.isUndefined(decimalCheck[1])||(decimalCheck[1]=decimalCheck[1].slice(0,2),clean=decimalCheck[0]+"."+decimalCheck[1]),val!==clean&&(ngModelCtrl.$setViewValue(clean),ngModelCtrl.$render()),clean}),element.bind("keypress",function(event){32===event.keyCode&&event.preventDefault()}))}}}),angular.module("billingModule").controller("PaymentsController",function($scope,$state,$location,$data,$rootScope,BILLING_MODULE,APP){$scope.setDefaults=function(){$scope.invoices=[],$scope.data&&$scope.updateInvoices(null,$scope.data)},$scope.ready=function(){if($rootScope.$emit(APP.LOADING_MODULE.EVENTS._SHOW,{message:gettext("Loading transaction")}),"CloudIn.Payment.Commit"===$state.$current.name||"CloudIn.Payment.Cancel"===$state.$current.name||"CloudIn.Payment.Error"===$state.$current.name){if($location.search())var url=$location.search();"CloudIn.Payment.Commit"===$state.$current.name?!_.isEmpty(url)&&url.hasOwnProperty("token")&&url.hasOwnProperty("PayerID")?$rootScope.$emit(BILLING_MODULE.PAYMENTS.EVENTS._GET_TRANSACTION,url):$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE):"CloudIn.Payment.Error"===$state.$current.name?$rootScope.$emit(BILLING_MODULE.PAYMENTS.EVENTS._ERROR_TRANSACTION,url):!_.isEmpty(url)&&url.hasOwnProperty("token")?$rootScope.$emit(BILLING_MODULE.PAYMENTS.EVENTS._CANCEL_TRANSACTION,url):$rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)}else $rootScope.$emit(APP.LOADING_MODULE.EVENTS._HIDE)},$scope.execute=function(event,obj){angular.extend(obj,{from:"userMenuModule"}),$rootScope.$emit(APP.USER_MENU_MODULE.EVENTS._EXECUTE,obj)},$scope.updateCommit=function(event,data){$location.url($location.path()),$scope.transactionId=data.id,$scope.subscriptionId=data.subscriptionId,$scope.invoice=data.invoice,$scope.billingInfo=data.billingInfo,$scope.productPayments=data.productPayments;var listEditor=_.filter($scope.productPayments,function(p){return"Editor License"==p.name.trim()||"Licencia de editor"==p.name.trim()});$scope.editors=listEditor.length>0?listEditor[0].quantity:0;var listContributors=_.filter($scope.productPayments,function(p){return"Contributor License"==p.name.trim()||"Licencia de contribuidor"==p.name.trim()});$scope.contributors=listContributors.length>0?listContributors[0].quantity:0,$scope.totalPrice=data.totalPrice,$scope.vatValue=data.vatValue,$scope.linkCollaborationServices="es"==$data.$getLanguage()?APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES_ES:APP.APPLICATION_MODULE.API.CLOUD_LINKS._COLLABORATION_SERVICES},$scope.updateInvoices=function(event,data){$scope.invoices=data},$scope.setDefaults(),$rootScope.$emit(BILLING_MODULE.PAYMENTS.EVENTS._READY),$rootScope.$off(BILLING_MODULE.PAYMENTS.EVENTS._READY),$rootScope.$off(BILLING_MODULE.PAYMENTS.EVENTS._UPDATE_COMMIT),$rootScope.$on(BILLING_MODULE.PAYMENTS.EVENTS._UPDATE_COMMIT,$scope.updateCommit),$rootScope.$on(BILLING_MODULE.PAYMENTS.EVENTS._READY,$scope.ready)}),angular.module("billingModule").directive("quotaBilling",function(APP,gettextCatalog){return{templateUrl:APP.BILLING_MODULE.TEMPLATES.QUOTA,controller:function($window,$scope,$data,$rootScope,APP,$element){$scope.quota={message:""},$scope.update=function(event,data){$scope.quota.message=data.used+data.sizeUnit+" "+gettextCatalog.getString(gettext("of"))+" "+data.quota+data.sizeUnit},$rootScope.$on(APP.EVENTS._UPDATE_APP_QUOTA,$scope.update),$rootScope.$emit(APP.EVENTS._GET_APP_QUOTA)}}}),angular.module("invitationsModule",["ui.router","ui.bootstrap","applicationModule"]),angular.module("invitationsModule").constant("INVITATIONS_MODULE",{LIST_INVITATIONS:{EVENTS:{_READY:"INVITATIONS_MODULE.LIST.READY",_UPDATE:"INVITATIONS_MODULE.LIST.UPDATE",_DELETE:"INVITATIONS_MODULE.DELETE"}}}),angular.module("invitationsModule").controller("InvitationsListController",function($scope,$rootScope,$data,INVITATIONS_MODULE,MEMBER_MODULE,gettextCatalog){$scope.setDefaults=function(){$scope.workspaceId=$scope.workspaceShareId,$scope.invitations=[]},$scope.translateListInvitations=function(invitations){return _.each(invitations,function(invitation,i){invitations[i].access=gettextCatalog.getString(invitation.access)}),invitations},$scope.update=function(event,data){$scope.invitations=$scope.translateListInvitations(data)},$scope.remove=function(invitationId){$rootScope.$emit(INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._DELETE,{workspaceId:$scope.workspaceId,invitationId:invitationId})},$scope.showMemberList=function(){$rootScope.$emit(MEMBER_MODULE.INVITE_MEMBER.EVENTS._CANCEL)},$scope.setDefaults(),$rootScope.$emit(INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._READY,{workspaceId:$scope.workspaceId}),$rootScope.$on(INVITATIONS_MODULE.LIST_INVITATIONS.EVENTS._UPDATE,$scope.update)});